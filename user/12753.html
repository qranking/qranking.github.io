<html>
	<head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110075493-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-110075493-1');
</script>
<!-- Google AdSense -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6168511236629369",
    enable_page_level_ads: true
  });
</script>

		<meta charset="UTF-8" />
		<title>Qiita Ranking (emadurandal)</title>
		<link rel="stylesheet" type="text/css" href="../qranking.css">
	</head>
	<body>
<div class="headerContainer">
<h1>Qiitaいいね数ランキング (emadurandal さんの投稿分)</h1>
</div><!--class="headerContainer"-->
<p><i><img width="16" height="16" src="../thumb-up-120px.png" /></i>が同じ値の場合は投稿日時の新しいものが上位としています。</p>
<p><i><img width="16" height="16" src="../thumb-up-120px.png" /></i>がついていない記事は表示していません。</p>
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />1位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>845</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/a60886152a4c99ce1017">Rails開発環境の構築（rbenvでRuby導入からBundler、Rails導入まで）（Macport編）</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-01-28 18:30:52</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> <b>[Rails]</b> <b>[Mac]</b> <b>[macports]</b> <b>[rbenv]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>※お願い：最近時間がなかなか取れず、Rails5.xの時代になったというのに未だに5.xでの確認ができておりません。どなたか、5.xでも本記事の内容がうまくいった、と確認されました方はコメント欄にてご一報をいただけますと大変嬉しいです。</p>

<p>（本記事は今の所Rails 3.x〜4.2 対応です）</p>

<p>（<a href="http://qiita.com/emadurandal/items/e43c4896be1df60caef0" id="reference-ddbcb67f8d8f74dfd444">Homebrew編</a>も公開しました）</p>

<h2>
<span id="はじめにrailsをローカルインストールするという発想" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%ABrails%E3%82%92%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B%E3%81%A8%E3%81%84%E3%81%86%E7%99%BA%E6%83%B3"><i class="fa fa-link"></i></a>はじめに：Railsをローカルインストールするという発想</h2>

<p>今さらですが、Mac環境でrbenvを使って、Ruby・Rails環境を構築するための記事をまとめてみました。</p>

<p>bundlerでgemをRailsプロジェクト内にローカルインストールすることで、ruby環境を汚さずにRailsプロジェクトを生成できることを目的とします。<br>
Rails自体もローカルインストールすることで、その都度好きなバージョンのRailsプロジェクトを生成し、共存させることができます（←ここ重要。古い書籍のRailsコードを試す時とか便利です）。</p>

<p>突っ込みどころがありましたら、遠慮なくコメントくださいませ。<br>
（MacPorts使っているのは私の好みの問題なので、Homebrew使ってない奴は負け組とかそういうコメントはご勘弁ください^^;　Homebrewの人でも参考になる内容だとは思います。）<br>
　→<a href="http://qiita.com/emadurandal/items/e43c4896be1df60caef0">Homebrew編</a>公開しました！</p>

<p>あと、Markdown初心者なので、記事のレイアウトが見にくいかもしれません。徐々に改善していたいと思います。<br>
→tadsan様が、全文のMarkdownを修正して、レイアウトを綺麗にしてくださいました。ありがとうございます！</p>

<h2>
<span id="前提環境" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>前提環境</h2>

<ul>
<li>OSはMacを前提とする。（OSX Mountain Lion/Marvericks/Yosemiteで動作確認）</li>
<li>Railsのバージョンは3.x〜4.1.xを前提とする。</li>
<li>Rubyのビルドに必要なパッケージの導入にはMacPortsを使う（Gemに関してはもちろんBundler）。</li>
</ul>

<p>Macを前提としているが、パッケージ管理ソフト以外の部分に関しては、Linux等でも使えるノウハウである。</p>

<p>Homebrewを使っている人でも、殆どの部分は使えるノウハウである（CONFIGURE_OPTS環境変数に指定するパスだけ気をつけてください）。</p>

<h2>
<span id="本マニュアルが目指すこと" class="fragment"></span><a href="#%E6%9C%AC%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB%E3%81%8C%E7%9B%AE%E6%8C%87%E3%81%99%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a>本マニュアルが目指すこと</h2>

<ul>
<li>Ruby環境は、rbenvを使って、複数のバージョンを切り替えられるようにして導入する。</li>
<li>rbenv環境下のRuby環境に追加インストールするGemはbundlerのみ。</li>
<li>Railsもローカルにインストールすることで、Ruby環境を特定のバージョンのRailsで汚さずに、複数のバージョンのRailsプロジェクトを作成・共存できるようにする。</li>
<li>ほとんどのGemは、Railsプロジェクト内に閉じた形でインストール・管理する（つまり、Railsプロジェクトのvender/bundleディレクトリ内にGemをインストールする）</li>
<li>構築したRuby環境は、MacPortsに依存しない。</li>
</ul>

<h2>
<span id="rbenvとは" class="fragment"></span><a href="#rbenv%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>rbenvとは</h2>

<p>Ruby環境のバージョン切り替えツールである。Ruby（に限らないが）はバージョンの差違によって、ソフトウェアが正常に動いたり動かなかったり、といったことが往々にしてある。<br>
そこで、特定のバージョンのRubyをドノーマルにインストールしてそれを使い続けるのではなく、バージョン切り替えツールでインストール・管理することで、使いたいソフトウェアや開発するプロジェクトに応じて複数のRuby環境を使い分けるのが最近のトレンドになっている。</p>

<p>Ruby環境のバージョン切り替えツールとしては、以前はRVMというものがあった（使っていらっしゃる方、過去形にしてすみません汗）が、以下のような特徴があり、</p>

<ul>
<li>ヘビーウェイト・多機能。</li>
<li>cdを独自のものに置き換えてしまう。</li>
<li>Bundlerなどと相性が悪い。</li>
</ul>

<p>ちょっと使うのに抵抗があるという人が多かったのも事実。そうした状況を受けて（？）、あのRuby on Railsで有名な37signalsが作った、より軽量な代替ツールがrbenvである。<br>
以下のような特徴を持つ。</p>

<ul>
<li>動作がRVMより速い。</li>
<li>既存コマンドを置き換えるような怖いことをしない。</li>
<li>環境変数によって自動的にRubyバージョンを切り替え可能。</li>
<li>gemの管理はBundlerで行うことが前提。</li>
<li>rubyをOSのシステム深部でなく、自分のホームディレクトリ以下（<code>.rbenv</code>ディレクトリ）にインストールできるので、OSの環境を汚さないという点でも安心感がある。</li>
</ul>

<p>rbenvとRVMのより詳細な比較については、以下のサイト様のページをご覧ください。<br>
「<a href="http://passingloop.tumblr.com/post/10512902196/difference-between-rbenv-and-rvm" rel="nofollow noopener" target="_blank">rbenv と RVM との違い</a>」（passingloop様のサイトより）</p>

<p>それぞれ設計思想が違うので、どちらを使うかは好みの問題でもあるが、しかし今後のトレンドとしてはRVMよりrbenvになりそうな感じなので、本記事ではrbenvを使う。</p>

<h2>
<span id="rbenvrubyのインストール" class="fragment"></span><a href="#rbenvruby%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>rbenv、Rubyのインストール</h2>

<p>rbenvとそのプラグインruby-buildをインストールする。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ git clone git://github.com/sstephenson/rbenv.git ~/.rbenv
$ mkdir -p ~/.rbenv/plugins
$ git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
</pre></div></div>

<p>rbenv用の以下の設定を <code>.bash_profile</code> に設定する。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>export PATH="$HOME/.rbenv/bin:$PATH"
eval "$(rbenv init -)"
</pre></div></div>

<p>書き換えた <code>.bash_profile</code> の設定を読み込む。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ source ~/.bash_profile
</pre></div></div>

<p>MacPortsをインストールする。そしてportを最新の状態にする。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ sudo port selfupdate
$ sudo port sync
</pre></div></div>

<blockquote>
<p>(なぜ、今流行のHomebrewでなく、MacPortsを使うのか。以下の利点があるからである。<br>
* Homebrewによって、/usr/localディレクトリをいじられるのが嫌な人にとっては、/optに全てをインストールするMacPortsは安心感がある。<br>
* 環境を再構築したくなったら、/optディレクトリを消すだけで良い。消すのではなく、リネームして、後で戻すことも可能。<br>
* 複数台のMacで共通の環境を作りたい場合は、/optディレクトリをrsyncするだけで実現できる。<br>
* 昔のMacPortsはソースからビルドしていたので遅かったが、最近のバージョンではバイナリからインストールしてくれるため、すでに「MacPortsは遅い」という定評は過去の物となった。</p>
</blockquote>

<p>OpenSSLをインストールしないとrbenv環境での <code>bundle install</code> が失敗するらしいので、MacPortsでOpenSSLをインストールする。（参照：pygo様：<a href="http://d.hatena.ne.jp/CortYuming/20120618/p1" class="autolink" rel="nofollow noopener" target="_blank">http://d.hatena.ne.jp/CortYuming/20120618/p1</a> ）</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ sudo port install openssl
</pre></div></div>

<p>readlineとiconvがないと動かないgemがあるらしいので、MacPortsでこの二つをインストール。<br>
（参照：tech.portalshit.net様：<a href="http://tech.portalshit.net/2011/11/15/i-am-new-with-rbenv/" class="autolink" rel="nofollow noopener" target="_blank">http://tech.portalshit.net/2011/11/15/i-am-new-with-rbenv/</a> ）</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ sudo port install readline
$ sudo port install libiconv
</pre></div></div>

<p>インストール可能なRubyのバージョンを調べる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv install -l
</pre></div></div>

<p>MacPort で インストールした openssl、readline、iconv のパスを教えて、rbenv でRubyをインストール。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ CONFIGURE_OPTS="--with-openssl-dir=/opt/local --with-readline-dir=/opt/local --with-iconv-dir=/opt/local" rbenv install 2.0.0-p195 # ←バージョン番号は読み替えてね
$ rbenv rehash
</pre></div></div>

<p>以下のコマンドで、インストールしたRubyのバージョンのリストを確認できる</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv versions
</pre></div></div>

<p>インストールしたRubyを有効にする</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv global 2.0.0-p195
</pre></div></div>

<h2>
<span id="ssl証明書のインポート" class="fragment"></span><a href="#ssl%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E3%82%A4%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%88"><i class="fa fa-link"></i></a>SSL証明書のインポート</h2>

<p>ここまでの状態のRubyだと、SSL通信を行う処理をしようとした時に、</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>/Users/hoge/.rbenv/versions/2.0.0-p195/lib/ruby/2.0.0/net/http.rb:918:in `connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (Twitter::Error::ClientError)
</pre></div></div>

<p>というエラーが起きます。そこで、対策として証明書をセットアップします。</p>

<p>まずは、証明書のパスを確認し、</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ ruby -ropenssl -e "p OpenSSL::X509::DEFAULT_CERT_FILE"
"/opt/local/etc/openssl/cert.pem"
</pre></div></div>

<p>返ってきたパスに対して、証明書をダウンロードします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ sudo curl "http://curl.haxx.se/ca/cacert.pem" -o /opt/local/etc/openssl/cert.pem
</pre></div></div>

<p>（参考ページ:<a href="http://k-shogo.github.io/article/2013/08/22/ruby-ssl-connect-error/" rel="nofollow noopener" target="_blank">rubyでSSL利用時に証明書エラーが発生する場合の対応</a>）</p>

<p>これでOKです。</p>

<h2>
<span id="bundlerのインストール" class="fragment"></span><a href="#bundler%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Bundlerのインストール</h2>

<p>Railsで利用するGemは各プロジェクト毎にbundlerで管理するようにしたいので</p>

<ul>
<li>GEMでRuby環境にbundlerのみをインストール</li>
<li>bundlerを使って一時的にrailsをローカルにインストール
（Railsプロジェクトを作成するためだけに使用。railsすらローカルディレクトリにインストールする）</li>
<li>ローカルのrailsでプロジェクト(今回の例では”example”)を作成</li>
<li>railsをローカルインストールするために使ったbundlerの環境を削除</li>
<li>exampleプロジェクト内で必要なgemをbundlerでローカルインストール</li>
</ul>

<p>という手順を踏む。でははじめよう。</p>

<p>GEMでRuby環境にbundlerのみをインストールする。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv exec gem install bundler
$ rbenv rehash
</pre></div></div>

<p>ちなみに現在有効なrubyにインストールされたgemの確認は以下のコマンドで行う。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv exec gem list
</pre></div></div>

<p>インストールしたgemパッケージの保存場所を調べるには以下のコマンドを使う。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv exec gem which bundler
</pre></div></div>

<h2>
<span id="railsのローカルインストールとrailsプロジェクトの作成" class="fragment"></span><a href="#rails%E3%81%AE%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A8rails%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>RailsのローカルインストールとRailsプロジェクトの作成</h2>

<p><strong>（新規Railsプロジェクトを作る時は、常にこのステップから行う）</strong></p>

<p>bundlerを使って一時的にrailsをローカルにインストール。（Railsプロジェクトを作成するためだけに使用。railsすらローカルディレクトリにインストールする）<br>
まず、Railsプロジェクトを作りたいディレクトリに移動して、そこで <code>Gemfile</code> を作る。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ cat &lt;&lt; EOS &gt; Gemfile
source "http://rubygems.org"
gem "rails", "4.1.1" # ←ローカルインストールしたいRailsのバージョンを指定。指定しなければ最新版が入る。
EOS
</pre></div></div>

<p>railsを <code>vender/bundle</code> ディレクトリ以下にインストールする。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ bundle install --path vendor/bundle
</pre></div></div>

<p>（このように、 <code>bundle install</code> する際に <code>--path vendor/bundle</code> をつけることで、gemのインストール先がRuby環境でなく、 ローカルの<code>vendor/bundle</code> ディレクトリ以下になる）</p>

<p>インストールしたgemを確認したい場合は、以下を実行。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ bundle list
</pre></div></div>

<p>railsでプロジェクト(今回の例では”example”)を作成。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ bundle exec rails new example --skip-bundle
</pre></div></div>

<p>（ <code>vendor/bundle</code> に入ったgemを使ってコマンドを実行したい場合は上記のように <code>bundle exec 〜</code> のようにする）<br>
（ <code>--skip-bundle</code> の指定を忘れないように！そうでないと <code>bundle install</code> が発動し、Ruby環境にgemがインストールされてしまう！）</p>

<p>railsをローカルインストールするために使ったbundlerの環境と、ローカルのrailsを削除する。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rm -f Gemfile
$ rm -f Gemfile.lock
$ rm -rf .bundle
$ rm -rf vendor/bundle
</pre></div></div>

<h2>
<span id="railsプロジェクトの環境セットアップ" class="fragment"></span><a href="#rails%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E7%92%B0%E5%A2%83%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>Railsプロジェクトの環境セットアップ</h2>

<p>必要に応じて、example内のGemfileの内容を編集する（Rspecとか、Guardとか、色々入れるよね）。</p>

<p>次に、example内に移動し、Gemfileに書かれたGemのインストールを行う。<br>
この際も <code>--path vendor/bundle</code> オプションをつけて <code>bundle install</code> することでプロジェクト内に閉じた状態でGemをインストールすることができる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ cd example
$ bundle install --path vendor/bundle
</pre></div></div>

<p>(この <code>bundle install --path vendor/bundle</code> で、再びrails(及び関連Gem)が今度はRailsプロジェクトの <code>vender/bundle</code> ディレクトリ以下にインストールされる)</p>

<p>以下の２つの理由から、Gitの管理対象から <code>vendor/bundle</code> ディレクトリを外す。<br>
* <code>vendor/bundle</code>ディレクトリにあるGemsは容量を食うのでGitリポジトリに入れたくない。<br>
* GemfileやGemfile.lockファイルはGitの管理対象なので、cloneした人はそれをもとに<code>bundle install --path vendor/bundle</code>すれば、簡単に同じGem環境を導入できる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ echo '/vendor/bundle' &gt;&gt; .gitignore
</pre></div></div>

<h2>
<span id="railsプロジェクトの起動" class="fragment"></span><a href="#rails%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E8%B5%B7%E5%8B%95"><i class="fa fa-link"></i></a>Railsプロジェクトの起動</h2>

<p>以下のようにして、Railsの起動に成功したら、この記事の目的は達成された。おめでとう！</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ bundle exec rails server
</pre></div></div>

<h1>
<span id="以下tips" class="fragment"></span><a href="#%E4%BB%A5%E4%B8%8Btips"><i class="fa fa-link"></i></a>以下、Tips</h1>

<h2>
<span id="gemのインストール先の判断ruby環境下-or-bundlerでのローカルインストールについて" class="fragment"></span><a href="#gem%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E5%85%88%E3%81%AE%E5%88%A4%E6%96%ADruby%E7%92%B0%E5%A2%83%E4%B8%8B-or-bundler%E3%81%A7%E3%81%AE%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>gemのインストール先の判断（Ruby環境下 or bundlerでのローカルインストール）について</h2>

<p>基本的には、そのプロジェクトでのみ使いたいgemであれば、bundlerで<code>bundle install --path vendor/bundle</code>して、プロジェクトに閉じた形でgemをローカルインストールし、<code>bundle exec ~</code>で実行する形を取るのがよい。<br>
ただし、<code>bundler</code>や<code>pry</code>など、</p>

<ul>
<li>どのプロジェクトでも共通して使いたい。</li>
<li>複数のバージョンを使い分ける必要性が基本的になく、常に最新バージョンであればよい。</li>
</ul>

<p>という性質のgemであれば、bundlerでローカルインストールするのでなく、<code>rbenv exec gem install ~</code>としてRuby環境に直接インストールしてしまった方が利便性が高い。<br>
gemの特性と自分の利用シーンに合わせて、gemのインストール場所は使い分けよう。</p>

<h2>
<span id="間違えてruby環境の方にいろんなgemが入ってしまった場合の対処" class="fragment"></span><a href="#%E9%96%93%E9%81%95%E3%81%88%E3%81%A6ruby%E7%92%B0%E5%A2%83%E3%81%AE%E6%96%B9%E3%81%AB%E3%81%84%E3%82%8D%E3%82%93%E3%81%AAgem%E3%81%8C%E5%85%A5%E3%81%A3%E3%81%A6%E3%81%97%E3%81%BE%E3%81%A3%E3%81%9F%E5%A0%B4%E5%90%88%E3%81%AE%E5%AF%BE%E5%87%A6"><i class="fa fa-link"></i></a>間違えてRuby環境の方にいろんなGemが入ってしまった場合の対処</h2>

<p>以下で全てのgemをアンインストールする。その後、標準でインストールされていたgemやbundlerを入れ直すこと。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv exec gem list | awk '{print "rbenv exec gem uninstall " $1}' | sh -xv
</pre></div></div>

<p>あるいは、以下の方法でRuby環境ごと削除して、rubyを導入しなおしても良い。</p>

<h2>
<span id="不要になったバージョンのruby環境を削除する" class="fragment"></span><a href="#%E4%B8%8D%E8%A6%81%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%9F%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%AEruby%E7%92%B0%E5%A2%83%E3%82%92%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>不要になったバージョンのRuby環境を削除する</h2>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ rbenv uninstall -f <span class="m">2</span>.0.0-p195
$ rbenv rehash
</pre></div></div>

<h2>
<span id="rbenvを最新版に更新する" class="fragment"></span><a href="#rbenv%E3%82%92%E6%9C%80%E6%96%B0%E7%89%88%E3%81%AB%E6%9B%B4%E6%96%B0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>rbenvを最新版に更新する</h2>

<p>rbenvのインストール方法によるが、今回はgit cloneでインストールしたため、普通にgit pullすればよい。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ cd ~/.rbenv/
$ git pull
$ cd ~/.rbenv/plugins/ruby-build/
$ git pull
</pre></div></div>

<h2>
<span id="rbenvで193-p125より古いrubyをビルドインストールする" class="fragment"></span><a href="#rbenv%E3%81%A7193-p125%E3%82%88%E3%82%8A%E5%8F%A4%E3%81%84ruby%E3%82%92%E3%83%93%E3%83%AB%E3%83%89%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>rbenvで、1.9.3-p125より古いrubyをビルド・インストールする</h2>

<p>1.9.3-p125 より前のバージョンのrubyはllvm-gccではなくGCCでコンパイルされていたようです。よって、Xcode4.2以降がインストールされている場合、GCCがないので（/usr/bin/gccはllvm-gccへのシンボリックリンクとなっている）、ビルドに失敗します。</p>

<p>以下のような感じで失敗します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$CONFIGURE_OPTS="--with-openssl-dir=/opt/local --with-readline-dir=/opt/local --with-iconv-dir=/opt/local" rbenv install 1.8.7-p370

ERROR: This package must be compiled with GCC, but ruby-build couldn't
find a suitable `gcc` executable on your system. Please install GCC
and try again.

DETAILS: Apple no longer includes the official GCC compiler with Xcode
as of version 4.2. Instead, the `gcc` executable is a symlink to
`llvm-gcc`, a modified version of GCC which outputs LLVM bytecode.
For most programs the `llvm-gcc` compiler works fine. However,
versions of Ruby older than 1.9.3-p125 are incompatible with
`llvm-gcc`. To build older versions of Ruby you must have the official
GCC compiler installed on your system.

TO FIX THE PROBLEM: Install the official GCC compiler using these
packages: https://github.com/kennethreitz/osx-gcc-installer/downloads
You will need to install the official GCC compiler to build older
versions of Ruby even if you have installed Apple's Command Line Tools
for Xcode package. The Command Line Tools for Xcode package only
includes `llvm-gcc`.

BUILD FAILED
</pre></div></div>

<p>この対策としては、MacPortsでapple-gcc42をインストールすることです（Homebrewでも同じものがあるようです）。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ sudo port install apple-gcc42
</pre></div></div>

<p>すると、 <code>/opt/local/bin/gcc-apple-4.2</code> ができるので、同階層にgcc-apple-4.2へのシンボリックリンクをgccという名前で作ります。</p>

<p>さらに、ビルドにautoconfが必要なので、それもインストールします。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ sudo port install autoconf
</pre></div></div>

<p>そうして、rubyをもう一度ビルドしてみましょう。今回、ビルドを通すため、さらにいくつかのオプションを追加しています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ CONFIGURE_OPTS="--with-arch=x86_64 --with-openssl-dir=/opt/local --with-readline-dir=/opt/local --with-iconv-dir=/opt/local --without-tk" CFLAGS="-arch x86_64" LDFLAGS="-arch x86_64" rbenv install 1.8.7-p370
</pre></div></div>

<h1>
<span id="謝辞" class="fragment"></span><a href="#%E8%AC%9D%E8%BE%9E"><i class="fa fa-link"></i></a>謝辞</h1>

<p>以下のサイト様の情報をかなり使わせていただきました。ていうかかなりの部分をコp（ry</p>

<ul>
<li>
<a href="http://d.hatena.ne.jp/clmind/20111109/1320814435" rel="nofollow noopener" target="_blank">吾輩のメモである</a>（clmind様）</li>
</ul>

<p>以下のサイト様からも情報をいただきました。</p>

<ul>
<li>
<a href="http://d.hatena.ne.jp/CortYuming/20120618/p1" rel="nofollow noopener" target="_blank">pygo</a>（CortYuming様）</li>
<li>
<a href="http://tech.portalshit.net/2011/11/15/i-am-new-with-rbenv/" rel="nofollow noopener" target="_blank">tech.portalshit.net</a>様</li>
</ul>

<h1>
<span id="こちらの記事もどうぞ" class="fragment"></span><a href="#%E3%81%93%E3%81%A1%E3%82%89%E3%81%AE%E8%A8%98%E4%BA%8B%E3%82%82%E3%81%A9%E3%81%86%E3%81%9E"><i class="fa fa-link"></i></a>こちらの記事もどうぞ</h1>

<p>と思ったんですが、以下の記事はもう古いので参考にしないでください。そのうち更新します。すみません。</p>

<p><del>Ruby、Rails環境のセットアップをマスターしたら、今度は「ぼくがかんがえたさいきょうのRailsてすとかんきょう」を手に入れましょう。以下の記事をどうぞ。</del></p>

<p><del>* <a href="http://qiita.com/emadurandal/items/1062364905f89910297d" id="reference-8ff849537fdadb5c3709">だれがなんといおうとぼくこそさいきょうのRails4テストかんきょう（ｒｙ</a></del></p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />2位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>154</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/1062364905f89910297d">だれがなんといおうとぼくこそさいきょうのRails4テストかんきょう（ｒｙ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-09-27 02:39:09</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Rails]</b> <b>[RSpec]</b> <b>[Cucumber]</b> <b>[FactoryGirl]</b> <b>[spring]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>（※以下の記事はもう古く、Rails4.1時代に追従できていません。他の先輩諸氏の記事を参考にしてください）</p>

<h2>
<span id="はじめに懺悔します" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB%E6%87%BA%E6%82%94%E3%81%97%E3%81%BE%E3%81%99"><i class="fa fa-link"></i></a>はじめに懺悔します</h2>

<p>最強とかウソです。釣りです。すみませんすみませんすみません。</p>

<p>これくらい、みなさんやってますよね。でも、慣れてない人とかいると思いますし、なにがしかの参考になればと思って私の設定を晒します。</p>

<h2>
<span id="導入する項目" class="fragment"></span><a href="#%E5%B0%8E%E5%85%A5%E3%81%99%E3%82%8B%E9%A0%85%E7%9B%AE"><i class="fa fa-link"></i></a>導入する項目</h2>

<p>本記事で導入するテスト関連のGemは以下の通りです。フフフ、圧倒的じゃないか、我が軍は。</p>

<ul>
<li>RSpec　（BDD環境）</li>
<li>Cucumber　（受け入れテスト環境）</li>
<li>Guard　（ファイル変更を監視して、テストを自動化）</li>
<li>Spring　（テスト高速化。テスト以外にもrails gとかrails consoleとか色々高速化してくれる）</li>
<li>Factory Girl　（標準のフィクスチャに不満を感じる全ての方に）</li>
<li>Database Cleaner　（テストのたびにDBをキレイに）</li>
<li>Capybara　（Webブラウザによるアクセスをシミュレートするテストを実現）</li>
<li>coffee-rails-source-maps　（CoffeeScriptのソースマップを出力する）</li>
</ul>

<h2>
<span id="以下手順" class="fragment"></span><a href="#%E4%BB%A5%E4%B8%8B%E6%89%8B%E9%A0%86"><i class="fa fa-link"></i></a>以下、手順</h2>

<h3>
<span id="rbenvでruby20をインストールする" class="fragment"></span><a href="#rbenv%E3%81%A7ruby20%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>rbenvでRuby2.0をインストールする。</h3>

<p>詳しい手順は、私の書いた<a href="http://qiita.com/emadurandal/items/a60886152a4c99ce1017" id="reference-b517ca97a01bd72c857b">この記事</a>を参考にしてください。</p>

<h3>
<span id="rails40のローカルインストール" class="fragment"></span><a href="#rails40%E3%81%AE%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Rails4.0のローカルインストール</h3>

<p>同じく、私の書いた<a href="http://qiita.com/emadurandal/items/a60886152a4c99ce1017">この記事</a>を参考にしてください。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ cat <span class="s">&lt;&lt; EOS &gt; Gemfile</span>
<span class="s">source "http://rubygems.org"</span>
<span class="s">gem "rails", "4.0.0"</span>
<span class="s">EOS</span>
</pre></div></div>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>bundle install --path vendor/bundle
</pre></div></div>

<h3>
<span id="プロジェクト生成" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E7%94%9F%E6%88%90"><i class="fa fa-link"></i></a>プロジェクト生成</h3>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ bundle <span class="nb">exec</span> rails new MyProject -d postgresql --skip-test-unit --skip-bundle
</pre></div></div>

<p><code>--skip-test-unit</code>をつけることで、Rails標準のTest::Unit 関連の設定やファイルの生成を行わないようにします。<br>
また、<code>--skip-bundle</code>によって、プロジェクト生成時の<code>bundle install</code>の発動を抑止します（後に<code>bundle install --path vendor/bundle</code>したいため）。<br>
-dオプションは、使用するデータベースを指定するものです。MySQLの場合は<code>-d mysql</code>。何もつけなければ標準のSQLiteです。ここらへんはお好みで。</p>

<h3>
<span id="gemfileの編集" class="fragment"></span><a href="#gemfile%E3%81%AE%E7%B7%A8%E9%9B%86"><i class="fa fa-link"></i></a>Gemfileの編集</h3>

<p>以下に全文を晒しますが、<code>group :development do ~ end</code> と <code>group :development, :test do ~ end</code> のところだけ追記すればOKです。</p>

<div class="code-frame" data-lang="rb">
<div class="code-lang"><span class="bold">Gemfile</span></div>
<div class="highlight"><pre><span></span><span class="n">source</span> <span class="s1">'https://rubygems.org'</span>

<span class="c1"># Bundle edge Rails instead: gem 'rails', github: 'rails/rails'</span>
<span class="n">gem</span> <span class="s1">'rails'</span><span class="p">,</span> <span class="s1">'4.0.0'</span>

<span class="c1"># Use postgresql as the database for Active Record</span>
<span class="n">gem</span> <span class="s1">'pg'</span>

<span class="c1"># Use SCSS for stylesheets</span>
<span class="n">gem</span> <span class="s1">'sass-rails'</span><span class="p">,</span> <span class="s1">'~&gt; 4.0.0'</span>

<span class="c1"># Use Uglifier as compressor for JavaScript assets</span>
<span class="n">gem</span> <span class="s1">'uglifier'</span><span class="p">,</span> <span class="s1">'&gt;= 1.3.0'</span>

<span class="c1"># Use CoffeeScript for .js.coffee assets and views</span>
<span class="n">gem</span> <span class="s1">'coffee-rails'</span><span class="p">,</span> <span class="s1">'~&gt; 4.0.0'</span>

<span class="c1"># See https://github.com/sstephenson/execjs#readme for more supported runtimes</span>
<span class="c1"># gem 'therubyracer', platforms: :ruby</span>

<span class="c1"># Use jquery as the JavaScript library</span>
<span class="n">gem</span> <span class="s1">'jquery-rails'</span>

<span class="c1"># Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks</span>
<span class="n">gem</span> <span class="s1">'turbolinks'</span>

<span class="c1"># Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder</span>
<span class="n">gem</span> <span class="s1">'jbuilder'</span><span class="p">,</span> <span class="s1">'~&gt; 1.2'</span>

<span class="n">group</span> <span class="ss">:doc</span> <span class="k">do</span>
  <span class="c1"># bundle exec rake doc:rails generates the API under doc/api.</span>
  <span class="n">gem</span> <span class="s1">'sdoc'</span><span class="p">,</span> <span class="nb">require</span><span class="p">:</span> <span class="kp">false</span>
<span class="k">end</span>

<span class="n">group</span> <span class="ss">:development</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s1">'coffee-rails-source-maps'</span> <span class="c1"># CoffeeScriptのソースマップを出力するために必要</span>
<span class="k">end</span>

<span class="n">group</span> <span class="ss">:development</span><span class="p">,</span> <span class="ss">:test</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s1">'spring'</span>
  <span class="n">gem</span> <span class="s1">'rspec-rails'</span>
  <span class="n">gem</span> <span class="s1">'cucumber-rails'</span><span class="p">,</span> <span class="nb">require</span><span class="p">:</span> <span class="kp">false</span><span class="p">,</span> <span class="ss">git</span><span class="p">:</span> <span class="s1">'https://github.com/cucumber/cucumber-rails.git'</span>
  <span class="n">gem</span> <span class="s1">'factory_girl_rails'</span>
  <span class="n">gem</span> <span class="s1">'database_cleaner'</span><span class="p">,</span> <span class="ss">github</span><span class="p">:</span> <span class="s1">'bmabey/database_cleaner'</span>

  <span class="n">gem</span> <span class="s1">'rb-fsevent'</span><span class="p">,</span> <span class="ss">:require</span> <span class="o">=&gt;</span> <span class="kp">false</span> <span class="k">if</span> <span class="no">RUBY_PLATFORM</span> <span class="o">=~</span> <span class="sr">/darwin/i</span> <span class="c1"># OSXの場合のみ、ファイル変更検知のため（それ以外の環境ではポーリングになる）</span>
  <span class="n">gem</span> <span class="s1">'guard-rspec'</span>
  <span class="n">gem</span> <span class="s1">'guard-cucumber'</span>
  <span class="n">gem</span> <span class="s1">'guard-coffeescript'</span> <span class="c1"># app/assets以下はRailsが自動的にコンパイルしてくれるが、テスト用コードは対象外なので、これを入れる</span>

  <span class="n">gem</span> <span class="s1">'capybara'</span><span class="p">,</span> <span class="ss">git</span><span class="p">:</span> <span class="s1">'git://github.com/jnicklas/capybara.git'</span>
<span class="k">end</span>


<span class="c1"># Use ActiveModel has_secure_password</span>
<span class="c1"># gem 'bcrypt-ruby', '~&gt; 3.0.0'</span>

<span class="c1"># Use unicorn as the app server</span>
<span class="c1"># gem 'unicorn'</span>

<span class="c1"># Use Capistrano for deployment</span>
<span class="c1"># gem 'capistrano', group: :development</span>

<span class="c1"># Use debugger</span>
<span class="c1"># gem 'debugger', group: [:development, :test]</span>
</pre></div>
</div>

<p>ところどころgit指定しているのは、通常のバージョンではまだ互換性の問題を抱えていたりして、現時点ではエラーが起きるためです。そこでgitリポジトリから問題が解決されているであろう最新のmasterの内容を取ってきて、対応します。<br>
そのうち、git指定なくても良くなるかもしれませんね。</p>

<h3>
<span id="gemfileで指定したgemのインストール" class="fragment"></span><a href="#gemfile%E3%81%A7%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9Fgem%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Gemfileで指定したgemのインストール</h3>

<p><code>--path vendor/bundle</code> を指定することで、プロジェクト内に閉じた形でGemをインストールできます。たまにこれをやってない人がいますが、今や常識ですので覚えましょう。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ bundle install --path vendor/bundle
</pre></div></div>

<p>なお、現時点では<code>nokogiri</code>というGemがおそらくバージョン1.6.0以降のものがインストールされると思いますが、このインストール処理で、「固まったか！？」というくらい待たされます。<br>
原因については<a href="http://qiita.com/suu_g/items/fcf549e16c797a9d7dc0" id="reference-f77ae1700c0c4afe4ea3">こちらの記事</a>を参照してください。まぁ、辛抱強く待つか記事中の回避策をとられるかはお任せします。</p>

<h3>
<span id="テスト環境のセットアップ" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88%E7%92%B0%E5%A2%83%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>テスト環境のセットアップ</h3>

<h4>
<span id="rspecのインストール" class="fragment"></span><a href="#rspec%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>RSpecのインストール</h4>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ bundle <span class="nb">exec</span> spring rails g rspec:install
</pre></div></div>

<p>エラーが出ないか確認</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ bundle <span class="nb">exec</span> spring rspec

No examples found.


Finished in <span class="m">0</span>.0001 seconds
<span class="m">0</span> examples, <span class="m">0</span> failures
</pre></div></div>

<p>rails g コマンドでモデルやコントローラを作成したときに、同時にRSpecのファイルも生成されるように設定します。<br>
config/application.rb に次の記述を追加します。</p>

<div class="code-frame" data-lang="rb"><div class="highlight"><pre><span></span>    <span class="n">config</span><span class="o">.</span><span class="n">generators</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
      <span class="n">g</span><span class="o">.</span><span class="n">test_framework</span> <span class="o">=</span> <span class="s2">"rspec"</span>
    <span class="k">end</span>
</pre></div></div>

<p>念のために、config/application.rbの全文を晒しましょうか。</p>

<div class="code-frame" data-lang="rb">
<div class="code-lang"><span class="bold">config/application.rb</span></div>
<div class="highlight"><pre><span></span><span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s1">'../boot'</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>

<span class="nb">require</span> <span class="s1">'rails/all'</span>

<span class="c1"># Require the gems listed in Gemfile, including any gems</span>
<span class="c1"># you've limited to :test, :development, or :production.</span>
<span class="no">Bundler</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:default</span><span class="p">,</span> <span class="no">Rails</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>

<span class="k">module</span> <span class="nn">MyProject</span>
  <span class="k">class</span> <span class="nc">Application</span> <span class="o">&lt;</span> <span class="no">Rails</span><span class="o">::</span><span class="no">Application</span>
    <span class="c1"># Settings in config/environments/* take precedence over those specified here.</span>
    <span class="c1"># Application configuration should go into files in config/initializers</span>
    <span class="c1"># -- all .rb files in that directory are automatically loaded.</span>

    <span class="c1"># Set Time.zone default to the specified zone and make Active Record auto-convert to this zone.</span>
    <span class="c1"># Run "rake -D time" for a list of tasks for finding time zone names. Default is UTC.</span>
    <span class="c1"># config.time_zone = 'Central Time (US &amp; Canada)'</span>

    <span class="c1"># The default locale is :en and all translations from config/locales/*.rb,yml are auto loaded.</span>
    <span class="c1"># config.i18n.load_path += Dir[Rails.root.join('my', 'locales', '*.{rb,yml}').to_s]</span>
    <span class="c1"># config.i18n.default_locale = :de</span>

    <span class="n">config</span><span class="o">.</span><span class="n">generators</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
      <span class="n">g</span><span class="o">.</span><span class="n">test_framework</span> <span class="o">=</span> <span class="s2">"rspec"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>

<h4>
<span id="cucumberのインストール" class="fragment"></span><a href="#cucumber%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>cucumberのインストール</h4>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ bundle <span class="nb">exec</span> spring rails g cucumber:install
</pre></div></div>

<p>エラーが出ないか確認</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ bundle <span class="nb">exec</span> spring cucumber

Using the default profile...
<span class="m">0</span> scenarios
<span class="m">0</span> steps
0m0.000s
Run options: --seed <span class="m">28489</span>

<span class="c1"># Running tests:</span>



Finished tests in <span class="m">0</span>.002694s, <span class="m">0</span>.0000 tests/s, <span class="m">0</span>.0000 assertions/s.
</pre></div></div>

<h4>
<span id="guardの初期設定" class="fragment"></span><a href="#guard%E3%81%AE%E5%88%9D%E6%9C%9F%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Guardの初期設定</h4>

<p>Guardfile生成</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ bundle <span class="nb">exec</span> guard init
</pre></div></div>

<p>Guardfileにspringを使うために、記述を修正する。</p>

<div class="code-frame" data-lang="rb"><div class="highlight"><pre><span></span><span class="n">guard</span> <span class="s1">'cucumber'</span><span class="p">,</span> <span class="ss">command_prefix</span><span class="p">:</span> <span class="s1">'spring'</span><span class="p">,</span> <span class="ss">bundler</span><span class="p">:</span> <span class="kp">false</span> <span class="k">do</span>
</pre></div></div>

<div class="code-frame" data-lang="rb"><div class="highlight"><pre><span></span><span class="n">guard</span> <span class="s1">'rspec'</span><span class="p">,</span> <span class="ss">spring</span><span class="p">:</span> <span class="kp">true</span> <span class="k">do</span>
</pre></div></div>

<p>また、テスト用CoffeeScriptコード用の設定を記述する<br>
すでに記述されている <code>guard 'coffeescript', :input =&gt; 'app/assets/javascripts'</code> はコメントアウトする。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span># guard 'coffeescript', :input =&gt; 'app/assets/javascripts'

guard 'coffeescript', output: 'spec/javascripts/compiled' do
  watch(%r{^spec/javascripts/(.*).coffee})
end
</pre></div></div>

<h4>
<span id="factory-girlの設定" class="fragment"></span><a href="#factory-girl%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Factory Girlの設定</h4>

<p>spec/spec_helperに以下を追加。</p>

<div class="code-frame" data-lang="rb"><div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">'factory_girl_rails'</span>
</pre></div></div>

<p>features/support/env.rbに以下を追記。</p>

<div class="code-frame" data-lang="rb"><div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">'factory_girl_rails'</span>
</pre></div></div>

<p>テストの際にテストデータがちゃんと読み込まれるように、 spec_helper.rb に以下を追記。</p>

<div class="code-frame" data-lang="rb"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">before</span><span class="p">(</span><span class="ss">:all</span><span class="p">)</span> <span class="k">do</span>
  <span class="no">FactoryGirl</span><span class="o">.</span><span class="n">reload</span>
<span class="k">end</span>
</pre></div></div>

<p>これで設定は終わりです。お疲れ様でした。</p>

<h2>
<span id="じゃテストするぞー" class="fragment"></span><a href="#%E3%81%98%E3%82%83%E3%83%86%E3%82%B9%E3%83%88%E3%81%99%E3%82%8B%E3%81%9E%E3%83%BC"><i class="fa fa-link"></i></a>じゃ、テストするぞー。</h2>

<p>次のように、Guardを起動すれば……。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ bundle <span class="nb">exec</span> guard
<span class="m">05</span>:54:31 - INFO - Guard is using TerminalTitle to send notifications.
<span class="m">05</span>:54:31 - INFO - Running all features
Disabling profiles...


<span class="m">0</span> scenarios
<span class="m">0</span> steps
0m0.000s

<span class="m">05</span>:54:36 - INFO - Guard::RSpec is running
<span class="m">05</span>:54:36 - INFO - Guard is now watching at <span class="s1">'/Users/smith/dropbox/Program/MyProjects/'</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span> guard<span class="o">(</span>main<span class="o">)</span>&gt;
</pre></div></div>

<p>途中でエラー（スタックトレースなど）が出ずに、最後に、<code>guard(main)&gt;</code> というプロンプトが出ればOKです。<br>
もし、エラーが出てしまった場合は、guardやspring、cucumber、RSpecなどのバージョン間の互換性がとれていない場合があります。ググると大抵、各プロジェクトのgithubのIssueとかで似たようなトラブル報告が引っかかるので、それを参考に対処しましょう。</p>

<p>さて、無事にプロンプトが出たと仮定しますが、使い方が分からない場合は、とりあえず<code>help</code>と入力しましょう。また、何も入力せずにリターンキー（エンターキー）を押すと、全てのテストを強制実行します。Guardを停止したい場合は<code>quit</code>と入力します。</p>

<p>Guardの起動中は、Guardがコンソールを占有するので、他にコマンドラインで作業したい場合は別のコンソールを立ち上げましょう。</p>

<p>さて、これでRSpecやらCucumberやらのファイルを追加・修正するたびにテストが走ります。もうやめられませんね。これは。</p>

<h2>
<span id="coffeescriptによるjavascriptテストについて" class="fragment"></span><a href="#coffeescript%E3%81%AB%E3%82%88%E3%82%8Bjavascript%E3%83%86%E3%82%B9%E3%83%88%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>CoffeeScriptによるJavaScriptテストについて</h2>

<p>今回は人の好みがあると思ってあえて紹介しませんでしたが、JavaScriptのテストも重要ですね。<br>
JasmineとかMochaとか。ググればRails用のGemの紹介記事が見つかると思います。</p>

<p>で、JavaScriptのテストコードですが、やはりCoffeeScriptでスッキリ書きたいものですね。<br>
先ほどの以下の設定により、CoffeeScriptで書いたテストファイルの修正をGuardが検知して再コンパイルしてくれます。<br>
ちなみに以下の設定はJasmine用ですが、Mochaの場合とか、必要に応じて書き換えてください。</p>

<div class="code-frame" data-lang="rb"><div class="highlight"><pre><span></span><span class="n">guard</span> <span class="s2">"coffeescript"</span><span class="p">,</span> <span class="ss">output</span><span class="p">:</span> <span class="s2">"spec/javascripts/compiled"</span> <span class="k">do</span>
  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^spec/javascripts/(.*).coffee}</span><span class="p">)</span>
<span class="k">end</span>
</pre></div></div>

<p>あと、テストというよりデバッグですが、coffee-rails-source-mapsを入れているおかげで、Development環境では常にCoffeeScriptのソースマップが生成されます。Chromeなどでソースマップを有効にしていれば、CoffeeScriptのままステップ実行したりできます。</p>

<h2>
<span id="factorygirlの使い方について" class="fragment"></span><a href="#factorygirl%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>FactoryGirlの使い方について</h2>

<p>一番は<a href="https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md" rel="nofollow noopener" target="_blank">公式の情報</a>を読むことでしょう。一番詳しく書いてあります。が、ちょっと説明が簡素すぎますね。</p>

<p>こちらの<a href="http://blog.livedoor.jp/sasata299/" rel="nofollow noopener" target="_blank">サイト様</a>の記事でも分かりやすく解説されていますね。<br>
<a href="http://blog.livedoor.jp/sasata299/archives/51931175.html" rel="nofollow noopener" target="_blank">factory_girl で最低限知っておきたい4つの使い方</a></p>

<p>また、テストの時だけでなく、開発時にデータ投入したい場合にもFactoryGirlを使うことができます。</p>

<p>Railsコンソールを起動して、</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>bundle <span class="nb">exec</span> spring rails console
</pre></div></div>

<p>FactoryGirlの機能を呼べば良いのです。</p>

<div class="code-frame" data-lang="irb"><div class="highlight"><pre><span></span><span class="go">irb(main):1:0&gt; FactoryGirl.reload</span>
<span class="go">irb(main):2:0&gt; 10.times { FactoryGirl.create(:foo) }</span>
</pre></div></div>

<p>便利ですね。しかし、FactoryGirl……工場娘ですか。なかなか良い響きですね（何が</p>

<h2>
<span id="その他トラブルシューティング" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>その他トラブルシューティング</h2>

<h3>
<span id="プロジェクトのフォルダ名やパスを変更するとrspecでnokogiri関連のエラーが発生する" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E5%90%8D%E3%82%84%E3%83%91%E3%82%B9%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B%E3%81%A8rspec%E3%81%A7nokogiri%E9%96%A2%E9%80%A3%E3%81%AE%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>プロジェクトのフォルダ名やパスを変更するとRspecでnokogiri関連のエラーが発生する。</h3>

<p>　→フォルダ名・パスを元に戻すか、vendor/bundleディレクトリを削除して、bundle updateしなおす。</p>

<h3>
<span id="-bundle-exec-spring-rspecした際に以下のようなエラーが起きた場合" class="fragment"></span><a href="#-bundle-exec-spring-rspec%E3%81%97%E3%81%9F%E9%9A%9B%E3%81%AB%E4%BB%A5%E4%B8%8B%E3%81%AE%E3%82%88%E3%81%86%E3%81%AA%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%8C%E8%B5%B7%E3%81%8D%E3%81%9F%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>$ bundle exec spring rspecした際に、以下のようなエラーが起きた場合。</h3>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>/Users/smith/dropbox/Program/RailsProjects/MyProject/01_Development/xxxx/yyyy/zzzz/MyProject/vendor/bundle/ruby/2.0.0/gems/spring-0.0.10/lib/spring/server.rb:40:in `initialize': too long unix socket path (117bytes given but 104bytes max) (ArgumentError)
</pre></div></div>

<p>プロジェクトの配置場所（パス）が深すぎるので、もっと浅い所に置くか、浅い所にここへのシンボリックリンクを作って、そのシンボリックリンクからプロジェクトを利用する。</p>

<h2>
<span id="ふっきさまらではわたしにグッここのわたしにかたひざをつかせるとはっっ" class="fragment"></span><a href="#%E3%81%B5%E3%81%A3%E3%81%8D%E3%81%95%E3%81%BE%E3%82%89%E3%81%A7%E3%81%AF%E3%82%8F%E3%81%9F%E3%81%97%E3%81%AB%E3%82%B0%E3%83%83%E3%81%93%E3%81%93%E3%81%AE%E3%82%8F%E3%81%9F%E3%81%97%E3%81%AB%E3%81%8B%E3%81%9F%E3%81%B2%E3%81%96%E3%82%92%E3%81%A4%E3%81%8B%E3%81%9B%E3%82%8B%E3%81%A8%E3%81%AF%E3%81%A3%E3%81%A3"><i class="fa fa-link"></i></a>ふっ、きさまらではわたしに…グッ…！　こ、このわたしにかたひざをつかせるとはっっ！</h2>

<p>いかがでしたか。<br>
「うまく動かないよ！」という方はコメントください。<br>
また、「さいきょうを名乗るなど片腹痛いわ！　お前よりオレの方が強いっ！」的なノウハウをお持ちの方もぜひコメントいただけると嬉しいです。</p>

<p>本記事をこまめにアップデートして、つねにさいきょうのおとこをめざしたいとおもいます。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />3位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>64</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/b955a4eaa273529ebba0">heroku postgresのDBにローカルPCから遠隔アクセスする</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-04-10 07:19:30</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Heroku]</b> <b>[PostgreSQL]</b> <b>[NetBeans]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h2>

<p>herokuが提供するPostgreSQLのDBにローカルPCから遠隔ログインし、データを取得・編集できる方法をまとめました。<br>
当方の環境はMac(Mountain Lion)ですが、Windows/Linuxでも同じはずです。</p>

<p>主に、コマンドライン（psql）でアクセスする方法と、GUIのDBクライアントを使う方法があります。</p>

<h2>
<span id="psqlを使う方法" class="fragment"></span><a href="#psql%E3%82%92%E4%BD%BF%E3%81%86%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>psqlを使う方法</h2>

<p><a href="https://toolbelt.heroku.com/" rel="nofollow noopener" target="_blank">heroku toolbelt</a>がインストールされていることを前提とする。<br>
以下のコマンドを実行する。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ heroku pg:psql
</pre></div></div>

<p>これで、psqlでheorkuのPostgreSQL DBにアクセスすることができます。</p>

<h2>
<span id="gui-dbクライアントを使う方法" class="fragment"></span><a href="#gui-db%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%82%92%E4%BD%BF%E3%81%86%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>GUI DBクライアントを使う方法</h2>

<p>ここでは、NetBeansのDBクライアント機能を利用することを前提とする。</p>

<p><strong>（2013/09/27追記：NetBeansよりもお薦めの「pgAdmin」というGUIクライアントを発見した。本記事末尾に紹介したので参考にされたい。HerokuのPostgreSQL DBへのアクセスの仕方は、NetBeansと変わらないはずである。）</strong></p>

<p>まず、herokuの公式Webサイトに自分のアカウントでログインする。そして、DBにアクセスしたいアプリケーション名をクリックする。（プライバシーのため、以下の図はアプリ名にモザイクがかかってます）<br>
<a href="https://camo.qiitausercontent.com/ed0aa8d4583069c5e3a005a4e9584e3c758f4ccb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f37366636623035312d313035322d363261362d623639342d3737656166646231343765662e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/ed0aa8d4583069c5e3a005a4e9584e3c758f4ccb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f37366636623035312d313035322d363261362d623639342d3737656166646231343765662e6a706567" alt="スクリーンショット 2013-01-14 13.44.58.jpg" title="スクリーンショット 2013-01-14 13.44.58.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/76f6b051-1052-62a6-b694-77eafdb147ef.jpeg"></a></p>

<p>「Resources」タブが選択されていることを確認し、「Add-ons」の「Heroku Postgres *<strong><em>」（</em></strong>*は使っているプランによって変わります）をクリックする。<br>
<a href="https://camo.qiitausercontent.com/829e4836df2905e0bf55d86418e0370a4e6c12fe/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f34623334396234322d313035362d663633632d383264322d3430313061666661336432352e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/829e4836df2905e0bf55d86418e0370a4e6c12fe/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f34623334396234322d313035362d663633632d383264322d3430313061666661336432352e6a706567" alt="スクリーンショット-2013-01-14-13.55.45.jpg" title="スクリーンショット-2013-01-14-13.55.45.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/4b349b42-1056-f63c-82d2-4010affa3d25.jpeg"></a></p>

<p>以下のページが表示されるので、herokuのアカウントでログインする。<br>
<a href="https://camo.qiitausercontent.com/3a48f3b23a1dfd8dda9aba8dfb1cefae622a42e7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f37393766663061332d643364332d326235612d363161302d6262363963353832626137312e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/3a48f3b23a1dfd8dda9aba8dfb1cefae622a42e7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f37393766663061332d643364332d326235612d363161302d6262363963353832626137312e6a706567" alt="スクリーンショット 2013-01-14 14.02.12.jpg" title="スクリーンショット 2013-01-14 14.02.12.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/797ff0a3-d3d3-2b5a-61a0-bb69c582ba71.jpeg"></a></p>

<p>ログインすると、データベースのリストが表示されるので、見たいアプリのデータベース名をクリックする。<br>
<a href="https://camo.qiitausercontent.com/d6f119f67556414706b686f9ebeee2a1e54d323f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f39306263623231382d306331362d626530612d623130382d3731353039373632663031662e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/d6f119f67556414706b686f9ebeee2a1e54d323f/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f39306263623231382d306331362d626530612d623130382d3731353039373632663031662e6a706567" alt="スクリーンショット-2013-01-14-14.04.22.jpg" title="スクリーンショット-2013-01-14-14.04.22.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/90bcb218-0c16-be0a-b108-71509762f01f.jpeg"></a></p>

<p>次に、「Connection Settings」の右にある歯車アイコンをクリックしてメニューを表示し、「JDBC URL」を選択する。<br>
<a href="https://camo.qiitausercontent.com/8a00414b3b9619c5e72260a49f9469e67940c1ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f32646630393439362d323862652d323436642d373961322d6566633836393864666164662e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/8a00414b3b9619c5e72260a49f9469e67940c1ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f32646630393439362d323862652d323436642d373961322d6566633836393864666164662e6a706567" alt="スクリーンショット-2013-01-14-14.08.52.jpg" title="スクリーンショット-2013-01-14-14.08.52.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/2df09496-28be-246d-79a2-efc8698dfadf.jpeg"></a></p>

<p>表示されたページで、JDBC URLをコピーして保存しておく。<br>
<a href="https://camo.qiitausercontent.com/d7bbbe8bcbf8cfd3035f9fe9319fe9c86b1b5df6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f61326339383234312d393963632d656365642d636136312d6664623531333931353530352e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/d7bbbe8bcbf8cfd3035f9fe9319fe9c86b1b5df6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f61326339383234312d393963632d656365642d636136312d6664623531333931353530352e6a706567" alt="スクリーンショット 2013-01-14 14.13.24.jpg" title="スクリーンショット 2013-01-14 14.13.24.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/a2c98241-99cc-eced-ca61-fdb513915505.jpeg"></a></p>

<p><a href="https://ja.netbeans.org/" rel="nofollow noopener" target="_blank">NetBeans</a>をインストールする（ここではバージョン7.3.1を想定）。</p>

<p>「サービス」タブ→「ドライバ」→「PostgreSQL」の右クリックでコンテキストメニューを表示し、「接続」をクリックする。以下のページが参考になる。<br>
<a href="http://ubuntu-note.blog.so-net.ne.jp/2010-12-31" rel="nofollow noopener" target="_blank">http://ubuntu-note.blog.so-net.ne.jp/2010-12-31</a>（Ubuntu &amp; Emacs &amp; etc. メモ さんより）</p>

<p>ただ、上記のページで説明しているNetBeansはバージョンが古く、接続設定画面のUIが異なる。バージョン7.3.1では以下のような画面になる。herokupostgresのページで控えたJDBC URLの情報を元に、項目を埋めていく。ホスト、ポート、データーベース、ユーザー名、パスワードの項目を埋めたら、最後にJDBC URLの欄の末尾に<code>?ssl=true&amp;sslfactory=org.postgresql.ssl.NonValidatingFactory</code>という文字列を追加する。<br>
（参考：<a href="https://devcenter.heroku.com/articles/connecting-to-relational-databases-on-heroku-with-java#connecting-to-a-database-remotely" rel="nofollow noopener" target="_blank">devcenter.heroku.com</a>）<br>
そして、「接続をテスト」ボタンを押せば、「接続に成功しました。」と出るはずである。<br>
<a href="https://camo.qiitausercontent.com/2e74080a92ebbccb2a2ad3ac25c1c9a6621e64b8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f31343436653463662d336134652d393030362d316431652d6561633836396665653962342e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/2e74080a92ebbccb2a2ad3ac25c1c9a6621e64b8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f31343436653463662d336134652d393030362d316431652d6561633836396665653962342e6a706567" alt="スクリーンショット-2013-01-14-14.23.39.jpg" title="スクリーンショット-2013-01-14-14.23.39.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/1446e4cf-3a4e-9006-1d1e-eac869fee9b4.jpeg"></a></p>

<p>接続に成功したら、各テーブルのデータを参照したり編集したり、色々できる。<br>
<a href="https://camo.qiitausercontent.com/a16c363b80b41da0a5a673fe54e87b0cc87fa5ce/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f34396335643739392d393334302d356361632d656633612d6134303562656233313234302e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/a16c363b80b41da0a5a673fe54e87b0cc87fa5ce/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f34396335643739392d393334302d356361632d656633612d6134303562656233313234302e6a706567" alt="スクリーンショット 2013-01-14 14.35.31.jpg" title="スクリーンショット 2013-01-14 14.35.31.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/49c5d799-9340-5cac-ef3a-a405beb31240.jpeg"></a></p>

<h3>
<span id="netbeansの問題点" class="fragment"></span><a href="#netbeans%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9"><i class="fa fa-link"></i></a>NetBeansの問題点</h3>

<p>Mac版のみの問題なのか、他のプラットフォーム版でも起きるのか確認していないが、NetBeansのDB機能だと、データを表示するタブが、開いてもしばらく経つと勝手に閉じてしまうという不具合（？）を確認した。</p>

<h2>
<span id="20130927追記netbeansよりもオススメのguiクライアントpgadmin" class="fragment"></span><a href="#20130927%E8%BF%BD%E8%A8%98netbeans%E3%82%88%E3%82%8A%E3%82%82%E3%82%AA%E3%82%B9%E3%82%B9%E3%83%A1%E3%81%AEgui%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88pgadmin"><i class="fa fa-link"></i></a>2013/09/27追記：NetBeansよりもオススメのGUIクライアント「pgAdmin」</h2>

<p>上記の不具合があるNetBeansよりもオススメのGUIクライアントを発見した。「<a href="http://www.pgadmin.org/index.php" rel="nofollow noopener" target="_blank">pgAdmin</a>」である。無料。<br>
UIが若干使いづらいが、PostgreSQL専用ということで、相性は良さそうだ。<br>
ちなみに日本語UIは訳がところどころ不自然なので、環境設定で英語UIに変更することをお勧めする。<br>
HerokuのPostgreSQL DBへのアクセスの仕方は、NetBeansと変わらないはずである。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />4位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>38</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/63716839645c48a49acc">herokuアプリケーションの名前を変更する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-02-01 16:56:56</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Heroku]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>herokuアプリケーションの名前を変更する方法についてのドキュメントです。<br>
といっても大した事は無く、昔はちょっと面倒だったようですが、現在はコマンド一発です。<br>
ということをお伝えしたくて記事にしました。</p>

<h2>
<span id="1-herokuアプリの名前を変更する" class="fragment"></span><a href="#1-heroku%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E5%90%8D%E5%89%8D%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>1. herokuアプリの名前を変更する。</h2>

<p>herokuアプリのディレクトリ内で変更する場合</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ heroku rename 新しい名前
</pre></div></div>

<p>herokuアプリのディレクトリ外で変更する場合</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ heroku rename 新しい名前 --app 古い名前
</pre></div></div>

<p>herokuの管理画面でrenameすることもできますが、その場合だと、herokuコマンドが--app 新しい名前 を付けないと動作しないようになってしまいます。</p>

<p>また、以前は以下の２のステップも必要でしたが、現在は、前者のherokuアプリのディレクトリ内でheroku renameした場合は、２のステップもherokuが自動的にやってくれるようです。</p>

<h2>
<span id="2-gitのリモートのurlを変更する現在は不要" class="fragment"></span><a href="#2-git%E3%81%AE%E3%83%AA%E3%83%A2%E3%83%BC%E3%83%88%E3%81%AEurl%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B%E7%8F%BE%E5%9C%A8%E3%81%AF%E4%B8%8D%E8%A6%81"><i class="fa fa-link"></i></a>2. gitのリモートのURLを変更する（現在は不要）</h2>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ git remote rm heroku
$ git remote add heroku git@heroku.com:新しい名前.git
</pre></div></div>

<h2>
<span id="謝辞" class="fragment"></span><a href="#%E8%AC%9D%E8%BE%9E"><i class="fa fa-link"></i></a>謝辞</h2>

<p>以下のサイト様の情報を大部分使わせていただきました。ありがとうございます。<br>
<a href="http://tokkonopapa.github.com/blog/2011/12/21/heroku-app-name/" rel="nofollow noopener" target="_blank">T.I.D.</a>様</p>

<p>私が追記した情報がとても少なくて、なんか申し訳ないです（汗）<br>
このドキュメントの功績の大部分はT.I.D.様にあります^^;</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />5位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>37</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/fa6fac306bfebd3ba0de">GCD(Grand Central Dispatch)をWindows、Mac、Linuxで利用する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-02-13 21:18:31</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Mac]</b> <b>[Windows]</b> <b>[Linux]</b> <b>[GCD]</b> <b>[マルチスレッド]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h2>

<p>MacでMacOS X Snow Leopardから搭載された、マルチスレッドプログラミング環境「Grand Central Dispatch」（以下、GCD）ですが、Appleがこの技術をオープンソース化した甲斐あり、最近になって、Windows、Linuxにも移植されました。<br>
「<a href="http://opensource.mlba-team.de/xdispatch/docs/current/index.html" rel="nofollow noopener" target="_blank">XDispatch</a>」というものがそれです。<br>
ライセンスはApacheライセンスという、かなり寛大で商用利用も可能なライセンスです。</p>

<p>この記事では、XDispatchを使い、Windows、Mac、Linuxで同一のソースコードで、GCDを利用するサンプルを示していこうと思います。</p>

<p>その前に、GCDの概要、簡単なチュートリアルについては以下の記事をご参照ください。<br>
「<a href="http://ascii.jp/elem/000/000/455/455786/" rel="nofollow noopener" target="_blank">マルチコア時代の新機軸！ Snow LeopardのGCD</a>」（ASCII.jp）</p>

<p>記事を見れば分かるとおり、これまでのマルチスレッドプログラミングで困難だったり面倒だったりする部分をかなり排除してくれる、非常に優れたマルチスレッドプログラミング環境です。<br>
ただ、これまで一番のネックだったのが、「Macでしか使えない」ことでした。しかし、XDispatchが登場したことで、今後はマルチプラットフォームで気兼ねなくGCDを使えることになるでしょう。<br>
これを機に、GCDがもっとメジャーになることを期待しています。</p>

<p>さて、では詳しい使い方を説明していこうと思います。</p>

<h3>
<span id="notice" class="fragment"></span><a href="#notice"><i class="fa fa-link"></i></a>Notice</h3>

<ul>
<li>以下の解説はXDispatchのバージョン0.7.1を前提とします</li>
<li>当方にLinux環境が無いのと、Linuxでの開発におけるIDEやコンパイラのスタンダードが実質存在しないことから、Linux版の解説は省かせていただきます（申し訳ありません）。でも、Linuxをばりばりに使う方であれば、Win版、Mac版の解説を参考に自力でできると思います。</li>
</ul>

<h2>
<span id="インストールとプロジェクトセットアップ" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A8%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>インストールとプロジェクトセットアップ</h2>

<h3>
<span id="windowの場合" class="fragment"></span><a href="#window%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>Windowの場合</h3>

<p>Visual Studio 2010がインストールされていることが前提です。<br>
（Visual C++ 2010 Express Editionでも大丈夫です）<br>
まずは、<a href="http://opensource.mlba-team.de/xdispatch/files/" rel="nofollow noopener" target="_blank">XDispatchのダウンロードページ</a>から、「Windows - x86」をクリックしてダウンロードしましょう。<br>
ダウンロードしたzipファイルを解凍すると、以下のようなフォルダ構成になります。</p>

<p>includeフォルダの中身<br>
<a href="https://camo.qiitausercontent.com/df975f9becf513cc78e04f002b2618feba318535/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d317364626447314943366c45773830616f466841625251764f752d74416a4277" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/df975f9becf513cc78e04f002b2618feba318535/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d317364626447314943366c45773830616f466841625251764f752d74416a4277" alt="includeフォルダの中身" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=1sdbdG1IC6lEw80aoFhAbRQvOu-tAjBw"></a><br>
Visual Studioのプロジェクトを作成したら、プロジェクトプロパティの「構成プロパティ」-&gt;「VC+ ディレクトリ」-&gt;「インクルード ディレクトリ」の項目で、このincludeフォルダのパスを指定しておきましょう。</p>

<p>libフォルダの中身<br>
<a href="https://camo.qiitausercontent.com/39101cab9bcbf63ab7ec12f7eba7eedc08aee7c8/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d31637a6c30535956644d63746b4d6758506f4c436772716b6a5f6d62734d7438" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/39101cab9bcbf63ab7ec12f7eba7eedc08aee7c8/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d31637a6c30535956644d63746b4d6758506f4c436772716b6a5f6d62734d7438" alt="libフォルダの中身" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=1czl0SYVdMctkMgXPoLCgrqkj_mbsMt8"></a><br>
同じく、Visual Studioのプロジェクトを作成したら、プロジェクトプロパティの「構成プロパティ」-&gt;「VC+ ディレクトリ」-&gt;「ライブラリ ディレクトリ」の項目で、このlibフォルダのパスを指定しておきましょう。<br>
また、「構成プロパティ」-&gt;「リンカー」-&gt;「入力」-&gt;「追加の依存ファイル」の項目で<br>
xdispatchD.libとdispatchD.lib（Debug構成の場合）<br>
xdispatch.libとdispatch.lib（Release構成の場合）<br>
を指定します。（今回、QtDispatch.lib、QtDispatchD.libは必要ありません）</p>

<p>binフォルダの中身<br>
<a href="https://camo.qiitausercontent.com/73bd0e70bd9c5a44ad107c543ee2868bfcd46355/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d314f4e7049786633714b6f634241555352677a756648344e5174653634624b77" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/73bd0e70bd9c5a44ad107c543ee2868bfcd46355/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d314f4e7049786633714b6f634241555352677a756648344e5174653634624b77" alt="binフォルダの中身" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=1ONpIxf3qKocBAUSRgzufH4NQte64bKw"></a><br>
これらのdllファイルは実行時に必要です。ビルドしてできたexeファイルと同じディレクトリに、これらのdllファイルを放り込んでおきましょう。</p>

<p>プロジェクト作成時は、プロジェクトテンプレートで「Win32コンソールアプリケーション」を選択します。</p>

<h3>
<span id="macの場合" class="fragment"></span><a href="#mac%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>Macの場合</h3>

<p>XCode 4.5がインストールされていることを想定します。<br>
まずは、XDispatchのダウンロードページから、「Mac OS X  - amd64」をクリックしてダウンロードしましょう。<br>
インストーラ型なので、起動してインストールします。<br>
（ライブラリが/Library/frameworks/xdispatch.frameworkと/Library/frameworks/QtDispatch.frameworkにインストールされます）</p>

<p>プロジェクト作成で、「Command Line Tool」を選択します。<br>
<a href="https://camo.qiitausercontent.com/a7e57fe2b9abd940b79b7b4da89746d0399c9ab1/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d313157785a6968534163555f566c434c555f4f5a694c6131694952724d483538" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/a7e57fe2b9abd940b79b7b4da89746d0399c9ab1/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d313157785a6968534163555f566c434c555f4f5a694c6131694952724d483538" alt="プロジェクト作成で、「Command Line Tool」を選択します。" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=11WxZihSAcU_VlCLU_OZiLa1iIRrMH58"></a></p>

<p>次のダイアログで、Typeを「C++」に設定します。（それ以外の項目は適当に……）<br>
<a href="https://camo.qiitausercontent.com/1873c39abaafb18f9ed6a7bf54c57fae8a617b67/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d316347545a6c5a782d776c52506a554132546c655841634f7072726b4a555777" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/1873c39abaafb18f9ed6a7bf54c57fae8a617b67/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d316347545a6c5a782d776c52506a554132546c655841634f7072726b4a555777" alt="次のダイアログで、Typeを「C++」に設定します。" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=1cGTZlZx-wlRPjUA2TleXAcOprrkJUWw"></a></p>

<p>プロジェクトができます。<br>
<a href="https://camo.qiitausercontent.com/dece435de2d4994af85b269d6f8dc20432918c37/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d31373557707733656b325739306e373056536935753332625065354d55514a30" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/dece435de2d4994af85b269d6f8dc20432918c37/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d31373557707733656b325739306e373056536935753332625065354d55514a30" alt="プロジェクトができます。" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=175Wpw3ek2W90n70VSi5u32bPe5MUQJ0"></a></p>

<p>プロジェクトを選択し、さらにターゲットを選択し、以下の画面で「Framework Search Paths」のところに「/Library/Frameworks」と設定します。<br>
<a href="https://camo.qiitausercontent.com/7255b6cd22c3d82b5e588c4a58f9f5ec7d7c38c6/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d3172444849756c6243584d4c73494a554d774a4a6f4f4a4f2d56426235336b38" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/7255b6cd22c3d82b5e588c4a58f9f5ec7d7c38c6/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d3172444849756c6243584d4c73494a554d774a4a6f4f4a4f2d56426235336b38" alt="プロジェクトを選択し、さらにターゲットを選択し、以下の画面で「Framework Search Paths」のところに「/Library/Frameworks」と設定します。" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=1rDHIulbCXMLsIJUMwJJoOJO-VBb53k8"></a></p>

<p>「C++ Standard Library」で「libstdc++ (GNU C++ standard library)」を選択します。<br>
<a href="https://camo.qiitausercontent.com/00f35b23825f3bdd1bf68e0c6ff4f19c9e3ff8bf/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d3130396c724c4f5a714d5a36695376766d46664276783039316d4355646e5941" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/00f35b23825f3bdd1bf68e0c6ff4f19c9e3ff8bf/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d3130396c724c4f5a714d5a36695376766d46664276783039316d4355646e5941" alt="「C++ Standard Library」で「libstdc++ (GNU C++ standard library)」を選択します。" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=109lrLOZqMZ6iSvvmFfBvx091mCUdnYA"></a></p>

<p>「Build Phase」タブをクリックし、「Link Binary With Libraries」のところで、「System.framework」と「xdispatch.framework」を追加します。<br>
（+ボタンを押して、出てきたダイアログで「Add Other...」ボタンを押し、ファイル選択ダイアログで、それぞれ<br>
/システム/ライブラリ/Frameworks/System.framework<br>
/ライブラリ/Frameworks/xdispatch.framework<br>
を選択します。<br>
）<br>
<a href="https://camo.qiitausercontent.com/7efb4dc21fbb27fa9163b278c84cf2f6a3cbbf82/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d3167574c785a6d2d2d69424b6e6c796f512d5733745a456c4c4365686f5a4f34" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/7efb4dc21fbb27fa9163b278c84cf2f6a3cbbf82/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d3167574c785a6d2d2d69424b6e6c796f512d5733745a456c4c4365686f5a4f34" alt="フレームワークを追加" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=1gWLxZm--iBKnlyoQ-W3tZElLCehoZO4"></a></p>

<h2>
<span id="コーディング" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>コーディング</h2>

<p>cppファイルに、以下のコードを入力します。<br>
（以下のコードの意味は、「<a href="http://ascii.jp/elem/000/000/455/455786/" rel="nofollow noopener" target="_blank">マルチコア時代の新機軸！ Snow LeopardのGCD</a>」（ASCII.jp）を読むと分かります。すみません。手抜きで……）</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>#include &lt;dispatch/dispatch.h&gt;
#include &lt;xdispatch/dispatch.h&gt;
#ifdef _WIN32
#   include &lt;windows.h&gt;
#   include &lt;conio.h&gt;
#endif


int main(int argc, char* argv[])
{
    for (int i = 1; i &lt;= 10; ++i) 
    {
        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0), ${
            printf(" %d", i);
        });
    }
    printf("\nDone!\n");

#ifdef _WIN32 // Windows
    Sleep(1000);
#   ifdef _DEBUG
    printf("\nPress Any Key...\n");
    _getch();
#   endif
#else // Mac, Linux
    sleep(1);
#endif
    return 0;
}
</pre></div></div>

<p>本来、GCDの利用にはBlockというC/C++言語の拡張仕様が必要です。これはいわゆるクロージャに近いもので、<br>
^{ … } と書くことで、処理の中身を他の関数に引き渡すことができます。</p>

<p>ただ、Visual C++などはBlockをサポートしていないので、XDispatchでは<br>
${ … } という書き方をすると、マクロによってVisual C++の場合、これをC++11のlambda（ラムダ）式に置き換えてくれるようです。</p>

<p>なので、Windows、Mac、Linux全ての環境で同一コードで動くようにするためには、^{ … }でなく${ … }と書く必要があります。また、Windows環境でC++11のlambda（ラムダ）式を利用する都合上、.c（C言語）ではなく必ず.cpp（C++）から利用する必要があります。</p>

<h2>
<span id="実行" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>実行</h2>

<p>実行してみると...</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>Done!
 1 3 4 5 6 7 8 9 2 10
</pre></div></div>

<p>できました！</p>

<h2>
<span id="応用編" class="fragment"></span><a href="#%E5%BF%9C%E7%94%A8%E7%B7%A8"><i class="fa fa-link"></i></a>応用編</h2>

<p>先ほどの例では、dispatch_asyncにBlockまたはC++11のラムダ式を直接渡していましたが、いったん外部で変数に保存したBlockまたはC++11のラムダ式をdispatch_asyncに渡すにはどうすればよいのでしょうか？</p>

<p>実は、XDispatchでは、BlockおよびC++11のラムダ式の型を抽象化するようなマクロはまだ用意されていません。<br>
よって、自作する必要があります。<br>
まずは、マクロなしでやってみましょう。</p>

<p>まず、Blockの場合です。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>void (^hello1)(int) = $(int x)
    {
        std::cout &lt;&lt; "Hello, C++ World! " &lt;&lt; x &lt;&lt; std::endl;
    };

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),
                       ${
                           hello1(1000);
                       });
</pre></div></div>

<p>次、C++11のラムダ式の場合です。<br>
（ <code>#include &lt;functional&gt;</code> のインクルードを忘れずに ）</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>std::function&lt;void(int)&gt; hello1 = $(int x)
    {
        std::cout &lt;&lt; "Hello, C++ World! " &lt;&lt; x &lt;&lt; std::endl;
    };

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),
                       ${
                           hello1(1000);
                       });
</pre></div></div>

<p>つまり、上記の変数定義の記述をマクロ化してしまえばいいですね。<br>
こんな感じでしょうか。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>#ifdef _WIN32
#   define $func1(type,funcname,arg1) std::function&lt;type(arg1)&gt;funcname
#else
#   define $func1(type,funcname,arg1) type(^funcname)(arg1)
#endif
</pre></div></div>

<p>すると、以下のような記述で、マルチプラットフォームな共通コードにすることができます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$func1(void,hello1,int) = $(int x)
    {
        std::cout &lt;&lt; "Hello, C++ World! " &lt;&lt; x &lt;&lt; std::endl;
    };

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),
                       ${
                           hello1(1000);
                       });
</pre></div></div>

<p>引数無しバージョン、引数が複数だったバージョン、なども用意しましょう。残念ながら、引数の数だけ、マクロを定義する以外方法はなさそうです。あまり美しくありませんが……。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>#ifdef _WIN32
#   define $func(type,funcname) std::function&lt;type()&gt;funcname
#   define $func1(type,funcname,arg1) std::function&lt;type(arg1)&gt;funcname
#   define $func2(type,funcname,arg1,arg2) std::function&lt;type(arg1,arg2)&gt;funcname
    ...
#else
#   define $func(type,funcname) type(^funcname)()
#   define $func1(type,funcname,arg1) type(^funcname)(arg1)
#   define $func2(type,funcname,arg1,arg2) type(^funcname)(arg1,arg2)
    ...
#endif
</pre></div></div>

<p>なお、C++11のautoを使えば、こんなマクロなんぞ使わなくとも、Windows、Mac、Linuxともに</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>auto hello = $(int x)
    {
        std::cout &lt;&lt; "Hello, C++ World! " &lt;&lt; x &lt;&lt; std::endl;
    };

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0),
                       ${
                           hello1(1000);
                       });
</pre></div></div>

<p>のように書くことができます。ただ、autoはローカル変数とグローバル変数にしか使えないので、クラスのインスタンス変数にBlockやラムダ式を代入したい場合は、上記のマクロを使う必要があります。<br>
あるいは、テンプレートを使う方法もあるのですが、これだとテンプレート地獄に陥る恐れがあるのであまり推奨しません^^;</p>

<p>そもそも、こんなことをするくらいなら、いっそMacやLinuxでもBlockをやめてC++11のラムダ式を使えばいいじゃない、という話もありますね。私もそう思いますw<br>
でも、現在のバージョンのXDispach、Mac（XCode4.5）でstd::functionがコンパイルを通るように、以下の図のように<br>
<a href="https://camo.qiitausercontent.com/62ed2eed5d1f713ad52d9513efdd1833838f7eff/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d317031423639487a7452463075546c337154636f485558394d496c5969734c67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/62ed2eed5d1f713ad52d9513efdd1833838f7eff/68747470733a2f2f646f63732e676f6f676c652e636f6d2f646f63756d656e742f642f316d6949525a6838517465597a6a49695537476a6347537368547034373071486252515568307766313253772f707562696d6167653f69643d316d6949525a6838517465597a6a49695537476a63475373685470343730714862525155683077663132537726696d6167655f69643d317031423639487a7452463075546c337154636f485558394d496c5969734c67" alt="「C++ Standard Library」で「libc++ (LLVM C++ standard library with C++ 11 support)」を選択" data-canonical-src="https://docs.google.com/document/d/1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw/pubimage?id=1miIRZh8QteYzjIiU7GjcGSshTp470qHbRQUh0wf12Sw&amp;image_id=1p1B69HztRF0uTl3qTcoHUX9MIlYisLg"></a><br>
「C++ Standard Library」で「libc++ (LLVM C++ standard library with C++ 11 support)」を選択すると、XDispachのヘッダファイルのところ（が見つかりませんとか出てくる）でコンパイルエラーになっちゃうんですよね……。無理矢理ヘッダファイルを修正してやってみると、今度はなんか実行結果がめちゃくちゃ変な風になるし……。</p>

<p>当面は、BlockとC++11のラムダ式をマクロで抽象化するやり方、またはautoを使う方法が無難のようです……。<br>
もっとも、将来Visual C++がBlockをサポートしてくれるのが一番良いんですけどね。</p>

<h2>
<span id="libqtdispatchについて" class="fragment"></span><a href="#libqtdispatch%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>libQtDispatchについて</h2>

<p>XDispatchには他にも<a href="http://opensource.mlba-team.de/xdispatch/docs/current/group__qtdispatch.html#details" rel="nofollow noopener" target="_blank">libQtDispatch</a>という、GUIツールキット「Qt」と相性の良いライブラリも用意されているようです（これについては、まだ詳しく調べられていません。誰か、記事書いてみませんか？）。</p>

<h2>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h2>

<p>いかがでしたでしょうか。Mac、Windows、Linuxで同一コードでGCDが使えることがおわかりいただけたと思います。<br>
最初にも書きましたが、マルチプラットフォームで使えるようになったことで、マルチスレッドプログラミング環境としてGCDを使う際の一番の懸念点が解消されました。<br>
皆さんも、どんどんGCD(Grand Central Dispatch)を使っていきましょう！</p>

<h2>
<span id="謝辞" class="fragment"></span><a href="#%E8%AC%9D%E8%BE%9E"><i class="fa fa-link"></i></a>謝辞</h2>

<p>GCDを開発・オープンソース化してくれたApple、そしてXDispatchを開発してくれたチームMLBAの皆様に感謝します。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />6位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>31</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/37fae542938907ef5d0c">JSONもどき（値として関数を持つ）をJSON.stringifyしたりJSON.parseしたりする</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-10-09 15:10:00</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[JavaScript]</b> <b>[JSON]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="値として関数を持ったjsonもどき使いたい時ってないですか" class="fragment"></span><a href="#%E5%80%A4%E3%81%A8%E3%81%97%E3%81%A6%E9%96%A2%E6%95%B0%E3%82%92%E6%8C%81%E3%81%A3%E3%81%9Fjson%E3%82%82%E3%81%A9%E3%81%8D%E4%BD%BF%E3%81%84%E3%81%9F%E3%81%84%E6%99%82%E3%81%A3%E3%81%A6%E3%81%AA%E3%81%84%E3%81%A7%E3%81%99%E3%81%8B"><i class="fa fa-link"></i></a>値として関数を持った「JSONもどき」、使いたい時ってないですか？</h2>

<p>皆さん、ご存知の通り、</p>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">json_modoki</span> <span class="o">=</span> 
    <span class="p">{</span>
        <span class="nx">foo</span><span class="o">:</span><span class="mi">100</span><span class="p">,</span>
        <span class="nx">boo</span><span class="o">:</span><span class="s2">"sample text"</span><span class="p">,</span>
        <span class="nx">hoge</span><span class="o">:</span> <span class="p">{</span>
           <span class="nx">muda</span><span class="o">:</span> <span class="s2">"よろしく"</span>
        <span class="p">},</span>
        <span class="nx">func</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello world"</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">hoge</span><span class="p">.</span><span class="nx">muda</span><span class="p">);</span> <span class="p">},</span>
        <span class="nx">func2</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello japan"</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">hoge</span><span class="p">.</span><span class="nx">muda</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>
</pre></div></div>

<p>のような、値として関数を持っているようなものはJSONの仕様上、許されていません。<br>
でも、こういう関数を持った「JSONもどき」って、たまに便利なときがありますよね。</p>

<p>ただ、問題なのがこういう「JSONもどき」ではJSON.stringifyによる文字列化や、<br>
文字列化したものをJSON.parseで「JSONもどき」へ戻すことができないということ。</p>

<p>困りましたねー。</p>

<p>ということで、解決策を作ってみました。いや、私が作ったというか、白状しますと、2chで質問したらスーパーハカーな方が基本的なアイデアを教えてくれました。ありがとうございますｗ</p>

<h2>
<span id="基本方針" class="fragment"></span><a href="#%E5%9F%BA%E6%9C%AC%E6%96%B9%E9%87%9D"><i class="fa fa-link"></i></a>基本方針</h2>

<p>基本方針は、「JSONもどき内で値が関数のものは、文字列に変換する」です。<br>
そして、「JSON.parseするときに、独自のパーサーを渡して、パーサー内で関数文字列をevalして関数に戻す」というものです。</p>

<p>詳細はコードを御覧ください。</p>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">convertFunctionsToStringsInJSON</span><span class="p">(</span><span class="nx">json_with_function</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">json</span> <span class="o">=</span> <span class="nx">json_with_function</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">json</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="o">===</span> <span class="s2">"function"</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">json</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">json</span><span class="p">[</span><span class="nx">key</span><span class="p">].</span><span class="nx">toString</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">json</span><span class="p">;</span>
<span class="p">}</span>


<span class="kd">var</span> <span class="nx">json</span> <span class="o">=</span> 
    <span class="p">{</span>
        <span class="nx">foo</span><span class="o">:</span><span class="mi">100</span><span class="p">,</span>
        <span class="nx">boo</span><span class="o">:</span><span class="s2">"sample text"</span><span class="p">,</span>
        <span class="nx">hoge</span><span class="o">:</span> <span class="p">{</span>
           <span class="nx">muda</span><span class="o">:</span> <span class="s2">"よろしく"</span>
        <span class="p">},</span>
        <span class="nx">func</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello world"</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">hoge</span><span class="p">.</span><span class="nx">muda</span><span class="p">);</span> <span class="p">},</span>
        <span class="nx">func2</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello japan"</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">hoge</span><span class="p">.</span><span class="nx">muda</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>


<span class="nx">convertFunctionsToStringsInJSON</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>


<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"stringified:"</span><span class="o">+</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">json</span><span class="p">));</span>


<span class="kd">var</span> <span class="nx">jsonText</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">parser</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="nx">v</span><span class="p">){</span><span class="k">return</span> <span class="nx">v</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'function'</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">'('</span><span class="o">+</span><span class="nx">v</span><span class="o">+</span><span class="s1">')'</span><span class="p">)</span> <span class="o">:</span> <span class="nx">v</span><span class="p">};</span>
<span class="kd">var</span> <span class="nx">json2</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">jsonText</span><span class="p">,</span> <span class="nx">parser</span><span class="p">);</span>

<span class="nx">json2</span><span class="p">.</span><span class="nx">func</span><span class="p">();</span>
<span class="nx">json2</span><span class="p">.</span><span class="nx">func2</span><span class="p">();</span>
</pre></div></div>

<p>上記のコードは、<a href="http://jsdo.it/emadurandal/eQ4I/" rel="nofollow noopener" target="_blank">jsdo.it</a>でも公開しています。</p>

<h2>
<span id="追記もっと簡単なやり方" class="fragment"></span><a href="#%E8%BF%BD%E8%A8%98%E3%82%82%E3%81%A3%E3%81%A8%E7%B0%A1%E5%8D%98%E3%81%AA%E3%82%84%E3%82%8A%E6%96%B9"><i class="fa fa-link"></i></a>追記：もっと簡単なやり方</h2>

<p>追記：関数の文字列化については、もっと簡単な方法があります。</p>

<p><code>Function.prototype.toJSON = Function.prototype.toString;</code>　とすると、JSON.stringifyの処理での関数の評価時に自動的にtoString()が発動します。</p>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><span></span><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toJSON</span> <span class="o">=</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">json</span> <span class="o">=</span> 
    <span class="p">{</span>
        <span class="nx">foo</span><span class="o">:</span><span class="mi">100</span><span class="p">,</span>
        <span class="nx">boo</span><span class="o">:</span><span class="s2">"sample text"</span><span class="p">,</span>
        <span class="nx">hoge</span><span class="o">:</span> <span class="p">{</span>
           <span class="nx">muda</span><span class="o">:</span> <span class="s2">"よろしく"</span>
        <span class="p">},</span>
        <span class="nx">func</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello world"</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">hoge</span><span class="p">.</span><span class="nx">muda</span><span class="p">);</span> <span class="p">},</span>
        <span class="nx">func2</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello japan"</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">hoge</span><span class="p">.</span><span class="nx">muda</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"stringified:"</span><span class="o">+</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">json</span><span class="p">));</span>

<span class="kd">var</span> <span class="nx">jsonText</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">json</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">parser</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">k</span><span class="p">,</span><span class="nx">v</span><span class="p">){</span><span class="k">return</span> <span class="nx">v</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'function'</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">?</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">'('</span><span class="o">+</span><span class="nx">v</span><span class="o">+</span><span class="s1">')'</span><span class="p">)</span> <span class="o">:</span> <span class="nx">v</span><span class="p">};</span>
<span class="kd">var</span> <span class="nx">json2</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">jsonText</span><span class="p">,</span> <span class="nx">parser</span><span class="p">);</span>

<span class="nx">json2</span><span class="p">.</span><span class="nx">func</span><span class="p">();</span>
<span class="nx">json2</span><span class="p">.</span><span class="nx">func2</span><span class="p">();</span>
</pre></div></div>

<p>こちらも<a href="http://jsdo.it/emadurandal/o3Fr/" rel="nofollow noopener" target="_blank">jsdo.it</a>で公開しました。</p>

<h2>
<span id="最後に" class="fragment"></span><a href="#%E6%9C%80%E5%BE%8C%E3%81%AB"><i class="fa fa-link"></i></a>最後に</h2>

<p>いかがでしょうか。もちろん、こんな「JSONもどき」他のサービスとやりとりしたりなどすることはないと思いますが、自アプリ・自サービス内で内部的に使うのはアリだと思います。</p>

<p>そんなに多くないと思いますが、「このTips使えそう」と思ってくれた方がいらっしゃれば幸いです。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />7位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>25</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/17471bb28b74d2bab7d4">Ember.js公式ガイドを日本語に訳してみたよ！</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-09-08 12:12:09</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ember.js]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h1>
<span id="emberjs公式ガイドの日本語訳を公開しました" class="fragment"></span><a href="#emberjs%E5%85%AC%E5%BC%8F%E3%82%AC%E3%82%A4%E3%83%89%E3%81%AE%E6%97%A5%E6%9C%AC%E8%AA%9E%E8%A8%B3%E3%82%92%E5%85%AC%E9%96%8B%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F"><i class="fa fa-link"></i></a>Ember.js公式ガイドの日本語訳を公開しました。</h1>

<p>正式版がリリースされ、いよいよ注目度も上がってきたMVCフレームワーク「Ember.js」ですが、公式サイトにある<a href="http://emberjs.com/guides/" rel="nofollow noopener" target="_blank">ガイド</a>を日本語に訳したものをGithubに公開しました（もちろん、本家から認可済みです）。</p>

<p><a href="https://github.com/emadurandal/emberjs-guides-japanese-translation" rel="nofollow noopener" target="_blank">https://github.com/emadurandal/emberjs-guides-japanese-translation</a></p>

<p>すでにほぼ全てのページの翻訳が終わっているのですが、一部の記述を1.0ベースの内容に書き換えたり、Markdown形式に書き直す作業が残っている関係で、まだ一部のページしかリポジトリにアップできていません。</p>

<p>できるだけ早く、全てのページを載せられるようにするつもりですので、皆様しばしお待ちください。</p>

<p>こうして日本語のドキュメントもあることだし、皆さん、Ember.jsはもう怖く（？）ありませんよ！</p>

<p>（この日本語訳をきっかけに、Ember.jsコミュニティでは本格的に各言語へのトランスレーション・プロジェクトを立ち上げようという機運が起きつつあるようです。ますます広がるEmber.js……！）</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />8位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>21</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/25f903ebde7a5a7fbf0d">Xcode4.6.xでMakefileを使ってビルド・デバッグするには</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-08-07 12:11:53</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Mac]</b> <b>[Xcode]</b> <b>[Makefile]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h2>

<p>プロジェクトの都合で、ビルドシステムに化石のようなMakeを使わなければならない場合もあるかと思います。でも、自分のマシンではXcodeで開発したいんだ！　という人もいるでしょ？　でしょ？<br>
そんな人のためのセットアップドキュメントです。</p>

<h2>
<span id="筆者の検証環境" class="fragment"></span><a href="#%E7%AD%86%E8%80%85%E3%81%AE%E6%A4%9C%E8%A8%BC%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>筆者の検証環境</h2>

<p>・Xcode4.6.3<br>
・GNU Make 3.81</p>

<h2>
<span id="まずはxcodeプロジェクトを作りましょう" class="fragment"></span><a href="#%E3%81%BE%E3%81%9A%E3%81%AFxcode%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E4%BD%9C%E3%82%8A%E3%81%BE%E3%81%97%E3%82%87%E3%81%86"><i class="fa fa-link"></i></a>まずはXcodeプロジェクトを作りましょう。</h2>

<p>まずは、Xcodeプロジェクトを作りましょう。<br>
メニューのFile-&gt;New-&gt;Project...を選択し、出てきたダイアログで<code>Command Line Tool</code>を選択し、Nextボタンを押します。<br>
<a href="https://camo.qiitausercontent.com/85df184290975ebdcf3bf6cd2e27b6f00f813696/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f37393432323263662d656339362d366638342d316536662d3136353430313966633165632e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/85df184290975ebdcf3bf6cd2e27b6f00f813696/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f37393432323263662d656339362d366638342d316536662d3136353430313966633165632e6a706567" alt="スクリーンショット 2013-08-07 11.32.34.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/794222cf-ec96-6f84-1e6f-1654019fc1ec.jpeg"></a></p>

<p>次の画面で、<code>Project Name</code>を適当に入力します。ここでは「PracticeMakefile」としました。<br>
<code>Type</code>は<code>C</code>でも<code>C++</code>でもどちらでもいいですが、ここでは<code>C</code>にします。<br>
<a href="https://camo.qiitausercontent.com/7eea2b7e6740d3a1bb4d44d48edf6381eed59468/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f36633739633662382d663332612d386632382d333534332d3165306236663932646232302e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/7eea2b7e6740d3a1bb4d44d48edf6381eed59468/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f36633739633662382d663332612d386632382d333534332d3165306236663932646232302e6a706567" alt="スクリーンショット 2013-08-07 11.35.25.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/6c79c6b8-f32a-8f28-3543-1e0b6f92db20.jpeg"></a></p>

<p>Nextボタンを押します。</p>

<p>次のファイル指定ダイアログで、プロジェクトの保存先を指定します。</p>

<p>こんな感じのプロジェクトができました。<br>
<a href="https://camo.qiitausercontent.com/4179864795a1334713bd94cfce92ce01a70e0e66/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f39633630393565352d333362392d666466632d323932632d3437643137336164356130312e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/4179864795a1334713bd94cfce92ce01a70e0e66/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f39633630393565352d333362392d666466632d323932632d3437643137336164356130312e6a706567" alt="スクリーンショット 2013-08-07 11.37.31.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/9c6095e5-33b9-fdfc-292c-47d173ad5a01.jpeg"></a></p>

<h2>
<span id="make用のターゲットを追加する" class="fragment"></span><a href="#make%E7%94%A8%E3%81%AE%E3%82%BF%E3%83%BC%E3%82%B2%E3%83%83%E3%83%88%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Make用のターゲットを追加する。</h2>

<p>メニューのFile-&gt;New-&gt;Target...を選択し、OSX-&gt;Other-&gt;External Build Systemを選択し、Nextボタンをクリックします。<br>
<a href="https://camo.qiitausercontent.com/645b869a1e364b4f9734d7e1e107983c23cefe00/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f36326635323937302d373835622d363766312d353732392d3061363830663434323733642e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/645b869a1e364b4f9734d7e1e107983c23cefe00/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f36326635323937302d373835622d363766312d353732392d3061363830663434323733642e6a706567" alt="スクリーンショット 2013-08-07 11.43.17.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/62f52970-785b-67f1-5729-0a680f44273d.jpeg"></a></p>

<p>次の画面で、<code>Product Name</code>を適当に入力します。ここでは「Make」としました。<code>Build Tool</code>が<code>/usr/bin/make</code>となっていることを確認してください。<br>
<a href="https://camo.qiitausercontent.com/91450ab1a6ac7c38d28fcf3a8450643fc40731a5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f39363133396630622d663933612d613038322d616664662d3237633462623338656564322e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/91450ab1a6ac7c38d28fcf3a8450643fc40731a5/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f39363133396630622d663933612d613038322d616664662d3237633462623338656564322e6a706567" alt="スクリーンショット 2013-08-07 11.44.19.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/96139f0b-f93a-a082-afdf-27c4bb38eed2.jpeg"></a><br>
Finishボタンを押します。</p>

<h2>
<span id="makefileを作成追加する" class="fragment"></span><a href="#makefile%E3%82%92%E4%BD%9C%E6%88%90%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Makefileを作成・追加する。</h2>

<p>今回は例ですので、以下のような超シンプルなMakefileを書いてみます。<br>
（-gオプションを忘れないでください。これがないとデバッガ使えません）</p>

<div class="code-frame" data-lang="mf"><div class="highlight"><pre><span></span><span class="nf">all</span><span class="o">:</span> <span class="n">main</span>.<span class="n">c</span>
    gcc -Wall -g -o main main.c
</pre></div></div>

<p>できたMakefileを、プロジェクトに追加します。<br>
<a href="https://camo.qiitausercontent.com/f1f04c9dcad830e44dadbaf6f9767aa3dfb8d14e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f38303561356539302d656630362d306130652d303563302d6238663230653164316637632e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/f1f04c9dcad830e44dadbaf6f9767aa3dfb8d14e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f38303561356539302d656630362d306130652d303563302d6238663230653164316637632e6a706567" alt="スクリーンショット 2013-08-07 11.46.08.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/805a5e90-ef06-0a0e-05c0-b8f20e1d1f7c.jpeg"></a></p>

<h2>
<span id="一度コマンドラインでmakeを実行する" class="fragment"></span><a href="#%E4%B8%80%E5%BA%A6%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%81%A7make%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>一度、コマンドラインでmakeを実行する。</h2>

<p>ここで一度、コマンドラインでmakeを実行します。この先の手順で、Xcodeで実行可能ファイルを指定する必要があり、実行可能ファイルの実体が必要なためです。</p>

<h2>
<span id="makeスキーマの設定" class="fragment"></span><a href="#make%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Makeスキーマの設定</h2>

<h3>
<span id="ディレクトリの指定" class="fragment"></span><a href="#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E6%8C%87%E5%AE%9A"><i class="fa fa-link"></i></a>ディレクトリの指定</h3>

<p>プロジェクトウィンドウの左ペインから、プロジェクト「PracticeMakefile」を選択し、その右隣のペインでターゲット「Make」を選択します。そしてその右のペインの<code>Info</code>タブをクリックすると、以下のような画面になります。ここで、<code>Directory</code>のフィールドに<code>$(PROJECT)</code>と入力してください。あるいは、プロジェクトフォルダへのフルパスを入力してもかまいません。<br>
<a href="https://camo.qiitausercontent.com/ea9af1ac9326b4e5893b9200483635992985c740/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f39323732376630622d346165372d396632622d356635392d6662643563656466323239642e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/ea9af1ac9326b4e5893b9200483635992985c740/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f39323732376630622d346165372d396632622d356635392d6662643563656466323239642e6a706567" alt="スクリーンショット 2013-08-07 11.57.49.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/92727f0b-4ae7-9f2b-5f59-fbd5cedf229d.jpeg"></a></p>

<h3>
<span id="実行可能ファイルの指定" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E5%8F%AF%E8%83%BD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%8C%87%E5%AE%9A"><i class="fa fa-link"></i></a>実行可能ファイルの指定</h3>

<p>メニューの<code>Product-&gt;Scheme-&gt;Edit Scheme</code>を選択し、出てきた画面で、上部のSchemeで「Make」を選びます。次に、左ペインのRun-&gt;Runを選択し、右側のペインでInfoタブを押します。<br>
<a href="https://camo.qiitausercontent.com/5ea9b63a16ee53c06b49a6a5ce0765c0a713eff1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f36306465656334652d616437642d316562302d346630612d3432383131646335643334642e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/5ea9b63a16ee53c06b49a6a5ce0765c0a713eff1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f36306465656334652d616437642d316562302d346630612d3432383131646335643334642e6a706567" alt="スクリーンショット 2013-08-07 11.51.35.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/60deec4e-ad7d-1eb0-4f0a-42811dc5d34d.jpeg"></a></p>

<p>Excutableの<code>None</code>をクリックし、出てきたメニューで<code>Other...</code>をクリック、出てきた選択ダイアログで、先ほどmakeして作成した実行可能ファイル「make」を選びます。</p>

<p><a href="https://camo.qiitausercontent.com/a815c91c8ea5e26e1acb8340366a5a8718db0607/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f38343862323838342d626166302d663463612d373263662d3264303737636336386535302e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/a815c91c8ea5e26e1acb8340366a5a8718db0607/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f38343862323838342d626166302d663463612d373263662d3264303737636336386535302e6a706567" alt="スクリーンショット 2013-08-07 11.53.08.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/848b2884-baf0-f4ca-72cf-2d077cc68e50.jpeg"></a></p>

<p>選択し終えたら、OKボタンを押します。</p>

<h2>
<span id="いよいよビルド実行" class="fragment"></span><a href="#%E3%81%84%E3%82%88%E3%81%84%E3%82%88%E3%83%93%E3%83%AB%E3%83%89%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>いよいよビルド、実行！</h2>

<p>プロジェクトウィンドウ左上のRunボタンを押して、ビルド・実行してみましょう。成功するはずです。<br>
ブレークポイントをしかければ、そこでちゃんと止まることも確認できます。<br>
<a href="https://camo.qiitausercontent.com/4e0b051b583a3d9ec9cf49b79f379688f6692725/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f62376636343936362d313365642d356333392d393036632d3436636630303266633036332e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/4e0b051b583a3d9ec9cf49b79f379688f6692725/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f62376636343936362d313365642d356333392d393036632d3436636630303266633036332e6a706567" alt="スクリーンショット 2013-08-07 19.48.57.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/b7f64966-13ed-5c39-906c-46cf002fc063.jpeg"></a></p>

<h2>
<span id="makefileのターゲットを指定するには" class="fragment"></span><a href="#makefile%E3%81%AE%E3%82%BF%E3%83%BC%E3%82%B2%E3%83%83%E3%83%88%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B%E3%81%AB%E3%81%AF"><i class="fa fa-link"></i></a>Makefileのターゲットを指定するには</h2>

<p>Makefileのターゲットが複数あったとして</p>

<div class="code-frame" data-lang="mf"><div class="highlight"><pre><span></span><span class="nf">hello</span><span class="o">:</span> <span class="n">main</span>.<span class="n">c</span>
    gcc -Wall -O2 -g -o hello main.c
<span class="nf">hello2</span><span class="o">:</span> <span class="n">main</span>.<span class="n">c</span>
    gcc -Wall -O2 -g -o hello2 main.c
</pre></div></div>

<p>hello2を実行したい場合は、<br>
プロジェクトウィンドウの左ペインから、プロジェクト「PracticeMakefile」を選択し、その右隣のペインでターゲット「Make」を選択します。そしてその右のペインの<code>Info</code>タブをクリックすると、以下のような画面になります。ここで、<code>Arguments</code>のフィールドに<code>hello2</code>と入力してください。<br>
<a href="https://camo.qiitausercontent.com/1198a33230d643de1474559da4b2e682d6e985c1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f34356433386137342d356437322d336635312d616532372d3633326131363761663438322e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/1198a33230d643de1474559da4b2e682d6e985c1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f34356433386137342d356437322d336635312d616532372d3633326131363761663438322e6a706567" alt="スクリーンショット 2013-08-07 18.35.27.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/45d38a74-5d72-3f51-ae27-632a167af482.jpeg"></a></p>

<p>これで、hello2のターゲットが実行されるようになります。</p>

<h2>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h2>

<p>いかがでしたでしょうか。プロジェクトが大きくなり、いずれ再帰的なMakefile構成になったとしても、多分このやり方でいけると思います。<br>
Make+VimやMake+Emacsで十分という方もいらっしゃるかもしれませんが、やはりXcodeの豊富な開発支援機能の魅力は捨てがたいものがあります。<br>
そこで、マカーな人ならMake+Xcodeというわけです。<br>
ビルドシステムが古風な分、他はリッチな環境で行こうではありませんか。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />9位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>21</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/0ed7ad242fe58403bf0e">今頃「The RSpec Book」の第１９章（Railsのテスト）以降を試すには</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-07-01 18:38:55</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Rails]</b> <b>[RSpec]</b> <b>[Cucumber]</b> <b>[rbenv]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h1>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>

<p>RubyにおけるBDDを学ぶにあたり、今でも貴重な情報源である書籍「<a href="http://books.shoeisha.co.jp/book/b94964.html" rel="nofollow noopener" target="_blank">The RSpec Book</a>」ですが、Rails 3.0.0前提の内容になっています。<br>
今やRailsは4.0までリリースされていますが、Rails3との差異はかなり大きなものです。</p>

<p>この本の内容を、Rails4.0.x及び最新バージョンのRSpec/Cucumberで実践するのは、おそらくエラーが大量発生することが予想され、さすがに無理があります。</p>

<p>なので、おとなしく本の最初で示されている各種gemのバージョンそのままのものを使うことが賢明です。<br>
本の内容を滞り無く進めて大筋を理解してから、次にRails、RSpec、Cucumberの最新バージョンを学びましょう。</p>

<h1>
<span id="しかしちょっとした問題が" class="fragment"></span><a href="#%E3%81%97%E3%81%8B%E3%81%97%E3%81%A1%E3%82%87%E3%81%A3%E3%81%A8%E3%81%97%E3%81%9F%E5%95%8F%E9%A1%8C%E3%81%8C"><i class="fa fa-link"></i></a>しかし、ちょっとした問題が……</h1>

<h2>
<span id="rails-300-がインストールできない" class="fragment"></span><a href="#rails-300-%E3%81%8C%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>Rails 3.0.0 がインストールできない</h2>

<p>ここでは、Rubyは1.8.7を使う事を前提とします。Rubyの導入に関しては、以前私が書いた<a href="http://qiita.com/emadurandal/items/a60886152a4c99ce1017" id="reference-dd2fc3a77e7a290ea015">この記事</a>をご覧下さい。</p>

<p>まずは、bundlerをインストールする必要があるのですが、今普通に</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ rbenv <span class="nb">exec</span> gem install bundler
</pre></div></div>

<p>とすると、バージョン1.3.2以降がインストールされてしまいます。このバージョンのbundlerはバージョンが新しすぎて、Rails3.0.0をインストールできません（エラーが起きます）。<br>
そこで、以下のようにしてバージョン1.0.22をインストールします。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ rbenv <span class="nb">exec</span> gem install bundler --version <span class="s2">"= 1.0.22"</span>
</pre></div></div>

<p>その上で、<a href="http://qiita.com/emadurandal/items/a60886152a4c99ce1017">この記事</a>を参考に、Rails3.0.0をローカルインストールしましょう。</p>

<h2>
<span id="rails300プロジェクトのgemのインストールに失敗する" class="fragment"></span><a href="#rails300%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AEgem%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%AB%E5%A4%B1%E6%95%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Rails3.0.0プロジェクトのGemのインストールに失敗する</h2>

<p>第19章 p. 276で、Gemfileの内容が示されているのですが、このままだとBundlerがRakeやRSpec、Cucumber、依存関係で必要なnokogiriなどについて、最新バージョンをインストールしようとしてしまい、エラーが発生します。<br>
そこで、古いバージョンを指定する必要があります。<br>
私の方で検証済みのGemfileを以下に示しますので、この通りにやってください。</p>

<div class="code-frame" data-lang="rb"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="s1">'http://rubygems.org'</span>

<span class="n">gem</span> <span class="s1">'rails'</span><span class="p">,</span> <span class="s1">'3.0.0'</span>

<span class="c1"># Bundle edge Rails instead:</span>
<span class="c1"># gem 'rails', :git =&gt; 'git://github.com/rails/rails.git'</span>

<span class="n">gem</span> <span class="s1">'sqlite3-ruby'</span><span class="p">,</span> <span class="ss">:require</span> <span class="o">=&gt;</span> <span class="s1">'sqlite3'</span>

<span class="n">gem</span> <span class="s1">'rake'</span><span class="p">,</span> <span class="s1">'= 0.8.7'</span>

<span class="n">group</span> <span class="ss">:development</span><span class="p">,</span> <span class="ss">:test</span> <span class="k">do</span>
  <span class="n">gem</span> <span class="s2">"rspec"</span><span class="p">,</span> <span class="s2">"= 2.0.0"</span>
  <span class="n">gem</span> <span class="s2">"rspec-rails"</span><span class="p">,</span> <span class="s2">"= 2.0.0"</span>
  <span class="n">gem</span> <span class="s1">'nokogiri'</span><span class="p">,</span> <span class="s1">'= 1.5.10'</span>
  <span class="n">gem</span> <span class="s2">"cucumber"</span><span class="p">,</span> <span class="s2">"= 0.9.2"</span>
  <span class="n">gem</span> <span class="s2">"cucumber-rails"</span><span class="p">,</span> <span class="s2">"= 0.3.2"</span>
  <span class="n">gem</span> <span class="s2">"webrat"</span><span class="p">,</span> <span class="s2">"= 0.7.2"</span>
  <span class="n">gem</span> <span class="s2">"database_cleaner"</span><span class="p">,</span> <span class="s2">"= 0.5.2"</span>
<span class="k">end</span>

<span class="c1"># Use unicorn as the web server</span>
<span class="c1"># gem 'unicorn'</span>

<span class="c1"># Deploy with Capistrano</span>
<span class="c1"># gem 'capistrano'</span>

<span class="c1"># To use debugger</span>
<span class="c1"># gem 'ruby-debug'</span>

<span class="c1"># Bundle the extra gems:</span>
<span class="c1"># gem 'bj'</span>
<span class="c1"># gem 'nokogiri'</span>
<span class="c1"># gem 'sqlite3-ruby', :require =&gt; 'sqlite3'</span>
<span class="c1"># gem 'aws-s3', :require =&gt; 'aws/s3'</span>

<span class="c1"># Bundle gems for the local environment. Make sure to</span>
<span class="c1"># put test-only gems in this group so their generators</span>
<span class="c1"># and rake tasks are available in development mode:</span>
<span class="c1"># group :development, :test do</span>
<span class="c1">#   gem 'webrat'</span>
<span class="c1"># end</span>
</pre></div></div>

<p>以上。あとは本の内容を進めて行きましょう。Good Luck!</p>

<h1>
<span id="その他気になったこと" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96%E6%B0%97%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a>その他、気になったこと</h1>

<h2>
<span id="いまさらwebrat" class="fragment"></span><a href="#%E3%81%84%E3%81%BE%E3%81%95%E3%82%89webrat"><i class="fa fa-link"></i></a>いまさらWebrat？</h2>

<p>21章では、Webratを使った、ブラウザシミュレート型のテストについて書かれています。capybara全盛の時代に今更Webrat？　とも思ったのですが、調べてみるとcapybaraはWebratからインスパイアされており、多くの関数で後方互換性があるとのことです。<br>
なので、この本でWebratを使って学んだテスト作法は、おそらく将来capybaraを使う際にも活かせると思います。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />10位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>20</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/478c0607082c3ad2f7ca">【募集】技術を教え合いっこしませんか？</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-12-03 07:26:51</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[スキル交換]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="/puriketu99" class="user-mention js-hovercard" title="puriketu99" data-hovercard-target-type="user" data-hovercard-target-name="puriketu99">@puriketu99</a>さんが、<a href="http://qiita.com/puriketu99/items/7370901978887fe59a49" id="reference-f553079cf7cb337fe11e">面白い試み</a> をされていたので・・・。</p>

<p>私もやってみます。</p>

<h2>
<span id="教えてほしいこと優先度順" class="fragment"></span><a href="#%E6%95%99%E3%81%88%E3%81%A6%E3%81%BB%E3%81%97%E3%81%84%E3%81%93%E3%81%A8%E5%84%AA%E5%85%88%E5%BA%A6%E9%A0%86"><i class="fa fa-link"></i></a>教えてほしいこと　（優先度順）</h2>

<p>・大規模なプログラムや大型ツールを作る際の、高度な設計技術（GoFのデザインパターンなどは知っているので、それ以上のノウハウが知りたい）<br>
・TypeScriptの実践的な使いこなし（基礎はできるんですが、それ以上のことが・・・）<br>
・Railsの上級知識（高度な使い方、パフォーマンスチューニング、テストなど）<br>
・JavaScriptのハードコアなところ<br>
・WordPress（一般的な使用方法でなく、カスタマイズ開発など）<br>
・Webデザイン全般<br>
・PostgreSQL（実際の運用で必要なノウハウなど）</p>

<h2>
<span id="教えられること得意な順" class="fragment"></span><a href="#%E6%95%99%E3%81%88%E3%82%89%E3%82%8C%E3%82%8B%E3%81%93%E3%81%A8%E5%BE%97%E6%84%8F%E3%81%AA%E9%A0%86"><i class="fa fa-link"></i></a>教えられること　（得意な順）</h2>

<p>・リアルタイム３DCGの理論<br>
・OpenGL/DirectX/WebGL/Three.js<br>
・Ember.jsの基礎<br>
・Javascript/Typescriptの基礎<br>
・Railsの基礎</p>

<h2>
<span id="段取り" class="fragment"></span><a href="#%E6%AE%B5%E5%8F%96%E3%82%8A"><i class="fa fa-link"></i></a>段取り</h2>

<ol>
<li>教えられることと教えて欲しいことを私に伝えてもらう。</li>
<li>軽く自己紹介＆自分の技術バックグラウンドの説明。</li>
<li>教えあう時間帯や、やりとりの方法などを話し合う。</li>
<li>合意ができれば、GO！</li>
</ol>

<p>興味持たれた方は、私のTwitterアカウントまたはこの記事のコメントにてご連絡ください。</p>

<p>契約とか、あまり堅苦しいやり方でなく、ラフな感じでやれればと思うのですが、もっとこう・・・ちゃんとやりたいという方は、合わせます。</p>

<p>っていうか、こういう、「スクールに通うほどのお金はないけど、これは教えるから逆にそっち教えて系のサービスも作ってよ」的なことを以前Qiitaサポートにリクエストしたんですが、華麗にスルーされたんですよね（笑）</p>

<p>みんなで、この手の投稿をするのをはやらせれば、もしかしたらQiita運営も何か考えてくれるかもしれません。</p>

<p>というわけで、みなさんも「教えてほしいスキル」と「教えられるスキル」を晒してみよー！</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />11位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>15</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/53094204d0810f98fa0b">Windows上（Geforce）でOpenGL ES 3.0を試してみる。</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-08-09 20:10:52</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Windows]</b> <b>[OpenGLES]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h2>

<p>OpenGL ES 3.0、始まってきましたね。Androidが4.3にて正式サポートを開始し、いよいよモバイルデバイスでもPlayStation 3 / Xbox 360世代を少し上回るような高度な表現が可能になってきました。<br>
いずれ、近いうちにiOSも追従してサポートするでしょうし、今後モバイルデバイスで3Dを扱いたい人はぜひES 3.0をマスターしましょう。</p>

<p>OpenGL ES 3.0で何が変わったかについては、以下のサイトが詳しいです。<br>
<a href="http://www.kumikomi.net/archives/2012/09/ep11gles.php" rel="nofollow noopener" target="_blank">組み込み向け3DグラフィックスAPIの最新版「OpenGL ES 3.0」が登場</a></p>

<p>しかし、試そうにもES 3.0に対応したモバイルデバイスはまだまだ少ないのが実情です。できれば、Windows上で試したいですよね。実は、デスクトップ向けのOpenGL4.3に対応したGPUでは、OpenGL ES 3.0互換環境を利用することができます。<br>
この記事では、その利用方法（OpenGL ES 3.0コンテキストの初期化方法）について解説します。</p>

<h2>
<span id="前提知識" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90%E7%9F%A5%E8%AD%98"><i class="fa fa-link"></i></a>前提知識</h2>

<p>OpenGLについて、ある程度なれている方が前提です。<br>
また、WGLについても、多少の知識があることが望ましいです。</p>

<h2>
<span id="前提環境" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>前提環境</h2>

<ul>
<li>Window XP以降（筆者はWindows 7 64bit で動作確認）</li>
<li>OpenGL4.3に対応したnVidia社製 GPU（筆者はGeforce GT 520で動作確認）</li>
</ul>

<p>（GPUのドライバーは最新のバージョンをインストールしてください）</p>

<h2>
<span id="準備" class="fragment"></span><a href="#%E6%BA%96%E5%82%99"><i class="fa fa-link"></i></a>準備</h2>

<p><a href="http://www.opengl.org/registry/" rel="nofollow noopener" target="_blank">OpenGL Registry</a> から wglext.h をダウンロードし、インクルードします。</p>

<h2>
<span id="コード説明" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>コード説明</h2>

<p>以下が初期化コードになります。<br>
このコードだけじゃ全体像がわからないよ！　という方は、<br>
こちらのサイト様のサンプルコードをご覧ください。<br>
<a href="http://blogs.yahoo.co.jp/simasaki2001/24983992.html" rel="nofollow noopener" target="_blank">OpenGL(WGL)サンプルプログラム on Windows7（fujinsブログ様）</a></p>

<p>以下のコードは、上記サイト様のサンプルコードの初期化コード部分を、私がOpenGL ES 3.0にあわせて改変したものになります。</p>

<p>ちなみにWGLとは、Windows依存のOpenGL関連機能（Windows向けのOpenGLレンダリングコンテキストを作成したり、OpenGLの拡張関数を取得するなど）を利用するためのAPIです。</p>

<p>処理の手順としては、次のようになります。<br>
1. PIXELFORMATDESCRIPTOR型の変数として、ピクセルフォーマットを作成する。<br>
2. ChoosePixelFormat() を使って、フォーマットのマッチングを行う。<br>
3. 4のステップのために、通常の手段で 仮のContext を作成し wglMakeCurrent() でコンテキストを有効にする。<br>
4. WGL の拡張 API 、wglCreateContextAttribsARB() を取得する。<br>
5. wglCreateContextAttribsARB() を使って OpenGL ES 3.0 コンテキストを作る。<br>
6. 3のステップで作った仮のコンテキストを削除する。</p>

<div class="code-frame" data-lang="cpp"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">initGL</span><span class="p">(</span> <span class="n">HWND</span> <span class="n">hwnd</span><span class="p">,</span> <span class="n">HDC</span> <span class="o">*</span><span class="n">p_hdc</span><span class="p">,</span> <span class="n">HGLRC</span> <span class="o">*</span><span class="n">p_hglrc</span> <span class="p">)</span> <span class="p">{</span>

    <span class="c1">// ピクセルフォーマットの指定</span>
    <span class="k">static</span> <span class="n">PIXELFORMATDESCRIPTOR</span>   <span class="n">pformat</span><span class="o">=</span> <span class="p">{</span>
        <span class="k">sizeof</span><span class="p">(</span><span class="n">PIXELFORMATDESCRIPTOR</span><span class="p">),</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="mi">0</span>
        <span class="o">|</span><span class="n">PFD_DRAW_TO_WINDOW</span>
        <span class="o">|</span><span class="n">PFD_SUPPORT_OPENGL</span>
        <span class="o">|</span><span class="n">PFD_DOUBLEBUFFER</span>
        <span class="p">,</span>
        <span class="n">PFD_TYPE_RGBA</span><span class="p">,</span>
        <span class="mi">32</span><span class="p">,</span>     <span class="c1">// color</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="c1">// R</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="c1">// G</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="c1">// B</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="c1">// A</span>
        <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>      <span class="c1">// AC R G B A</span>
        <span class="mi">24</span><span class="p">,</span>     <span class="c1">// depth</span>
        <span class="mi">8</span><span class="p">,</span>      <span class="c1">// stencil</span>
        <span class="mi">0</span><span class="p">,</span>      <span class="c1">// aux</span>
        <span class="mi">0</span><span class="p">,</span>      <span class="c1">// layertype</span>
        <span class="mi">0</span><span class="p">,</span>  <span class="c1">// reserved</span>
        <span class="mi">0</span><span class="p">,</span>  <span class="c1">// layermask</span>
        <span class="mi">0</span><span class="p">,</span>  <span class="c1">// visiblemask</span>
        <span class="mi">0</span>   <span class="c1">// damagemask</span>
    <span class="p">};</span>

    <span class="c1">// デバイスコンテキストを取得する</span>
    <span class="n">HDC</span> <span class="n">hDC</span><span class="o">=</span> <span class="n">GetDC</span><span class="p">(</span> <span class="n">hwnd</span> <span class="p">);</span>

    <span class="c1">// フォーマットのマッチングを行う</span>
    <span class="kt">int</span> <span class="n">pfmt</span><span class="o">=</span> <span class="n">ChoosePixelFormat</span><span class="p">(</span> <span class="n">hDC</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pformat</span> <span class="p">);</span>

    <span class="c1">// ピクセルフォーマットを設定</span>
    <span class="n">SetPixelFormat</span><span class="p">(</span> <span class="n">hDC</span><span class="p">,</span> <span class="n">pfmt</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pformat</span> <span class="p">);</span>

    <span class="c1">// wglCreateContextAttribsARBを取得するために、仮のコンテキストを取得</span>
    <span class="n">HGLRC</span> <span class="n">hGLRC_old</span> <span class="o">=</span> <span class="n">wglCreateContext</span><span class="p">(</span> <span class="n">hDC</span> <span class="p">);</span>

    <span class="c1">// 仮のコンテキストを有効にする</span>
    <span class="n">wglMakeCurrent</span><span class="p">(</span> <span class="n">hDC</span><span class="p">,</span> <span class="n">hGLRC_old</span> <span class="p">);</span>

    <span class="c1">// wglCreateContextAttribsARB 関数の取得</span>
    <span class="n">PFNWGLCREATECONTEXTATTRIBSARBPROC</span> <span class="n">wglCreateContextAttribsARB</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNWGLCREATECONTEXTATTRIBSARBPROC</span><span class="p">)</span><span class="n">wglGetProcAddress</span><span class="p">(</span> <span class="s">"wglCreateContextAttribsARB"</span> <span class="p">);</span>

    <span class="c1">// 取得したいOpenGL環境（今回はES 3.0）の指定</span>
    <span class="k">static</span> <span class="k">const</span> <span class="kt">int</span>  <span class="n">opengl_es30</span><span class="p">[]</span><span class="o">=</span> <span class="p">{</span>
      <span class="n">WGL_CONTEXT_MAJOR_VERSION_ARB</span><span class="p">,</span>   <span class="mi">3</span><span class="p">,</span>
      <span class="n">WGL_CONTEXT_MINOR_VERSION_ARB</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>
      <span class="n">WGL_CONTEXT_FLAGS_ARB</span><span class="p">,</span>           <span class="mi">0</span><span class="p">,</span>
      <span class="n">WGL_CONTEXT_PROFILE_MASK_ARB</span><span class="p">,</span>    <span class="n">WGL_CONTEXT_ES2_PROFILE_BIT_EXT</span><span class="p">,</span>
      <span class="mi">0</span><span class="p">,</span>
    <span class="p">};</span>
    <span class="c1">// ES3.0のコンテキストを取得</span>
    <span class="n">HGLRC</span> <span class="n">hGLRC</span><span class="o">=</span> <span class="n">wglCreateContextAttribsARB</span><span class="p">(</span> <span class="n">hDC</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">opengl_es30</span> <span class="p">);</span>

    <span class="c1">// コンテキストを有効にする</span>
    <span class="n">wglMakeCurrent</span><span class="p">(</span> <span class="n">hDC</span><span class="p">,</span> <span class="n">hGLRC</span> <span class="p">);</span>

    <span class="c1">// 仮のコンテキストを削除</span>
    <span class="n">wglDeleteContext</span><span class="p">(</span> <span class="n">hGLRC_old</span> <span class="p">);</span>

    <span class="c1">// ベンダー情報の取得</span>
    <span class="k">const</span> <span class="n">GLubyte</span> <span class="o">*</span><span class="n">strVendor</span> <span class="o">=</span> <span class="n">glGetString</span><span class="p">(</span><span class="n">GL_VENDOR</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"GL_VENDOR : "</span> <span class="o">&lt;&lt;</span> <span class="n">strVendor</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="c1">// レンダラー情報の取得</span>
    <span class="k">const</span> <span class="n">GLubyte</span> <span class="o">*</span><span class="n">strRenderer</span> <span class="o">=</span> <span class="n">glGetString</span><span class="p">(</span><span class="n">GL_RENDERER</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"GL_RENDERER : "</span> <span class="o">&lt;&lt;</span> <span class="n">strRenderer</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="c1">// バージョン情報の取得</span>
    <span class="k">const</span> <span class="n">GLubyte</span> <span class="o">*</span><span class="n">strVersion</span> <span class="o">=</span> <span class="n">glGetString</span><span class="p">(</span><span class="n">GL_VERSION</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"GL_VERSION : "</span> <span class="o">&lt;&lt;</span> <span class="n">strVersion</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="c1">// OpenGL GLSL バージョンの取得</span>
    <span class="k">const</span> <span class="n">GLubyte</span> <span class="o">*</span> <span class="n">strShaderLanguageVersion</span> <span class="o">=</span> <span class="n">glGetString</span> <span class="p">(</span><span class="n">GL_SHADING_LANGUAGE_VERSION</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"GL_SHADING_LANGUAGE_VERSION : "</span> <span class="o">&lt;&lt;</span> <span class="n">strShaderLanguageVersion</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="c1">// OpenGL拡張の取得</span>
    <span class="k">const</span> <span class="n">GLubyte</span> <span class="o">*</span> <span class="n">strExtensions</span> <span class="o">=</span> <span class="n">glGetString</span> <span class="p">(</span><span class="n">GL_EXTENSIONS</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"GL_EXTENSIONS : "</span> <span class="o">&lt;&lt;</span> <span class="n">strExtensions</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>


    <span class="o">*</span><span class="n">p_hdc</span><span class="o">=</span> <span class="n">hDC</span><span class="p">;</span>
    <span class="o">*</span><span class="n">p_hglrc</span><span class="o">=</span> <span class="n">hGLRC</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="描画コードについて" class="fragment"></span><a href="#%E6%8F%8F%E7%94%BB%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a>描画コードについて</h2>

<p>ただし、上記サイト様のサンプルコードの描画処理や透視変換関数は、OpenGL ES 3.0とは互換性がないため、描画コードもろもろ（シェーダーや頂点オブジェクトの作成処理なども含む）については床井研究室様の以下のページで説明されているサンプルコードを利用してください。<br>
<a href="http://marina.sys.wakayama-u.ac.jp/%7Etokoi/?date=20120909" rel="nofollow noopener" target="_blank">http://marina.sys.wakayama-u.ac.jp/~tokoi/?date=20120909</a></p>

<p><a href="https://github.com/tokoik/glfwsample/blob/65cc6ebe03fbef9ea4043c6fe8a88c233766f710/main.cpp" rel="nofollow noopener" target="_blank">サンプルコード（main.cpp）への直リンク</a></p>

<p>ただし、このコードでも注意点が。Windowsでは、標準で使えるOpenGLの関数はバージョン1.1までのものしかなく、それ以外の最近の関数はwglGetProcAddress関数で取得する必要があります。<br>
以下のように行ってください。</p>

<div class="code-frame" data-lang="cpp"><div class="highlight"><pre><span></span>  <span class="n">PFNGLGENVERTEXARRAYSPROC</span> <span class="n">glGenVertexArrays</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLGENVERTEXARRAYSPROC</span><span class="p">)</span><span class="n">wglGetProcAddress</span><span class="p">(</span> <span class="s">"glGenVertexArrays"</span> <span class="p">);</span>
  <span class="n">PFNGLBINDVERTEXARRAYPROC</span> <span class="n">glBindVertexArray</span> <span class="o">=</span> <span class="p">(</span><span class="n">PFNGLBINDVERTEXARRAYPROC</span><span class="p">)</span><span class="n">wglGetProcAddress</span><span class="p">(</span> <span class="s">"glBindVertexArray"</span> <span class="p">);</span>
</pre></div></div>

<p>また、シェーダープログラムについては、OpenGL ES 3.0に対応させるため、以下のコードで置き換えてください。</p>

<div class="code-frame" data-lang="c"><div class="highlight"><pre><span></span><span class="c1">// バーテックスシェーダのソースプログラム</span>
    <span class="k">static</span> <span class="k">const</span> <span class="n">GLchar</span> <span class="n">vsrc</span><span class="p">[]</span> <span class="o">=</span>
    <span class="s">"#version 300 es</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"in lowp vec4 pv;</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"void main(void)</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"{</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"  gl_Position = pv;</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"}</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>

  <span class="c1">// フラグメントシェーダのソースプログラム</span>
  <span class="k">static</span> <span class="k">const</span> <span class="n">GLchar</span> <span class="n">fsrc</span><span class="p">[]</span> <span class="o">=</span>
    <span class="s">"#version 300 es</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"out lowp vec4 fc;</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"void main(void)</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"{</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"  fc = vec4(1.0, 0.0, 0.0, 0.0);</span><span class="se">\n</span><span class="s">"</span>
    <span class="s">"}</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
</pre></div></div>

<p>以上で、動作するはずです。以下のような描画が行えれば成功です。<br>
<a href="https://camo.qiitausercontent.com/bdc114f71ad6e58fe7f0d652211ef2164c5c1f9a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f31633366653466662d653166652d663330372d343336372d3730643134316338646539302e6a706567" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/bdc114f71ad6e58fe7f0d652211ef2164c5c1f9a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f31323735332f31633366653466662d653166652d663330372d343336372d3730643134316338646539302e6a706567" alt="無題.jpg" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/12753/1c3fe4ff-e1fe-f307-4367-70d141c8de90.jpeg"></a></p>

<h2>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h2>

<p>一部のコードしか示さず、あとはあっちを参考にしてごにょごにょしろとか、おまいなめとんのか的な説明になってしまい大変申し訳ないです（汗）<br>
私の手元で動いているコードを全部晒せれば手っ取り早いのですが、いろいろ汚いこともありまして、後日の課題とさせてくださいorz</p>

<p>ともかく、OpenGL4.3はOpenGL ES 3.0と互換性が確保されていますので、OpenGL4.3に対応するGPUならOpenGL ES 3.0のプログラム開発を行うことができます。<br>
もちろん、本当にモバイルデバイスで動くかは、実機で検証した方がいいと思いますが、とっかかりの開発環境として使えると思います。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />12位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>8</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/515872ba32532c8e761f">SCSS文字列をRubyプログラム中でCSSにコンパイルする</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-05-27 19:22:22</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> <b>[scss]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>みなさんご存知の通り、<code>sass</code>というGemをインストールすることで、</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ gem install sass
</pre></div></div>

<p>以下のようにして、SCSSファイルをCSSにコンパイルできます。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ sass input.scss output.css
</pre></div></div>

<p>しかし、コマンドラインでなく、Rubyプログラム中でSCSS文字列をCSS文字列にコンパイルするにはどうすればいいのでしょうか。<br>
結論としては、以下のようにすればOKです。<br>
（Ruby初心者なんでコードだせぇww　とか言わないでw）</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env ruby</span>

<span class="nb">require</span> <span class="s1">'sass'</span>

<span class="n">stdinStr</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
<span class="k">while</span> <span class="n">line</span> <span class="o">=</span> <span class="no">STDIN</span><span class="o">.</span><span class="n">gets</span>
    <span class="k">if</span> <span class="p">(</span><span class="sr">/exit/</span> <span class="o">=~</span> <span class="n">line</span><span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="k">end</span>
    <span class="n">stdinStr</span> <span class="o">+=</span> <span class="n">line</span>
<span class="k">end</span>

<span class="n">engine</span> <span class="o">=</span> <span class="no">Sass</span><span class="o">::</span><span class="no">Engine</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">stdinStr</span><span class="p">,</span> <span class="ss">:syntax</span> <span class="o">=&gt;</span> <span class="ss">:scss</span><span class="p">)</span>

<span class="k">begin</span>
    <span class="nb">print</span> <span class="n">engine</span><span class="o">.</span><span class="n">render</span>
<span class="k">rescue</span> <span class="o">=&gt;</span> <span class="n">ex</span>
    <span class="nb">print</span> <span class="s2">"Line "</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="n">sass_line</span><span class="o">.</span><span class="n">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="n">to_s</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
<span class="k">end</span>
</pre></div></div>

<p>なんらかの事情で、コマンドラインを介さずに動的にSCSSをコンパイルしなければならない場合（Webデザイン系のWebサービスを作るときとか？）に使えるのではないでしょうか。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />13位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>4</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/b40b2083e863196c3264">Function.prototype.bindの、複数の引数を配列で渡せるバージョン</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-10-12 14:05:10</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[JavaScript]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>Function.prototype.bindの、複数の引数を配列で渡せるバージョンを作ってみました。<br>
Function.prototype.bindApplyという拡張メソッドがそれです。<br>
また、この拡張メソッドを使わずに自前でやる方法（getBoundFuncByMySelf）も書きました。<br>
（注意：ECMAScript 5 に準拠したWebブラウザが必要です）</p>

<p>地味に便利だと思います ^o^</p>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><span></span><span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span>
<span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span>
<span class="s1">'bindApply'</span><span class="p">,</span> 
<span class="p">{</span>
<span class="nx">value</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">thisObject</span><span class="p">,</span> <span class="nx">argumentsArray</span> <span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bind</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">thisObject</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">argumentsArray</span><span class="p">));</span>
<span class="p">},</span>
<span class="nx">writable</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">enumerable</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
<span class="nx">configurable</span> <span class="o">:</span> <span class="kc">false</span>
<span class="p">}</span>
<span class="p">);</span>

<span class="kd">function</span> <span class="nx">getBoundFuncByBindApply</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="nx">argv</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="nx">func</span><span class="p">.</span><span class="nx">bindApply</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">argv</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">getBoundFuncByMySelf</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">func</span><span class="p">,</span> <span class="nx">argv</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bind</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">func</span><span class="p">,</span> <span class="p">[</span><span class="nx">obj</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">argv</span><span class="p">));</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">showThis</span><span class="p">(</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">){</span>
<span class="nx">alert</span><span class="p">(</span><span class="k">this</span> <span class="o">+</span> <span class="nx">arg1</span> <span class="o">+</span> <span class="nx">arg2</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">getBoundFuncByBindApply</span><span class="p">(</span><span class="s2">"Thisです:"</span><span class="p">,</span> <span class="nx">showThis</span><span class="p">,</span> <span class="p">[</span><span class="s2">" Foo "</span><span class="p">,</span><span class="s2">" Boo "</span><span class="p">]);</span> <span class="c1">// どちらでもOK</span>
<span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="nx">getBoundFuncByMySelf</span><span class="p">(</span><span class="s2">"Thisです:"</span><span class="p">,</span> <span class="nx">showThis</span><span class="p">,</span> <span class="p">[</span><span class="s2">" Foo "</span><span class="p">,</span><span class="s2">" Boo "</span><span class="p">]);</span> <span class="c1">// どちらでもOK</span>

<span class="nx">foo</span><span class="p">();</span>
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />14位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>3</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/dd3386bf458d5720be76">WebGLで正しいテクスチャサイズにも関わらず「It maybe non-power-of-2 ~」というエラーが出たら……</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-05-20 00:15:50</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Chrome]</b> <b>[WebGL]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="問題" class="fragment"></span><a href="#%E5%95%8F%E9%A1%8C"><i class="fa fa-link"></i></a>問題</h2>

<p>Google ChromeにおけるWebGLで、正しいテクスチャサイズ（2の累乗）にも関わらず、</p>

<blockquote>
<p>RENDER WARNING: texture bound to texture unit 0 is not renderable. It maybe non-power-of-2 and have incompatible texture filtering or is not 'texture complete'</p>
</blockquote>

<p>というエラーが出力された場合</p>

<h2>
<span id="結論" class="fragment"></span><a href="#%E7%B5%90%E8%AB%96"><i class="fa fa-link"></i></a>結論</h2>

<p>「テクスチャ画像の読み込みが完了していない状態でレンダリングを行った」ことにより、同エラーが出ている可能性を疑うこと。</p>

<h2>
<span id="以下駄文" class="fragment"></span><a href="#%E4%BB%A5%E4%B8%8B%E9%A7%84%E6%96%87"><i class="fa fa-link"></i></a>以下、駄文</h2>

<p>WebGLであるゲームの開発をやっているんですが、テクスチャ関連で以下のエラーが出てくるんですよ（ちなみにブラウザはChrome）。</p>

<blockquote>
<p>RENDER WARNING: texture bound to texture unit 0 is not renderable. It maybe non-power-of-2 and have incompatible texture filtering or is not 'texture complete'</p>
</blockquote>

<p>もうね。何かと思って。テクスチャサイズは256x64だし、フィルタリングの指定も間違ってないし。色々ググったり試行錯誤して辿り着いたオチが……。</p>

<p><strong>「テクスチャ画像の読み込みが完了していない状態でレンダリングを行ったから」</strong></p>

<p>あー、たしかに <code>or is not 'texture complete'</code> って書いてあるけどさ……。<br>
ふつー、non-power-of-2の方に注目しちゃうだろ。<br>
おいら、まさかなーあるわけないよなーとか考えながらも画像サイズを256x256に変えてみたりとかアホみたいなことしちゃったじゃまいか。</p>

<p>何が ~ or ~ だ。どっちの原因なのかそこまでちゃんとチェックして、適切にエラーを出せ、と。</p>

<p>WebGLの画像ファイル読み込みは非同期なので、ちょっと横着して、テクスチャの読み込みが完了する前に描画命令しちゃうのはよくある事だと思うのですよ。</p>

<p>そういうケースも考えて、シンプルに「まだロード完了してないよん」とか言ってくれればいいのに、「non-power-of-2」とかいうからもう誤解しちゃったじゃんよ。</p>

<p>こういう「原因は〜〜〜かもしれないし〜〜〜かもしれません」的なエラーって設計した人はどういうつもりで作ったんだろう。<br>
仕様的に判断が難しいというのは考えづらい気がするんだよなー。</p>

<p>ちなみに、これはChromeでの話です。他のブラウザの場合どういったエラーが出るかは確かめていません。（どなたか試された方いらっしゃいましたらコメントいただけますと幸いです）</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>emadurandalさんの<br />15位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>2</kbd>
		<a target="_blank" href="https://qiita.com/emadurandal/items/6c4308014de469e107bf">NVIDIA SDK 9.52のサンプルを今更ビルド・実行する方法</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-11-21 15:32:54</center>
	</td>
	<td style="width:200px;">
		@emadurandal<br />(フリーランス 所属)<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/12753/profile-images/1473682524">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[OpenGL]</b> <b>[VisualStudio]</b> <b>[NVIDIA]</b> <b>[DirectX]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h1>
<span id="以下のお話はopengldirectxを使いこなす猛者または初学者のためのtipsです" class="fragment"></span><a href="#%E4%BB%A5%E4%B8%8B%E3%81%AE%E3%81%8A%E8%A9%B1%E3%81%AFopengldirectx%E3%82%92%E4%BD%BF%E3%81%84%E3%81%93%E3%81%AA%E3%81%99%E7%8C%9B%E8%80%85%E3%81%BE%E3%81%9F%E3%81%AF%E5%88%9D%E5%AD%A6%E8%80%85%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AEtips%E3%81%A7%E3%81%99"><i class="fa fa-link"></i></a>以下のお話は、OpenGL/DirectXを使いこなす猛者または初学者のためのTipsです。</h1>

<p>NVIDIAが開発者向けに公開している技術サンプル集で、『NVIDIA SDK 9.52』という古いものがあります。<br>
これ、すでに技術的にはかなり時代遅れになっているものもあるんですが、中には今でも参考になるサンプルもあったりします。</p>

<p>で、試したいのですが、最新のVisual Studioだとどうもビルドがうまく通らなかったり、色々大変です。</p>

<p>そこで、NVIDIA SDK 9.52のサンプルが使用しているバージョンである、Visual Studio 2003を使って解決する方法が本記事です。</p>

<h1>
<span id="目的nvidia-sdk-952のサンプルをビルド実行したい" class="fragment"></span><a href="#%E7%9B%AE%E7%9A%84nvidia-sdk-952%E3%81%AE%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%92%E3%83%93%E3%83%AB%E3%83%89%E5%AE%9F%E8%A1%8C%E3%81%97%E3%81%9F%E3%81%84"><i class="fa fa-link"></i></a>目的：NVIDIA SDK 9.52のサンプルをビルド・実行したい。</h1>

<h1>
<span id="問題最新のvisual-studioだとビルドがうまく通らない" class="fragment"></span><a href="#%E5%95%8F%E9%A1%8C%E6%9C%80%E6%96%B0%E3%81%AEvisual-studio%E3%81%A0%E3%81%A8%E3%83%93%E3%83%AB%E3%83%89%E3%81%8C%E3%81%86%E3%81%BE%E3%81%8F%E9%80%9A%E3%82%89%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>問題：最新のVisual Studioだとビルドがうまく通らない。</h1>

<h1>
<span id="解決windows-xpvistaまたは7にvisual-studio-2003を無理やりインストールする" class="fragment"></span><a href="#%E8%A7%A3%E6%B1%BAwindows-xpvista%E3%81%BE%E3%81%9F%E3%81%AF7%E3%81%ABvisual-studio-2003%E3%82%92%E7%84%A1%E7%90%86%E3%82%84%E3%82%8A%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>解決：Windows XP、Vistaまたは7に、Visual Studio 2003を無理やりインストールする。</h1>

<p>（注意：XPはともかく、Vistaおよび７では、Visual Studio 2003のインストール・実行を本来サポートしていません。あくまで、自己責任でお願いします。何か問題が起きても、当方は責任を負えません）</p>

<h1>
<span id="visual-studio-2003を入手する" class="fragment"></span><a href="#visual-studio-2003%E3%82%92%E5%85%A5%E6%89%8B%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Visual Studio 2003を入手する</h1>

<p>以下のいずれかの方法で入手してください。<br>
・どこかに偶然売れ残っているパッケージを探し、購入する。<br>
・MSDNサブスクリプションに契約し、期間内に旧バージョンの製品を入手する。<br>
　<a href="http://www.microsoft.com/japan/msdn/subscriptions/" class="autolink" rel="nofollow noopener" target="_blank">http://www.microsoft.com/japan/msdn/subscriptions/</a><br>
　今でも入手可能なのかは、すみませんが確認がとれていません。Microsoftに問い合わせるしかないですね。</p>

<p>このステップがうまくいかないと、この記事の意味がないですね。ええ（汗）<br>
その場合はもうあきらめて、最新のVisual Studioでソースをごにょごにょしてなんとかビルド通してください。</p>

<h1>
<span id="visual-studio-2003をインストールする" class="fragment"></span><a href="#visual-studio-2003%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Visual Studio 2003をインストールする。</h1>

<p>Windowsに、Visual Studio 2003をどうにかしてインストールします。</p>

<p>Windows 7の場合は、こちらのサイト様の情報を参考にしてください。<br>
<a href="http://n225fut.blog79.fc2.com/blog-entry-855.html" rel="nofollow noopener" target="_blank">http://n225fut.blog79.fc2.com/blog-entry-855.html</a></p>

<h1>
<span id="nvidia-sdk-952を入手する" class="fragment"></span><a href="#nvidia-sdk-952%E3%82%92%E5%85%A5%E6%89%8B%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>NVIDIA SDK 9.52を入手する</h1>

<p>以下のページからダウンロードした場合、インストーラーが32bit環境以外のWindowsを拒否してしまい、64bit環境のWindowsではインストールができません。<br>
<a href="https://developer.nvidia.com/nvidia-graphics-sdk-11" rel="nofollow noopener" target="_blank">https://developer.nvidia.com/nvidia-graphics-sdk-11</a></p>

<p>そこで、以下のページから、サンプルのzipファイルを個別にダウンロードします。面倒ですが、根気よくやってください。<br>
<a href="http://developer.download.nvidia.com/SDK/9.5/Samples/samples.html" class="autolink" rel="nofollow noopener" target="_blank">http://developer.download.nvidia.com/SDK/9.5/Samples/samples.html</a></p>

<h1>
<span id="sdkの各サンプルをビルドする" class="fragment"></span><a href="#sdk%E3%81%AE%E5%90%84%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%82%92%E3%83%93%E3%83%AB%E3%83%89%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>SDKの各サンプルをビルドする。</h1>

<p>OpenGLのサンプルは問題なくビルド・実行できるかと思います。</p>

<p>問題は、DirectXのサンプルです。<br>
NVIDIA SDK 9.52は、February 2006というバージョンを前提にしており、これ以外のバージョンのSDKでビルドすると実行に問題が発生する場合があります。<br>
（実行時に「incorrect version of direct3d and/or d3dx」のようなエラーが出ます）</p>

<p>残念ながら、2013年11月時点で、Microsoft社から入手できるDirectXのバージョンはApril 2006からで、惜しい事に一つ違いでFebruary 2006はサイトから撤去されています。<br>
（古くなったからって、べつに公開停止しなくたっていいじゃんねぇ？）</p>

<p>参考：各バージョンのダウンロードURL<br>
<a href="http://dench.flatlib.jp/dxsdkver" rel="nofollow noopener" target="_blank">http://dench.flatlib.jp/dxsdkver</a>（HYPERでんち様）<br>
<a href="http://www.headcrash.us/blog/2010/07/directx-sdk-version-numbers-and-download-list/" rel="nofollow noopener" target="_blank">http://www.headcrash.us/blog/2010/07/directx-sdk-version-numbers-and-download-list/</a>（head crash industries様）</p>

<p>しょうがないので、持っていない人は知人からコピーしてもらうか、検索しまくって二次配布している怪しいサイトを見つけてください。<br>
（私は見つけることに成功して、ダウンロードできましたが、二次配布幇助になってしまうので、URLは記しません。申し訳ない^^;）</p>

<p>で、February 2006でビルドします。<br>
しかし、DXUTを使っているサンプルの場合、また「incorrect version of direct3d and/or d3dx」エラーが出ます。<br>
原因は、DXUTの互換性です<br>
サンプルで使っているDXUTを使わずに、February 2006にあるDXUTを使うようにしてビルドすると、上手く動作します。</p>

<p>February 2006ベースとあるのに、使っているDXUTのバージョンが違うってどういうこと？<br>
という疑問はあるのですが、とりあえず動作するようになったのでよしとしましょう。</p>
</div>
	</td>
</tr>
</table>
<br />
	</body>
</html>
