<html>
	<head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110075493-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-110075493-1');
</script>
<!-- Google AdSense -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6168511236629369",
    enable_page_level_ads: true
  });
</script>

		<meta charset="UTF-8" />
		<title>Qiita Ranking (Morix1500)</title>
		<link rel="stylesheet" type="text/css" href="../qranking.css">
	</head>
	<body>
<div class="headerContainer">
<h1>Qiitaいいね数ランキング (Morix1500 さんの投稿分)</h1>
</div><!--class="headerContainer"-->
<p><a href="#" onclick="javascript:window.history.back(-1);return false;">[戻る]</a></p>
<p><i><img width="16" height="16" src="../thumb-up-120px.png" /></i>が同じ値の場合は投稿日時の新しいものが上位としています。</p>
<p><i><img width="16" height="16" src="../thumb-up-120px.png" /></i>がついていない記事は表示していません。</p>
<table border="1">
<tr>
	<td rowspan="3"><center>Morix1500さんの<br />1位</center></td>
	<td colspan="4">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>601</kbd>
		<a target="_blank" href="https://qiita.com/Morix1500/items/0eac072a027d478a6b83">阿部寛のサイトを高速化する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2017-11-18 00:11:02</center>
	</td>
	<td style="width:200px;">
		@Morix1500<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/152303/profile-images/1498094263">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[AWS]</b> <b>[S3]</b> <b>[CloudFront]</b> <b>[WebP]</b> <b>[阿部寛]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>ちまたで<a href="http://abehiroshi.la.coocan.jp/" rel="nofollow noopener" target="_blank">阿部寛のサイト</a>が早いと話題になってます。</p>

<p><a href="http://kuxumarin.hatenablog.com/entry/2017/11/15/dev.to%E3%81%A8%E9%98%BF%E9%83%A8%E5%AF%9B%E3%81%AE%E3%83%9B%E3%83%BC%E3%83%A0%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%A9%E3%81%A3%E3%81%A1%E3%81%8C%E9%80%9F%E3%81%84%E3%81%A7%E3%81%99%E3%81%8B%EF%BC%9F" rel="nofollow noopener" target="_blank">dev.toと阿部寛のホームページどっちが速いですか？</a><br>
<a href="https://qiita.com/naru0504/items/7d652681d698f6d88c4f" id="reference-e85331a7bde2a51a05e8">dev.toと阿部寛のホームページについてちゃんと計測させてくれ</a></p>

<p>阿部寛のサイトはベストを尽くしてるのか？<br>
それを調べるために、阿部寛のサイトを高速化させてみたいと思います。</p>

<h2>
<span id="目指すべきスピード" class="fragment"></span><a href="#%E7%9B%AE%E6%8C%87%E3%81%99%E3%81%B9%E3%81%8D%E3%82%B9%E3%83%94%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>目指すべきスピード</h2>

<p>最速はローカルのファイルへのアクセスだと思うのでこれを目指したいと思います。<br>
file:///C:/abe_hiroshi/index.html</p>

<p><a href="https://camo.qiitausercontent.com/d621b4b5abb24b6c6ec9ebcaa389b797dd6bd521/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f63656364313538632d663833662d303066322d633732652d3937303137663331653532392e676966" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/d621b4b5abb24b6c6ec9ebcaa389b797dd6bd521/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f63656364313538632d663833662d303066322d633732652d3937303137663331653532392e676966" alt="9baae75ad17a694cadc9a83081cd4df4.gif" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/cecd158c-f83f-00f2-c72e-97017f31e529.gif"></a></p>

<p>ChromeのDeveloper Toolでレンダリング完了が「173ms」でした。<br>
まぁここまでは無理だな…</p>

<h2>
<span id="阿部寛のサイトはどんなもん" class="fragment"></span><a href="#%E9%98%BF%E9%83%A8%E5%AF%9B%E3%81%AE%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AF%E3%81%A9%E3%82%93%E3%81%AA%E3%82%82%E3%82%93"><i class="fa fa-link"></i></a>阿部寛のサイトはどんなもん？</h2>

<p>速度は<a href="http://webpagetest.org" rel="nofollow noopener" target="_blank">webpagetest.org</a>で測ってみます。</p>

<p><a href="https://camo.qiitausercontent.com/0c67e0cf0ca7cb13054833fc67311917c19f8633/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f66343535623032632d363635332d663762302d313235652d3435326238353033623937342e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/0c67e0cf0ca7cb13054833fc67311917c19f8633/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f66343535623032632d363635332d663762302d313235652d3435326238353033623937342e706e67" alt="nama.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/f455b02c-6653-f7b0-125e-452b8503b974.png"></a><br>
レンダリング完了時間は「359ms」です。はえーな</p>

<h2>
<span id="s3でホスティングしてみる" class="fragment"></span><a href="#s3%E3%81%A7%E3%83%9B%E3%82%B9%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B"><i class="fa fa-link"></i></a>S3でホスティングしてみる</h2>

<p>サーバーを立てるほどでもないので、S3でWebホスティングしてそこにhtmlと画像を置いてみます。</p>

<p><a href="https://camo.qiitausercontent.com/148e640cdfa4eb35b21bbbde704120d2e4fad16c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f34353432643934622d636162382d346632302d346636352d3935316136653062643562392e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/148e640cdfa4eb35b21bbbde704120d2e4fad16c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f34353432643934622d636162382d346632302d346636352d3935316136653062643562392e706e67" alt="s3_1.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/4542d94b-cab8-4f20-4f65-951a6e0bd5b9.png"></a><br>
<a href="https://camo.qiitausercontent.com/45f87a61e87608907748efbd311cc41cac70b677/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f64353333653865642d376331362d356635622d323662342d3036356531303266373962342e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/45f87a61e87608907748efbd311cc41cac70b677/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f64353333653865642d376331362d356635622d323662342d3036356531303266373962342e706e67" alt="s3_2.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/d533e8ed-7c16-5f5b-26b4-065e102f79b4.png"></a></p>

<p>レンダリング完了時間が「698ms」なんで、まだまだ遅いです。</p>

<h2>
<span id="cdncloudfrontでキャッシュする" class="fragment"></span><a href="#cdncloudfront%E3%81%A7%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%A5%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>CDN(CloudFront)でキャッシュする</h2>

<p>続いてS3のオブジェクトをCloudFrontでキャッシュしてみる。</p>

<p><a href="https://camo.qiitausercontent.com/03e4b86be086ed92466e9af86f3350204d3508e7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f35393737343235662d316139372d333361342d373034662d6233306463616266303864612e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/03e4b86be086ed92466e9af86f3350204d3508e7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f35393737343235662d316139372d333361342d373034662d6233306463616266303864612e706e67" alt="cf_1.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/5977425f-1a97-33a4-704f-b30dcabf08da.png"></a><br>
<a href="https://camo.qiitausercontent.com/fc01f93ff9b074cd54e9e673394049fb13300ab7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f64376235323436332d353137642d366362312d316133662d3138346366663937396261642e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/fc01f93ff9b074cd54e9e673394049fb13300ab7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f64376235323436332d353137642d366362312d316133662d3138346366663937396261642e706e67" alt="cf_2.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/d7b52463-517d-6cb1-1a3f-184cff979bad.png"></a></p>

<p>レンダリング完了時間が「379ms」になりました。<br>
やはりCDNは効果絶大です。</p>

<h2>
<span id="webpを使ってみる" class="fragment"></span><a href="#webp%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B"><i class="fa fa-link"></i></a>Webpを使ってみる</h2>

<p><a href="https://dev.to" rel="nofollow noopener" target="_blank">dev.to</a>では<a href="https://cloudinary.com/" rel="nofollow noopener" target="_blank">Cloudinary</a>という画像ホスティングサイトを使用しており<br>
画像をアップロードすると様々なフォーマットで利用できるようになります。</p>

<p>dev.toでも使用している「Webp」というJPG/PNGよりも圧縮に優れたフォーマットで<br>
大幅なサイズ削減を実現してくれます。<br>
サイズ削減できれば高速化できるはず。早速試してみます。</p>

<p>画像の変換作業は、Cloudinaryでこんな感じの画面で行えます。<br>
<a href="https://camo.qiitausercontent.com/66bb6efa851c03d8f9fd9f74beb41ce2e084d46a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f64643438333636392d616539622d666339372d666465392d6239363261336333626636622e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/66bb6efa851c03d8f9fd9f74beb41ce2e084d46a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f64643438333636392d616539622d666339372d666465392d6239363261336333626636622e706e67" alt="webp.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/dd483669-ae9b-fc97-fde9-b962a3c3bf6b.png"></a></p>

<p>普通の画像サイズ<br>
<a href="http://abehiroshi.s3-website-ap-northeast-1.amazonaws.com/image/abe-top2-4.jpg" class="autolink" rel="nofollow noopener" target="_blank">http://abehiroshi.s3-website-ap-northeast-1.amazonaws.com/image/abe-top2-4.jpg</a><br>
64KB</p>

<p>cloudinaryでwebpに変更してみると<br>
<a href="https://res.cloudinary.com/morix1500/image/upload/v1510926252/abe-top2-4_n99mu2.webp" class="autolink" rel="nofollow noopener" target="_blank">https://res.cloudinary.com/morix1500/image/upload/v1510926252/abe-top2-4_n99mu2.webp</a><br>
18.9KB</p>

<p>cloudinaryのURLをhtmlに埋め込んで計測してみます。<br>
<a href="https://camo.qiitausercontent.com/f2de4a5c0c5fa7babd5065f62735aa64e83e8afe/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f37336432626639622d323362312d343831382d316632332d3035613934393265323235652e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/f2de4a5c0c5fa7babd5065f62735aa64e83e8afe/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f37336432626639622d323362312d343831382d316632332d3035613934393265323235652e706e67" alt="webp_1.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/73d2bf9b-23b1-4818-1f23-05a9492e225e.png"></a><br>
<a href="https://camo.qiitausercontent.com/ec3567d9d5ed4273ffb2ecf8826d8de33fa043b3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f35306563393062662d666133312d383431652d616433332d6166356366633831393566652e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/ec3567d9d5ed4273ffb2ecf8826d8de33fa043b3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f35306563393062662d666133312d383431652d616433332d6166356366633831393566652e706e67" alt="webp_2.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/50ec90bf-fa31-841e-ad33-af5cfc8195fe.png"></a></p>

<p>はい、全部Aになりました。<br>
しかし、レンダリング完了時間が「1.337s」と遅くなった…なぜでしょう？</p>

<p>このページではHTTP2が有効になってます。<br>
同一ドメインでないと余計なコネクションが発生してしまうのではないかと推測し、<br>
同一ドメインに画像を置いてみることにします。（間違えてたらご指摘おねがいします）</p>

<p>ということでCloudinaryから直接画像を読み込むのではなく、WebpをダウンロードしてS3に配置してみます。<br>
<a href="https://camo.qiitausercontent.com/4230215692416b7737d55ffb6905efaef9fd085e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f35633138383039662d316535302d366335612d636131302d3461356364383930636233342e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/4230215692416b7737d55ffb6905efaef9fd085e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3135323330332f35633138383039662d316535302d366335612d636131302d3461356364383930636233342e706e67" alt="webp_3.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/152303/5c18809f-1e50-6c5a-ca10-4a5cd890cb34.png"></a></p>

<p>お、「328ms」になりました。<br>
また読み込みバイト数も「70KB」から「18KB」になりました。<br>
これはいい感じですね。</p>

<p>これで阿部寛サイトを超えることができました！</p>

<h2>
<span id="結論" class="fragment"></span><a href="#%E7%B5%90%E8%AB%96"><i class="fa fa-link"></i></a>結論</h2>

<p>以下の技術を使用すれば既存の阿部寛サイトを凌駕することが出来ました。</p>

<ul>
<li>S3でホスティング</li>
<li>CDN（CloudFront)でキャッシュ</li>
<li>HTTP2</li>
<li>Webp</li>
</ul>

<p>ここまでしないと超えられない既存サイト…恐ろしい。<br>
Service Workerも使ってみたかったですが、それは今度の機会に。</p>

<p>では！</p>
</div>
	</td>
</tr>
</table>
<br />
	</body>
</html>
