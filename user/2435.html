<html>
	<head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110075493-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-110075493-1');
</script>
<!-- Google AdSense -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6168511236629369",
    enable_page_level_ads: true
  });
</script>

		<meta charset="UTF-8" />
		<title>Qiita Ranking (makoto_kw)</title>
		<link rel="stylesheet" type="text/css" href="../qranking.css">
	</head>
	<body>
<div class="headerContainer">
<h1>Qiitaいいね数ランキング (makoto_kw さんの投稿分)</h1>
</div><!--class="headerContainer"-->
<p><a href="#" onclick="javascript:window.history.back(-1);return false;">[戻る]</a></p>
<p><i><img width="16" height="16" src="../thumb-up-120px.png" /></i>が同じ値の場合は投稿日時の新しいものが上位としています。</p>
<p><i><img width="16" height="16" src="../thumb-up-120px.png" /></i>がついていない記事は表示していません。</p>
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />1位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>650</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/b23350aed11ea87cd92b">趣味でつくるiOSアプリこそJenkinsでリリースを自動化</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-12-09 01:56:27</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> <b>[Jenkins]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><strong>TestFlightへのアップロード部分の内容はAppleに買収されiTunes Connectに統合される前のTestFlightについての情報です、testflightapp.comは2015/2/26に終了です</strong></p>

<p>コードを書き終わったがもう会社に行かなければならない、テストのために手持ちのデバイスにインストールしておきたい・・・。趣味でつくっているアプリこそ自動化して開発の時間を捻出すべきなのでは？そんなことを思っていたらMarvericksが無料でリリースされたので押入れで眠っていたMacBook AirにMarvericksとJenkinsを入れてリリース作業を自動化してみました。</p>

<h2>
<span id="前提として" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90%E3%81%A8%E3%81%97%E3%81%A6"><i class="fa fa-link"></i></a>前提として</h2>

<ul>
<li>Jenkinsのセットアップは割愛しています。かわりに別の記事をあげているので参考にしてください。

<ul>
<li><a href="http://qiita.com/makoto_kw/items/cbe93d4ebbc35f3b43fd" id="reference-907833cfd5c31463d668">OS XにJenkinsをHomebrewでセットアップする</a></li>
</ul>
</li>
<li>Xcode5, Jenkins 1.542, CocoaPodsを使ったプロジェクトを使います</li>
<li>Xcodeのプロジェクト名、ワークスペース名を <strong>MyProject</strong> としているので読み替えて使ってください</li>
<li>今回はビルドと配布に焦点をあてています、静的解析やテストに関する話はありません</li>
<li>TestFlightへの自動アップロード、AppStoreに提出するipaファイルの自動ビルドまでを行います</li>
</ul>

<h2>
<span id="ビルド環境のセットアップ" class="fragment"></span><a href="#%E3%83%93%E3%83%AB%E3%83%89%E7%92%B0%E5%A2%83%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>ビルド環境のセットアップ</h2>

<p>新しいマシンにセットアップする場合は以下を忘れないようにしておきます。</p>

<ul>
<li>Xcode</li>
<li>Xcode Command Line Tools</li>
<li>iPhone Developer Program証明書</li>
<li>CocoaPods (使っている場合)</li>
</ul>

<p>KeyChainへのアクセスなど初回に対話が必要な設定があるのでいきなりJenkinsでビルドするのではなく、一度プロジェクトを取得して、Xcodeでビルドができるか確認しておきましょう。</p>

<h2>
<span id="自動ビルドに必要なファイルのコミット" class="fragment"></span><a href="#%E8%87%AA%E5%8B%95%E3%83%93%E3%83%AB%E3%83%89%E3%81%AB%E5%BF%85%E8%A6%81%E3%81%AA%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88"><i class="fa fa-link"></i></a>自動ビルドに必要なファイルのコミット</h2>

<h3>
<span id="provisioning-profile" class="fragment"></span><a href="#provisioning-profile"><i class="fa fa-link"></i></a>Provisioning Profile</h3>

<p>Provisioning Profileを取得、更新しなくてよいようにリポジトリにコミットしておきます。Dropboxから参照するのもよいでしょう。ファイルは任意の場所にあってもビルド前に行うシェルスクリプトでプロジェクトディレクトリにコピーします。</p>

<h3>
<span id="スキーマ設定ファイル" class="fragment"></span><a href="#%E3%82%B9%E3%82%AD%E3%83%BC%E3%83%9E%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB"><i class="fa fa-link"></i></a>スキーマ設定ファイル</h3>

<p>xcodebuildでワークスペースファイルを使う際にスキーマファイルが必要になります。このファイルが <strong>Xcodeでワークスペースファイルを開いた際に生成される</strong> ものであるため、CocoaPodsで自動生成したワークスペースをxcodebuildでビルドしようとするとスキーマファイルが見つからずにビルドが失敗します。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>MyProject.xcodeproj/xcuserdata/&lt;UserName&gt;.xcuserdatad/xcschemes/MyProject.xcscheme
MyProject.xcodeproj/xcuserdata/&lt;UserName&gt;.xcuserdatad/xcschemes/xcschememanagement.plist
</pre></div></div>

<p>この問題を回避するために事前にスキーマファイルをJenkinsを実行するユーザのファイルとしてコミットしておきます。<br>
参考: <a href="http://qiita.com/mokemokechicken/items/5ea39c87512a515071f5" id="reference-b96de97c80e283fcccad">JenkinsでiOSのビルドを行う時にハマるポイントとその解決法・１</a></p>

<h2>
<span id="使うjenkinsプラグイン" class="fragment"></span><a href="#%E4%BD%BF%E3%81%86jenkins%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3"><i class="fa fa-link"></i></a>使うJenkinsプラグイン</h2>

<p>以下のものを使っています。</p>

<ul>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin" rel="nofollow noopener" target="_blank">Git Plugin</a></li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/Git+Client+Plugin" rel="nofollow noopener" target="_blank">Git Client Plugin</a></li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Xcode+Plugin" rel="nofollow noopener" target="_blank">Xcode Plugin</a></li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/Testflight+Plugin" rel="nofollow noopener" target="_blank">Testflight Plugin</a></li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/Run+Condition+Plugin" rel="nofollow noopener" target="_blank">Run Condition Plugin</a></li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Conditional+BuildStep+Plugin" rel="nofollow noopener" target="_blank">Conditional BuildStep Plugin</a></li>
<li><a href="http://wiki.jenkins-ci.org/display/JENKINS/Flexible+Publish+Plugin" rel="nofollow noopener" target="_blank">Flexible Publish Plugin</a></li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Next+Build+Number+Plugin" rel="nofollow noopener" target="_blank">Next Build Number Plugin</a></li>
</ul>

<p><a href="https://wiki.jenkins-ci.org/display/JA/Jenkins+CLI" rel="nofollow noopener" target="_blank">Jenkins CLI</a>を使うなら以下のようにしてインストールできます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>wget http://localhost:8080/jnlpJars/jenkins-cli.jar
java -jar jenkins-cli.jar -s http://localhost:8080 install-plugin \
  git git-client next-build-number run-condition conditional-buildstep flexible-publish \
  xcode-plugin testflight
java -jar jenkins-cli.jar -s http://localhost:8080 safe-restart
</pre></div></div>

<p>rubyやbundlerで細かく制御するためCocoaPodsプラグインは使っておらずシェルで以下を実行します。（余談を参照）</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>pod install
</pre></div></div>

<h2>
<span id="ビルドの種類" class="fragment"></span><a href="#%E3%83%93%E3%83%AB%E3%83%89%E3%81%AE%E7%A8%AE%E9%A1%9E"><i class="fa fa-link"></i></a>ビルドの種類</h2>

<p>Jenkinsからは１つのジョブで以下の３種類のビルドを行います。</p>

<ol>
<li>Dailyビルド</li>
<li>TestFlight配布用ビルドとアップロード (テスト用) </li>
<li>AppStore提出用ビルド</li>
</ol>

<p>1が静的チェックやテストが目的のジョブです。SCMをポーリングさせればコミットしていない日はジョブを実行しないことも可能です。</p>

<p>2と3は配布のためのジョブです。自分のタイミングで行うためにパラメータ付きビルドで手動で行うジョブにします。この２つはTestFlight SDKを組み込むかどうかと、Provisioning Profileを変えているため別々のビルドで成果物を作成します。</p>

<h2>
<span id="使うパラメータ" class="fragment"></span><a href="#%E4%BD%BF%E3%81%86%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF"><i class="fa fa-link"></i></a>使うパラメータ</h2>

<p>パラメータ付きビルドで使うパラメータは以下のとおりです。ジョブを作成したら登録してください。デフォルト値がオフなので毎日の自動ビルドでは配布に関する処理は何も行いません。</p>

<table>
<thead>
<tr>
<th style="text-align: left">パラメータ名</th>
<th style="text-align: left">型</th>
<th style="text-align: left">デフォルト値</th>
<th style="text-align: left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">TESTFLIGHT_UPLOAD</td>
<td style="text-align: left">真偽値</td>
<td style="text-align: left">false</td>
<td style="text-align: left">TestFlightへアップロードするかどうか</td>
</tr>
<tr>
<td style="text-align: left">BUILD_FOR_APPSTORE</td>
<td style="text-align: left">真偽値</td>
<td style="text-align: left">false</td>
<td style="text-align: left">AppStore配布用のビルドを行うかどうか</td>
</tr>
</tbody>
</table>

<p>パラメータ付きビルドで使ったパラメータの値はJenkinsのジョブの実行時に <strong>環境変数</strong> に設定されます。シェルなどから環境変数を参照すれば処理の分岐が可能になります。</p>

<h2>
<span id="ビルドスクリプトの抜粋" class="fragment"></span><a href="#%E3%83%93%E3%83%AB%E3%83%89%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%81%AE%E6%8A%9C%E7%B2%8B"><i class="fa fa-link"></i></a>ビルドスクリプトの抜粋</h2>

<h3>
<span id="jenkins-xcode-plugin-の前処理" class="fragment"></span><a href="#jenkins-xcode-plugin-%E3%81%AE%E5%89%8D%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>Jenkins Xcode Plugin の前処理</h3>

<p><strong>ビルド手順の追加</strong> から <strong>シェルの実行</strong> を追加し、以下のようなシェルの処理を Jenkins Xcode Plugin のビルドの <strong>前</strong> に行っています。ここで行うのは</p>

<ul>
<li>Provisioning Profileの切り替え</li>
<li>TestFlight SDK の有効・無効</li>
<li>CocoaPodsのインストール</li>
</ul>

<p>です。</p>

<p>TestFlightでAdHocに配布する場合と、AppleStoreに配布する場合とでProvisioning Profileを分けているので配布方法によってファイルを切り替えています。Jenkins Xcode Plugin には <code>MyProject.mobileprovision</code> といった適当なファイル名を設定しておき、その名前に元ファイルからコピーしています。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>cp MyProject_Ad_Hoc_Distribution.mobileprovision MyProject.mobileprovision
<span class="k">if</span> <span class="nv">$BUILD_FOR_APPSTORE</span> <span class="o">=</span> <span class="nb">true</span> <span class="p">;</span> <span class="k">then</span>
    rake configure_appstore
    cp MyProject_AppStore_Distribution.mobileprovision MyProject.mobileprovision
<span class="k">fi</span>
pod install
</pre></div></div>

<p><code>rake configure_appstore</code> の処理ではTestFlight SDKを使わないようにソースファイルを変更しています。 Rakefileは以下のような内容になっています。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Rakefile</span></div>
<div class="highlight"><pre><span></span><span class="c1"># encoding: utf-8</span>
<span class="nb">require</span> <span class="s1">'rake'</span>

<span class="n">task</span> <span class="ss">:configure_appstore</span> <span class="k">do</span>
  <span class="n">build_content</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'MyProject/MyProjectBuild.h'</span><span class="p">)</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/(USE_TESTFLIGHT_SDK) 1/</span><span class="p">,</span> <span class="s1">'\1 0'</span><span class="p">)</span>
  <span class="nb">open</span><span class="p">(</span><span class="s1">'MyProject/MyProjectBuild.h'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
    <span class="n">f</span><span class="o">.</span><span class="n n-Operator">&lt;&lt;</span> <span class="n">build_content</span>
  <span class="k">end</span>
  <span class="n">podfile_content</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">'Podfile'</span><span class="p">)</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/^pod 'TestFlightSDK'/</span><span class="p">,</span> <span class="s1">'#\0'</span><span class="p">)</span>
  <span class="nb">open</span><span class="p">(</span><span class="s1">'Podfile'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
    <span class="n">f</span><span class="o">.</span><span class="n n-Operator">&lt;&lt;</span> <span class="n">podfile_content</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>

<p>TestFlight SDKをCocoaPodsで利用している前提です。あるヘッダファイルとPodfileをそれぞれ以下のように置換しています。</p>

<p><code>#define USE_TESTFLIGHT_SDK 1</code> -&gt; <code>#define USE_TESTFLIGHT_SDK 0</code><br>
<code>pod 'TestFlightSDK'</code> -&gt; <code>#pod 'TestFlightSDK'</code> </p>

<p>リポジトリにコミットしてあるソースコードはTestFlight SDKを組み込んだ状態になっているので <strong>configure_appstore</strong> タスクを実行した場合に TestFlight SDKを使うコードをコンパイルしないように変更します。</p>

<p><strong>USE_TESTFLIGHT_SDK</strong> で処理を分岐する話は <a href="http://qiita.com/makoto_kw/items/75e684435e650a4442a4" id="reference-022ce9caf66ede74b7fa">iOSでTestFlight SDKを使うときのメモ</a> を参考にしてください。</p>

<h3>
<span id="jenkins-xcode-plugin-の設定" class="fragment"></span><a href="#jenkins-xcode-plugin-%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Jenkins Xcode Plugin の設定</h3>

<p>Xcodeビルドの設定に入ります。 <strong>ビルド手順の追加</strong> から <strong>Xcode</strong> を追加します。</p>

<h4>
<span id="ビルドの設定" class="fragment"></span><a href="#%E3%83%93%E3%83%AB%E3%83%89%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>ビルドの設定</h4>

<p><strong>General build settings</strong> を設定します。配布が目的なのでビルドの構成である <strong>Configration</strong> に <code>Release</code> を設定し、成果物として使う ipaファイルの名前は <code>MyProject-${VERSION}-${BUILD_DATE}</code> としておきます。</p>

<p><a href="https://camo.qiitausercontent.com/390ef52d986e41f95a70d91510222ef265acd3fc/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35323634613735342d643734652d613861302d633833332d3531393831383731613530342e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/390ef52d986e41f95a70d91510222ef265acd3fc/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35323634613735342d643734652d613861302d633833332d3531393831383731613530342e706e67" alt="jenkins-xcode-build_01.png" title="jenkins-xcode-build_01.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/5264a754-d74e-a8a0-c833-51981871a504.png"></a></p>

<p>次に <strong>Advanced Xcode build options</strong> を設定します。Jenkins Xcode Pluginがわかりにくいのがこの部分です。Xcodeの場合、普通にプロジェクトを作ると、指定したプロジェクト名でプロジェクトディレクトリ、プロジェクトファイル、ワークスペースファイル、ターゲットがつくられるので何をどこで設定しているのがわからなくなります。</p>

<p>参考までに設定しているプロジェクトの階層を以下に示します。ここではソースコードと他のファイルを管理するために、リポジトリの1階層下にプロジェクトのファイルがあります(#1)、リポジトリ直下にファイルがない場合は <strong>Xcode Project Directory</strong> にプロジェクトのあるパスを設定します。</p>

<p>CocoaPodsが作成したWorkspaceファイル (#2) を使うので <strong>Xcode Workspace File</strong> にファイル名を指定しています。</p>

<p><strong>SYMROOT</strong>に <code>${WORKSPACE}/build</code> (#3) を設定しているのでここにipaファイルが出力されます。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>.
├── MyProject  # 1
│   ├── MyProject 
│   ├── MyProject.xcodeproj
│   ├── MyProject.xcworkspace # 2
│   ├── Podfile
│   ├── Podfile.lock
│   └── Pods
├── build #3
│   └── Release-iphoneos
│       └── MyProject-NN-YYYY.mm.dd.ipa
└── README.md
</pre></div></div>

<p><a href="https://camo.qiitausercontent.com/48ba8213ae124b4e9ca196749994eb32ee7b290a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f64306335373634302d326534622d303930612d653835372d3235653936376134366538392e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/48ba8213ae124b4e9ca196749994eb32ee7b290a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f64306335373634302d326534622d303930612d653835372d3235653936376134366538392e706e67" alt="jenkins-xcode-build_02.png" title="jenkins-xcode-build_02.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/d0c57640-2e4b-090a-e857-25e967a46e89.png"></a></p>

<h4>
<span id="署名" class="fragment"></span><a href="#%E7%BD%B2%E5%90%8D"><i class="fa fa-link"></i></a>署名</h4>

<p>署名は <strong>Code signing &amp; OS X keychain options</strong> 項目で行います。 <strong>Embedded Profile</strong> はビルド前の処理でコピーしておいたファイルを設定します。</p>

<p>homebrewでインストールした場合ユーザ権限でJenkinsを動かせるので <strong>Unlock Keychain</strong> を有効にして <strong>Keychain path</strong> に <code>${HOME}/Library/Keychains/login.keychain</code> と <strong>Keychain password</strong> にパスワードを入力しておけばユーザの証明書を参照できます。</p>

<p><a href="https://camo.qiitausercontent.com/9df8f7a1ad1db469736a91f0fa6928301ec2b64b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f36393430666534372d663039382d623138632d393266372d3063643631616363316365332e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/9df8f7a1ad1db469736a91f0fa6928301ec2b64b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f36393430666534372d663039382d623138632d393266372d3063643631616363316365332e706e67" alt="jenkins-xcode-sign.png" title="jenkins-xcode-sign.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/6940fe47-f098-b18c-92f7-0cd61acc1ce3.png"></a></p>

<h4>
<span id="ビルド番号の設定" class="fragment"></span><a href="#%E3%83%93%E3%83%AB%E3%83%89%E7%95%AA%E5%8F%B7%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>ビルド番号の設定</h4>

<p>Jenkins Xcode Pluginでは <strong>Versioning</strong> 項目にチェックをいれるとバージョン番号を自動で設定することができます。 </p>

<p><a href="https://camo.qiitausercontent.com/c9a1943f0945961797f1fbdc33fe062f7b5fae9d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f63336461346162372d626165352d616434372d666365662d6132653130653536326632362e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/c9a1943f0945961797f1fbdc33fe062f7b5fae9d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f63336461346162372d626165352d616434372d666365662d6132653130653536326632362e706e67" alt="jenkins-xcode-version.png" title="jenkins-xcode-version.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/c3da4ab7-bae5-ad47-fcef-a2e10e562f26.png"></a></p>

<p><strong>Technical version</strong> に <code>${BUILD_NUMBER}</code> を設定することでJenkinsのビルド番号を <strong>CFBundleVersion</strong> に設定できます。 Marketing version(CFBundleShortVersionString)はリポジトリで管理してCFBundleVersionはJenkinsに任せるのが良いと思います。</p>

<p>Jenkinsのビルド番号は <strong>1</strong> から始まりますが、<a href="https://wiki.jenkins-ci.org/display/JENKINS/Next+Build+Number+Plugin" rel="nofollow noopener" target="_blank">Next Build Number Plugin</a> を使えば番号を飛ばすことができます。過去のビルドを削除するなどしてより大きな数値のビルドが存在しないようにすれば番号を戻すことも可能です。</p>

<h3>
<span id="jenkins-xcode-plugin-の後処理" class="fragment"></span><a href="#jenkins-xcode-plugin-%E3%81%AE%E5%BE%8C%E5%87%A6%E7%90%86"><i class="fa fa-link"></i></a>Jenkins Xcode Plugin の後処理</h3>

<p><strong>ビルド手順の追加</strong> から <strong>シェルの実行</strong> をもう一つ追加し、以下のようなシェルの処理を Jenkins Xcode Plugin のビルドの <strong>後</strong> に行っています。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>BUILD_DATE=`date '+%Y.%m.%d'`
cd build/Release-iphoneos

if $BUILD_FOR_APPSTORE = true ; then
   mv MyProject-${BUILD_NUMBER}-${BUILD_DATE}.ipa MyProject-${BUILD_NUMBER}-${BUILD_DATE}_for_appstore.ipa
fi
</pre></div></div>

<p><code>BUILD_FOR_APPSTORE</code> が有効のときにファイル名のsuffixに <code>_for_appstore</code> をつけています。これは間違えてTestFlightを組み込んだビルドをアップロードしてしまわないように人間がファイル名で判別しやすいようにするためです。</p>

<h2>
<span id="testflightへのアップロード設定" class="fragment"></span><a href="#testflight%E3%81%B8%E3%81%AE%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>TestFlightへのアップロード設定</h2>

<p>ここからはビルド後の処理の設定です。</p>

<p>TestFlightへのアップロードには <strong>Testflight Plugin</strong> を使います。Testflight Plugin をインストールするとビルド後の処理でTestFlightへのアップロード作業を追加できます。</p>

<p>アップロードにはTokenが必要になるので取得しておきます。<br>
API Token: <a href="https://testflightapp.com/account/#api" class="autolink" rel="nofollow noopener" target="_blank">https://testflightapp.com/account/#api</a><br>
TeamToken: <a href="https://testflightapp.com/dashboard/team/edit/" class="autolink" rel="nofollow noopener" target="_blank">https://testflightapp.com/dashboard/team/edit/</a></p>

<p>Tokenの設定はジョブではなく、 <strong>Jenkinsの管理 &gt; システムの設定 &gt; Test Flight</strong> で行います。チームごとに複数のTokenが設定できます。</p>

<p><a href="https://camo.qiitausercontent.com/ada92beee024a6b3650c18c9432787c54792ab40/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f39356538343834642d323434642d323134352d663939302d3066316132623063373732302e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/ada92beee024a6b3650c18c9432787c54792ab40/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f39356538343834642d323434642d323134352d663939302d3066316132623063373732302e706e67" alt="jenkins-testflight-token.png" title="jenkins-testflight-token.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/95e8484d-244d-2145-f990-0f1a2b0c7720.png"></a></p>

<p>条件付きでアップロード処理を実行させるため、 <strong>ビルド後の処理の追加</strong> で <strong>Flexible publish</strong> を使い Token を <code>${ENV,var="TESTFLIGHT_UPLOAD"}</code> にし、 <strong>Action</strong> で <strong>Upload to TestFlight</strong> を選択します。</p>

<p>これにより手動によるパラメータ付きビルドで <code>TESTFLIGHT_UPLOAD</code> をチェックした場合にのみ TestFlight へのUploadが行えます。</p>

<p><a href="https://camo.qiitausercontent.com/64772f8a86aa329c77caa4855a95db17e40f6933/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f38653336333833612d633862322d353165372d343333622d6266393265666564613739632e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/64772f8a86aa329c77caa4855a95db17e40f6933/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f38653336333833612d633862322d353165372d343333622d6266393265666564613739632e706e67" alt="jenkins_2013-11-11_1249.png" title="jenkins_2013-11-11_1249.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/8e36383a-c8b2-51e7-433b-bf92efeda79c.png"></a></p>

<p>TestFlight Pluginでは高度な設定から配布時の設定が行えます。まずは <strong>Distribution Lists</strong> を使って自分宛に絞って送るようにしています。</p>

<p>Gitのコメントなどを Build Notes に設定することもできますが、コミットのコメントと知人などのテスターへ適切な説明を両立させるのはなかなか困難です。TestFlightではビルドの説明や配布するメンバーを後からでも設定できるのでまずは自分で試して問題ないことを確認してから、ビルドの説明を入力して、配布するメンバーを追加するという運用が良いと思います。</p>

<p><a href="https://camo.qiitausercontent.com/722d7a2083869cd7299b9e56fdf1614885a0fb33/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f64643130626538662d326431642d646662372d656237302d3737663537656461626532612e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/722d7a2083869cd7299b9e56fdf1614885a0fb33/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f64643130626538662d326431642d646662372d656237302d3737663537656461626532612e706e67" alt="jenkins-testflight-detail.png" title="jenkins-testflight-detail.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/dd10be8f-2d1d-dfb7-eb70-77f57edabe2a.png"></a></p>

<h2>
<span id="成果物の設定" class="fragment"></span><a href="#%E6%88%90%E6%9E%9C%E7%89%A9%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>成果物の設定</h2>

<p><strong>ビルド後の処理の追加</strong> で <strong>成果物を保存</strong> を追加し、 <code>build/**/*.ipa,build/**/*dSYM.zip</code> を保存するようにしておきます。</p>

<p><a href="https://camo.qiitausercontent.com/b590d9bc875480ada2fcd837c46c2daab3796e08/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31336462356466352d623665372d353033362d663131642d6231333633383736343563632e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/b590d9bc875480ada2fcd837c46c2daab3796e08/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31336462356466352d623665372d353033362d663131642d6231333633383736343563632e706e67" alt="jenkins-ipa.png" title="jenkins-ipa.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/13db5df5-b6e7-5036-f11d-b136387645cc.png"></a></p>

<p>これでビルドごとのipaファイルがJenkinsからダウンロードできるようになります。</p>

<h2>
<span id="ジョブの実行" class="fragment"></span><a href="#%E3%82%B8%E3%83%A7%E3%83%96%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>ジョブの実行</h2>

<p>ジョブの設定ができたらSCMをポーリングするなどして毎日自動のビルドを走らせます。静的チェックやユニットテストはここで行いましょう。</p>

<p>配布するときはJenkinsにログインして手動でビルドを実行します。手動でジョブを実行しようとするとパラメータの入力を求められるので、TestFlightにアプロードするときは <code>TESTFLIGHT_UPLOAD</code> にチェックを入れ、AppStoreにリリースするときは <code>BUILD_FOR_APPSTORE</code> にチェックを入れてビルドを実行します。TestFlight SDKを組みこんだものをAppStoreに提出したくないのでこの２つのパラメータは排他的に使います。</p>

<p><a href="https://camo.qiitausercontent.com/016a4fc2bcc8a613292a4dcb9d236e751261380b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f33616264636533652d366234612d373262372d333634322d6638626230313337303536642e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/016a4fc2bcc8a613292a4dcb9d236e751261380b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f33616264636533652d366234612d373262372d333634322d6638626230313337303536642e706e67" alt="jenkins-build-param.png" title="jenkins-build-param.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/3abdce3e-6b4a-72b7-3642-f8bb0137056d.png"></a></p>

<h3>
<span id="testflightへのアップロード" class="fragment"></span><a href="#testflight%E3%81%B8%E3%81%AE%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>TestFlightへのアップロード</h3>

<p>ジョブの設定が正しく動いていればTestFlightにアプロードは自動で行えます。実装が終わったらビルドボタンを押すだけでiOS端末でテストができるようになります。</p>

<h3>
<span id="appstoreへの提出" class="fragment"></span><a href="#appstore%E3%81%B8%E3%81%AE%E6%8F%90%E5%87%BA"><i class="fa fa-link"></i></a>AppStoreへの提出</h3>

<p>パラメータ付きビルドで <code>BUILD_FOR_APPSTORE</code> を有効にしてビルドを行うと、ipa ファイルがビルドの成果物として作成されるのでこのファイルをAppStoreに提出します。</p>

<p>ipaファイルを指定してアップロードする場合は Xcode (Organizer) ではなく <strong>Application Loader</strong> を使います。Xcode のメニューの <strong>Xcode &gt; Open Developer Tool &gt; Application Loader</strong> から起動できます。</p>

<p>Organizerを使う場合と同じく、iTunesConnectのアプリのVersionで <strong>Ready to Upload Binary</strong> を押した状態になっていればアップロードが行えます。</p>

<h2>
<span id="余談" class="fragment"></span><a href="#%E4%BD%99%E8%AB%87"><i class="fa fa-link"></i></a>余談</h2>

<ul>
<li>本当は OS X Server + Bot  に興味があったのだけど、CocoaPods周りが面倒そうだったので挫けました。でも諦めてはいません</li>
<li>どうもiOSプロジェクトでAnt, MavenやGradleを使うことに違和感を覚え、Macにはrubyが入っているし、CocoaPodsもrubyが必要なのでシェルやrakeで済ませることにしました</li>
<li>TestFlightでビルドを配布する上でTestFlightSDKは必須ではありません。今回はTestFlightSDKを使うビルド、使わないビルドをそれぞれ作っていますが、TestFlightSDKを使わないで同じビルドで署名だけをつけかえるだけという方法も有効です。 

<ul>
<li>参考: 
iOSアプリの署名を付け替える <a href="http://qiita.com/beakmark/items/33c0b73603e491f08a33" class="autolink" id="reference-943317956fb9bc5920c6">http://qiita.com/beakmark/items/33c0b73603e491f08a33</a>
</li>
</ul>
</li>
<li>Jenkins上で署名できるようになったので署名に関する設定をプロジェクトファイルから削除しました（リポジトリにコミットしているのがなんか嫌だった）</li>
<li>いつもOrganizerを使ってAppStoreに提出していたので ipa ファイルを指定して提出する方法の調べ方がわからなかったのですが、Xcodeを使わないフレームワーク (AIR for iOSとか) 周辺のドキュメントを調べるとわかりました</li>
<li>今回の内容とは関係ないですが Ruby の実行に rbenv を使っていて CocoaPods のバージョンをプロジェクトによって固定するために bundler でプロジェクトローカルにインストールしています。実際には <code>pod install</code> のコマンド部分は以下のような処理を実行しています。</li>
</ul>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>export PATH=$HOME/bin:$HOME/.rbenv/bin:/usr/local/bin:$PATH
eval "$(rbenv init -)"
rbenv shell 1.9.3-p392
bundle install --path=vendor/bundle
bundle exec pod install
</pre></div></div>

<ul>
<li>Jenkinsを長時間起動していると状態がおかしくなる問題に遭遇していて定期的に再起動させています。 <a href="https://issues.jenkins-ci.org/browse/JENKINS-17526" class="autolink" rel="nofollow noopener" target="_blank">https://issues.jenkins-ci.org/browse/JENKINS-17526</a>
</li>
</ul>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">~/Library/LaunchAgents/homebrew.mxcl.jenkins.restart.plist</span></div>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
<span class="nt">&lt;dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;string&gt;</span>homebrew.mxcl.jenkins.restart<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>ProgramArguments<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;array&gt;</span>
       <span class="nt">&lt;string&gt;</span>/usr/bin/java<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;string&gt;</span>-jar<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;string&gt;</span>/Users/Shared/jenkins-cli.jar<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;string&gt;</span>-s<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;string&gt;</span>http://localhost:8080<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;string&gt;</span>safe-restart<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;key&gt;</span>StartCalendarInterval<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;dict&gt;</span>
        <span class="nt">&lt;key&gt;</span>Hour<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;integer&gt;</span>15<span class="nt">&lt;/integer&gt;</span>
        <span class="nt">&lt;key&gt;</span>Minute<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;integer&gt;</span>00<span class="nt">&lt;/integer&gt;</span>
    <span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</pre></div>
</div>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>wget http://localhost:8080/jnlpJars/jenkins-cli.jar /Users/Shared/jenkins-cli.jar
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.jenkins.restart.plist
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />2位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>608</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/d7ed59aff27fb95c9fde">iOS7ステータスバー対策まとめ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-09-24 12:37:46</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>iOS7ではスタースバーは透明、ナビゲーションバー、タブバー、ツールバー、検索バー、スコープバーは半透明。一般的なルールとしてコンテンツの上にこれらのバーを被せることを想定しスタースバーの下に何もバーがないならコンテンツはフルスクリーンコンテンツにすべき。とある。</p>

<h2>
<span id="ios7-フレームワーク判定" class="fragment"></span><a href="#ios7-%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%83%AF%E3%83%BC%E3%82%AF%E5%88%A4%E5%AE%9A"><i class="fa fa-link"></i></a>iOS7 フレームワーク判定</h2>

<ul>
<li>
<a href="https://developer.apple.com/library/prerelease/ios/documentation/UserExperience/Conceptual/TransitionGuide/index.html" rel="nofollow noopener" target="_blank">iOS 7 UI Transition Guide</a>にはこんなやり方が書いてある。場合によってはバージョンよりもNSFoundationVersionNumberを使うほうが意図が明確になる。</li>
</ul>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">NSFoundationVersionNumber</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">NSFoundationVersionNumber_iOS_6_1</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Load resources for iOS 6.1 or earlier</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// Load resources for iOS 7 or later</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="wantsfullscreenlayoutの廃止" class="fragment"></span><a href="#wantsfullscreenlayout%E3%81%AE%E5%BB%83%E6%AD%A2"><i class="fa fa-link"></i></a>wantsFullScreenLayoutの廃止</h2>

<p>iOS7ではフルスクリーンコンテンツを想定しているのでiOS6以下であった <code>wantsFullScreenLayout</code> は非推奨になる。</p>

<h2>
<span id="uiviewcontrollerbasedstatusbarappearance" class="fragment"></span><a href="#uiviewcontrollerbasedstatusbarappearance"><i class="fa fa-link"></i></a>UIViewControllerBasedStatusBarAppearance</h2>

<p>iOS7で動的にスタイルを変更する場合はアプリのInfo.plistファイルで <strong>UIViewControllerBasedStatusBarAppearance</strong> を <strong>YES</strong> に設定しておく。Info.plistをソースから編集する場合は以下の二行を追加すればいい。</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">Info.plist</span></div>
<div class="highlight"><pre><span></span><span class="nt">&lt;key&gt;</span>UIViewControllerBasedStatusBarAppearance<span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;true/&gt;</span>
</pre></div>
</div>

<p>Properrty List Editorから編集する場合は <strong>View controller-based status bar appearance</strong> を選択し <strong>YES</strong> を設定する。</p>

<h2>
<span id="ステータスバーを消す" class="fragment"></span><a href="#%E3%82%B9%E3%83%86%E3%83%BC%E3%82%BF%E3%82%B9%E3%83%90%E3%83%BC%E3%82%92%E6%B6%88%E3%81%99"><i class="fa fa-link"></i></a>ステータスバーを消す</h2>

<p>アプリにステータスバーが要らない場合は、XcodeのTargetのGeneraのHide during application launchにチェックを入れる。これだけだと反映されないのでinfoファイルのUIViewControllerBasedStatusBarAppearanceを <strong>NO</strong> にしておく。</p>

<h2>
<span id="ステータスバーのスタイルを設定する" class="fragment"></span><a href="#%E3%82%B9%E3%83%86%E3%83%BC%E3%82%BF%E3%82%B9%E3%83%90%E3%83%BC%E3%81%AE%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ステータスバーのスタイルを設定する</h2>

<p>アプリのInfo.plistファイルで <strong>UIStatusBarStyle</strong> によって設定できる。</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">Info.plist</span></div>
<div class="highlight"><pre><span></span><span class="nt">&lt;key&gt;</span>UIStatusBarStyle<span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;string&gt;</span>UIStatusBarStyleLightContent<span class="nt">&lt;/string&gt;</span>
</pre></div>
</div>

<p>コードで変更もできるがポイントになるのはiOS7での起動中の話。iPadの起動画面の画像サイズが変わったように起動イメージがステータスバーの領域を含めるので、起動イメージからスタイルを変えたい場合はInfoファイルで制御する。</p>

<p>iOS7で設定可能な値は以下となる。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">enum</span> <span class="o">:</span> <span class="n">NSInteger</span> <span class="p">{</span>
   <span class="n">UIStatusBarStyleDefault</span><span class="p">,</span>
   <span class="n">UIStatusBarStyleLightContent</span><span class="p">,</span>
   <span class="n">UIStatusBarStyleBlackTranslucent</span><span class="p">,</span>
   <span class="n">UIStatusBarStyleBlackOpaque</span>
<span class="p">}</span> <span class="n">UIStatusBarStyle</span><span class="p">;</span>
</pre></div></div>

<p>時刻などステータスバー内のコンテンツの色を白にする場合は <code>UIStatusBarStyleLightContent</code> をつかうと良い。</p>

<p>参考: <a href="http://stackoverflow.com/questions/18924345/how-to-change-status-bar-style-during-launch-on-ios-7" class="autolink" rel="nofollow noopener" target="_blank">http://stackoverflow.com/questions/18924345/how-to-change-status-bar-style-during-launch-on-ios-7</a></p>

<h2>
<span id="動的にステータスバーのスタイルを変更する" class="fragment"></span><a href="#%E5%8B%95%E7%9A%84%E3%81%AB%E3%82%B9%E3%83%86%E3%83%BC%E3%82%BF%E3%82%B9%E3%83%90%E3%83%BC%E3%81%AE%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>動的にステータスバーのスタイルを変更する</h2>

<p>iOS7で動的にスタイルを変更する場合はUIViewControllerBasedStatusBarAppearance を <strong>YES</strong>  にしておく。</p>

<p>デフォルトはApplicationのstatusBarStyleで変更できる。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="p">[</span><span class="bp">UIApplication</span> <span class="n">sharedApplication</span><span class="p">].</span><span class="n">statusBarStyle</span> <span class="o">=</span> <span class="n">UIStatusBarStyleLightContent</span><span class="p">;</span>
</pre></div></div>

<p>ViewController単位での変更も可能で動的にスタイルを変える場合は<br>
<code>(UIStatusBarStyle)preferredStatusBarStyle</code>を実装して変更したいUIStatusBarStyleを返すようにする、任意のタイミングで変更する場合は<code>setNeedsStatusBarAppearanceUpdate</code> を呼び出すことで更新ができる。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="p">{</span>   
    <span class="n">UIStatusBarStyle</span> <span class="n">_statusBarStyle</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">IBAction</span><span class="p">)</span><span class="nl">toggleStatusBar</span><span class="p">:(</span><span class="kt">id</span><span class="p">)</span><span class="n">sender</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">_statusBarStyle</span> <span class="o">==</span> <span class="n">UIStatusBarStyleDefault</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_statusBarStyle</span> <span class="o">=</span> <span class="n">UIStatusBarStyleLightContent</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">_statusBarStyle</span> <span class="o">=</span> <span class="n">UIStatusBarStyleDefault</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">([</span><span class="nb">self</span> <span class="nl">respondsToSelector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">setNeedsStatusBarAppearanceUpdate</span><span class="p">)])</span> <span class="p">{</span>
        <span class="p">[</span><span class="nb">self</span> <span class="n">setNeedsStatusBarAppearanceUpdate</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="n">UIStatusBarStyle</span><span class="p">)</span><span class="n">preferredStatusBarStyle</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">_statusBarStyle</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="動的にステータスバーを非表示にする" class="fragment"></span><a href="#%E5%8B%95%E7%9A%84%E3%81%AB%E3%82%B9%E3%83%86%E3%83%BC%E3%82%BF%E3%82%B9%E3%83%90%E3%83%BC%E3%82%92%E9%9D%9E%E8%A1%A8%E7%A4%BA%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>動的にステータスバーを非表示にする</h2>

<p>iOS7からはViewControllerで</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">prefersStatusBarHidden</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>

<p>を入れるとViewController単位でスターテスバーが消せる。アニメーションは<code>preferredStatusBarUpdateAnimation</code>で指定。iOS6も対応させるなら以下のようになる。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">viewDidLoad</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">viewDidLoad</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">NSFoundationVersionNumber</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">NSFoundationVersionNumber_iOS_6_1</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">[[</span><span class="bp">UIApplication</span> <span class="n">sharedApplication</span><span class="p">]</span> <span class="nl">setStatusBarHidden</span><span class="p">:</span><span class="nb">YES</span> <span class="nl">withAnimation</span><span class="p">:</span><span class="n">UIStatusBarAnimationFade</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">prefersStatusBarHidden</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="n">UIStatusBarAnimation</span><span class="p">)</span><span class="nf">preferredStatusBarUpdateAnimation</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">UIStatusBarAnimationFade</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>

<p>iOS7の <code>prefersStatusBarHidden</code> による対応はそのUIViewControllerのみに限定されるが、iOS6向けのUIApplicationに対する変更はアプリケーション全体に適応されるので画面ごとに切り替える場合は元に戻す処理も必要になるところが注意点。</p>

<p>またiOS7ではUINavigationControllerなどがStatusBarの有無によるマージンをうまく取り扱ってくれることがあるがいくつかのパターンではStatusBarを消したあとのレイアウトも変更する必要がある。</p>

<p>参考:  <a href="http://stackoverflow.com/questions/18375898/status-bar-appear-over-my-views-bounds-in-ios-7" class="autolink" rel="nofollow noopener" target="_blank">http://stackoverflow.com/questions/18375898/status-bar-appear-over-my-views-bounds-in-ios-7</a></p>

<h2>
<span id="uinavigationcontroller-uitabbarcontroller-経由の場合" class="fragment"></span><a href="#uinavigationcontroller-uitabbarcontroller-%E7%B5%8C%E7%94%B1%E3%81%AE%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>UINavigationController, UITabBarController 経由の場合</h2>

<p>iOS7でUINavigationControllerやUITabBarControllerをつかう場合は内部のViewControllerの <code>preferredStatusBarStyle</code> や<code>prefersStatusBarHidden</code> が呼び出されない。</p>

<p>自身で設定するか<br>
<code>childViewControllerForStatusBarStyle</code> や<code>childViewControllerForStatusBarHidden</code> をオーバーライドして処理を委譲するChildViewControllerを指定できる。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nf">childViewControllerForStatusBarStyle</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="bp">UIViewController</span> <span class="o">*</span><span class="p">)</span><span class="nf">childViewControllerForStatusBarHidden</span><span class="p">;</span> 
</pre></div></div>

<h2>
<span id="autolayoutでstatsubarに対する余白を変更する" class="fragment"></span><a href="#autolayout%E3%81%A7statsubar%E3%81%AB%E5%AF%BE%E3%81%99%E3%82%8B%E4%BD%99%E7%99%BD%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>AutoLayoutでStatsuBarに対する余白を変更する</h2>

<p>iOS7向けにステータスバーに重ならないようにViewを配置していると、iOS6ではそれが余計な余白になる。例えばiOS7でステータスバーの真下にラベルを配置すると</p>

<p><a href="https://camo.qiitausercontent.com/76be2c112c8fa19f75cd77eaba63cae916dd6c9b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31393231616362662d303735312d326363372d643733652d3661303865616330663164332e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/76be2c112c8fa19f75cd77eaba63cae916dd6c9b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31393231616362662d303735312d326363372d643733652d3661303865616330663164332e706e67" alt="ios7_2013-09-24_1204.png" title="ios7_2013-09-24_1204.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/1921acbf-0751-2cc7-d73e-6a08eac0f1d3.png"></a></p>

<p>iOS6ではこのようにiOS7向けでStatusBarに対して設定した余白が余分になってしまう。</p>

<p><a href="https://camo.qiitausercontent.com/b534f3ca2b4a847bbb4d198522f3a72c1773c5ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f38663039373333352d353062642d393933322d353838342d3264663633656332623030332e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/b534f3ca2b4a847bbb4d198522f3a72c1773c5ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f38663039373333352d353062642d393933322d353838342d3264663633656332623030332e706e67" alt="ios6_2013-09-24_1206.png" title="ios6_2013-09-24_1206.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/8f097335-50bd-9932-5884-2df63ec2b003.png"></a></p>

<p>iOS6、あるいはiOS7のときにViewの位置を変えるという試練が待ち受けている。iOS6以上ならAutoLayoutを使った方が簡単になる。</p>

<p>簡単な解決の方法は <strong>topLayoutGuide</strong> を使う方法。topのマージンをtopLayoutGuideから0とすると、iOS7ではステータスバーがある場合はステータスバーのbottomからの距離となり、iOS6ではステータスバーは画面領域に含めないので画面のtopからの距離になる。</p>

<p><a href="https://camo.qiitausercontent.com/cc4c49e584300067aed12f7be7a1744e724cfa99/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f37383365663638382d326531652d386630332d386266662d3338646465393234376539652e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/cc4c49e584300067aed12f7be7a1744e724cfa99/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f37383365663638382d326531652d386630332d386266662d3338646465393234376539652e706e67" alt="toplayoutguide_2013-09-24_1212.png" title="toplayoutguide_2013-09-24_1212.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/783ef688-2e1e-8f03-8bff-38dde9247e9e.png"></a></p>

<p>もう一つの方法はAutoLayoutの値を自分で調整する方法。例えばまずiOS7向けにViewのtopのマージンを20と設定する。</p>

<p><a href="https://camo.qiitausercontent.com/c40ef767c6f6b001f9eb8fc3f8ea1be115316e02/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f36373561613334322d653936362d353937362d333962612d6333313237376339616139642e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/c40ef767c6f6b001f9eb8fc3f8ea1be115316e02/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f36373561613334322d653936362d353937362d333962612d6333313237376339616139642e706e67" alt="topview_2013-09-24_1219.png" title="topview_2013-09-24_1219.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/675aa342-e966-5976-39ba-c31277c9aa9d.png"></a></p>

<p>AutoLayoutのConstraintはIBOutletでコードから操作することができる。</p>

<p><a href="https://camo.qiitausercontent.com/014e2e4271819897555229bb048a517fcab56844/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f30393936623465332d623765352d313732622d646235342d6330626363393433323434312e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/014e2e4271819897555229bb048a517fcab56844/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f30393936623465332d623765352d313732622d646235342d6330626363393433323434312e706e67" alt="iboutlet_2013-09-24_1227.png" title="iboutlet_2013-09-24_1227.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/0996b4e3-b7e5-172b-db54-c0bcc9432441.png"></a></p>

<p>これを利用してiOS6のときにtopのマージンを20-&gt;0にするという実装が可能になる。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="kt">IBOutlet</span> <span class="bp">NSLayoutConstraint</span> <span class="o">*</span><span class="n">_headerMargin</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">viewDidLoad</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">NSFoundationVersionNumber</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">NSFoundationVersionNumber_iOS_6_1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_headerMargin</span><span class="p">.</span><span class="n">constant</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="ios5でstatsubarに対する余白を変更する" class="fragment"></span><a href="#ios5%E3%81%A7statsubar%E3%81%AB%E5%AF%BE%E3%81%99%E3%82%8B%E4%BD%99%E7%99%BD%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>iOS5でStatsuBarに対する余白を変更する</h2>

<p>iOS5をターゲットにしているとAutoLayoutが使えないのでtopLayoutGuideを利用できない。</p>

<p>代わりに <code>iOS 6/7 Deltas</code> をつかうことで解決する。これはiOS6(以下)向けに座標やサイズを調整する機能でY座標を-20にすればiOS7向けに設定したステータスバー分の余白を相殺することができる。(View as <code>iOS 7.0 and Later</code> で表示している場合、iOS 6.1 and EarilerでみるとDeltaが逆になる)</p>

<p><a href="https://camo.qiitausercontent.com/efdc2fa44298e3bb7d933f8aea1186b8b351beaa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35323035306232372d396130352d346630392d346535662d6431633930643264303739652e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/efdc2fa44298e3bb7d933f8aea1186b8b351beaa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35323035306232372d396130352d346630392d346535662d6431633930643264303739652e706e67" alt="autoresize_2013-09-30_1652.png" title="autoresize_2013-09-30_1652.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/52050b27-9a05-4f09-4e5f-d1c90d2d079e.png"></a></p>

<p>この例ではUILabelを直接設定しているが、他のコントロールも調整が必要になるのでレイアウト用にコンテナのUIViewを追加してそこで iOS 6/7 Deltas を設定し、それ以外はそのコンテナUIViewのsubViewとしてレイアウトするのが良いと思われる。レイアウトに使うUIVewiはY座標を-20をした場合にはHeightを+20しないと画面下部に余白ができてしまうことに注意する。</p>

<p>参考: <a href="http://qiita.com/ne_ko_/items/5da4b2a247e65431c7cf" id="reference-a42eaaacbccc30dce1dc">iOS 6/7 で UILabel などの見た目がずれるよ〜とお嘆きのあなたへ</a></p>

<h2>
<span id="statusbarをuinavigationbarにかぶせる" class="fragment"></span><a href="#statusbar%E3%82%92uinavigationbar%E3%81%AB%E3%81%8B%E3%81%B6%E3%81%9B%E3%82%8B"><i class="fa fa-link"></i></a>StatusBarをUINavigationBarにかぶせる</h2>

<p>iOS7でUINavigationControllerをつかう場合、UINavigationBarの上にStatusBarがかぶさるようになっている。</p>

<p>UINavigationControllerを使わずにUIコントロールとして直接UINavigationBarを直接つかう場合、単にStatusBar分の余白を空ける方法だと以下のようにUINavigationBarの色が画面上部まで適応されないのでiOS7らしくならない。</p>

<p><a href="https://camo.qiitausercontent.com/99526dc8f6a01d9711445e0c7bbd52cd20861470/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f33383436663233382d653361652d666136642d656661392d3130346135656361306163622e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/99526dc8f6a01d9711445e0c7bbd52cd20861470/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f33383436663233382d653361652d666136642d656661392d3130346135656361306163622e706e67" alt="navbar_2013-09-30_1618.png" title="navbar_2013-09-30_1618.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/3846f238-e3ae-fa6d-efa9-104a5eca0acb.png"></a></p>

<p>これを解決するために <code>UIBarPositioningDelegate</code>の<code>(UIBarPosition)positionForBar:(id&lt;UIBarPositioning&gt;)bar</code> で <strong>UIBarPositionTopAttached</strong> を返す。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="kt">IBOutlet</span> <span class="bp">UINavigationBar</span> <span class="o">*</span><span class="n">_navBar</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">viewDidLoad</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">viewDidLoad</span><span class="p">];</span>

    <span class="n">_navBar</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>    
    <span class="k">if</span> <span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">NSFoundationVersionNumber</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">NSFoundationVersionNumber_iOS_6_1</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_navBar</span><span class="p">.</span><span class="n">barTintColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="n">yellowColor</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="o">-</span> <span class="p">(</span><span class="n">UIBarPosition</span><span class="p">)</span><span class="nl">positionForBar</span><span class="p">:(</span><span class="kt">id</span> <span class="o">&lt;</span><span class="bp">UIBarPositioning</span><span class="o">&gt;</span><span class="p">)</span><span class="n">bar</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">UIBarPositionTopAttached</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>

<p>これによりbarTintColorがStatusBarの下にもちゃんと設定されるようになる。</p>

<p><a href="https://camo.qiitausercontent.com/988970f5cfed7f699aca96fd4882cd1aeada85ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31343236663631312d373766312d383531362d383936612d3138306262616266313865642e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/988970f5cfed7f699aca96fd4882cd1aeada85ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31343236663631312d373766312d383531362d383936612d3138306262616266313865642e706e67" alt="navbar_2013-09-30_1631.png" title="navbar_2013-09-30_1631.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/1426f611-77f1-8516-896a-180bbabf18ed.png"></a></p>

<p>これは前節のtopLayoutGuideと合わせてつかった場合。なお、UIBarPositioningDelegateやbarTintColorなどはiOS 7以降の機能となっている。</p>

<p>参考: <a href="https://devforums.apple.com/message/853889" class="autolink" rel="nofollow noopener" target="_blank">https://devforums.apple.com/message/853889</a></p>

<h2>
<span id="その他" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96"><i class="fa fa-link"></i></a>その他</h2>

<p>AutoLayoutやiOS 6/7 DeltasなどInterface Builderに頼らない場合は以下にあるように直接ViewのFrameを設定するなどの調整が必要になる。</p>

<ul>
<li><a href="http://stackoverflow.com/questions/18294872/ios-7-status-bar-back-to-ios-6-style/" class="autolink" rel="nofollow noopener" target="_blank">http://stackoverflow.com/questions/18294872/ios-7-status-bar-back-to-ios-6-style/</a></li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />3位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>350</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/edf758a67bd4c2ba5b7a">CocoaPodsでPodの利用＆作成のメモ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-02-05 02:42:10</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[iOS]</b> <b>[CocoaPods]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="http://cocoapods.org/" rel="nofollow noopener" target="_blank">CocoaPods</a>とはターミナルからコマンドを打ってiOSやOS Xのライブラリを導入できるツール。</p>

<p>利用するライブラリのことをPodと読んでいるのでRubyGems≒CocoaPodsと考えるとわかりやすいかも。</p>

<h2>
<span id="cocoapodsのインストール" class="fragment"></span><a href="#cocoapods%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>CocoaPodsのインストール</h2>

<p>OS Xに入っているRubyGemsを使ってセットアップできる。<br>
( rbenvを使ってセットアップするメモ書きました <a href="http://qiita.com/items/53753cb824f47c4a48df" class="autolink">http://qiita.com/items/53753cb824f47c4a48df</a> )</p>

<p><a href="http://rubygems.org/gems/cocoapods" class="autolink" rel="nofollow noopener" target="_blank">http://rubygems.org/gems/cocoapods</a></p>

<div class="code-frame" data-lang="bash">
<div class="code-lang"><span class="bold">Terminal</span></div>
<div class="highlight"><pre><span></span>sudo gem install cocoapods
pod setup
</pre></div>
</div>

<p>当然CocoaPods自体の更新もRubyGemsで行える。</p>

<div class="code-frame" data-lang="bash">
<div class="code-lang"><span class="bold">Terminal</span></div>
<div class="highlight"><pre><span></span>sudo gem update cocoapods
</pre></div>
</div>

<h2>
<span id="podの利用" class="fragment"></span><a href="#pod%E3%81%AE%E5%88%A9%E7%94%A8"><i class="fa fa-link"></i></a>Podの利用</h2>

<p>Xcodeプロジェクトファイル(MyPorjectName.xcodeproj)と同じ階層で</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Podfile</span></div>
<div class="highlight"><pre><span></span><span class="n">platform</span> <span class="ss">:ios</span><span class="p">,</span><span class="s1">'5.0'</span>
<span class="n">pod</span> <span class="s1">'JSONKit'</span><span class="p">,</span> <span class="s1">'~&gt; 1.4'</span>
<span class="n">pod</span> <span class="s1">'Reachability'</span><span class="p">,</span> <span class="s1">'~&gt; 3.0.0'</span>
</pre></div>
</div>

<p>のようにファイル名<strong>Podfile</strong>というテキストファイルを置いてそのディレクトリで<code>pod install</code>を実行するとPodが使えるようになる。その際に必要なframeworkやリンクオプションを追加して依存関係を解決してくれ、Xcodeプロジェクトの設定が変更され、Xcodeワークスペースが用意される。通常はCocoaPodsが作成してくれるXcodeワークスペースを利用するのが良い。</p>

<div class="code-frame" data-lang="bash">
<div class="code-lang"><span class="bold">Terminal</span></div>
<div class="highlight"><pre><span></span>open MyPorjectName.xcworkspace
</pre></div>
</div>

<p>仕組みとしてはPod.aというスタティックライブラリプロジェクトをワークスペースに追加して、そこにソースファイルをまとめている模様。</p>

<p>どういうことを実際に行なっているかは <a href="https://github.com/CocoaPods/CocoaPods/wiki/Creating-a-project-that-uses-CocoaPods" rel="nofollow noopener" target="_blank">Creating a project that uses CocoaPods</a> にあるので自前のワークスペースに設定するときやうまく動かないときに参考になる。</p>

<p><code>[!] xxxx is not compatible with iOS 4.3.</code>とエラーがおきる場合は、以下のようにして明示的にiOSバージョンをPodfileに指定する必要がある。</p>

<div class="code-frame" data-lang="Podfile"><div class="highlight"><pre><span></span>platform :ios,'5.0'
</pre></div></div>

<p>ヘッダファイルはHeader Search Pathに"${PODS_ROOT}/Headers" "${PODS_ROOT}/Headers/JSONKit" のように追加されるので<code>import "JSONKit.h"</code> <code>import "JSONKit/JSONKit.h"</code>のどちらでも記述できるが後者の方が安全か。異なるPodでヘッダファイル名が重複した場合の動きは未調査。</p>

<p>リンクがうまくいかない場合などはPROJECTの方に設定が反映されているのでTARGETのOther Linker Flagsに$(inherited)が入っているかなどをチェックする必要がある。</p>

<h3>
<span id="subspecの利用" class="fragment"></span><a href="#subspec%E3%81%AE%E5%88%A9%E7%94%A8"><i class="fa fa-link"></i></a>Subspecの利用</h3>

<p>PodによってはモジュールごとにSubspecという単位で分けている場合がある。例えばShareKitを使いたいけど全部はいらなくて特定のサービスだけ使いたいというときはPodfileを以下のように書ける。</p>

<div class="code-frame" data-lang="Podfile"><div class="highlight"><pre><span></span>pod 'ShareKit/Facebook'
pod 'ShareKit/Twitter'
</pre></div></div>

<p><strong>CocoaPods 0.17.0からSubspecがMainSpecを継承しなくなったのでSubspecだけを使うときに依存するファイルが足りないことがある</strong></p>

<h3>
<span id="cocoapods利用時のリポジトリ構成" class="fragment"></span><a href="#cocoapods%E5%88%A9%E7%94%A8%E6%99%82%E3%81%AE%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA%E6%A7%8B%E6%88%90"><i class="fa fa-link"></i></a>CocoaPods利用時のリポジトリ構成</h3>

<p>Bundlerの思想を受け継いでいるならPodfileとPodfile.lockだけリポジトリに入れておいて、他の開発者にはpod installでPodsディレクトリとワークスペースを作成してもらえばいいから、特にワークスペースの設定をいじっていないなら</p>

<div class="code-frame" data-lang="gitignore"><div class="highlight"><pre><span></span>Pods/
MyPorjectName.xcworkspace
</pre></div></div>

<p>でいいんじゃないかと思っているんだけどそれを裏付けるドキュメントはオフィシャルWikiからは見つけられなかった。</p>

<h2>
<span id="podの作成" class="fragment"></span><a href="#pod%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>Podの作成</h2>

<p>CocoaPodsにライブラリ定義の生成(pod spec create)や検証(pod spec lint)を行うコマンドが用意されている</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>pod spec create MyPod
vi MyPod.podspec
pod spec lint MyPod.podspec
</pre></div></div>

<p>書き方は<a href="http://docs.cocoapods.org/specification.html" rel="nofollow noopener" target="_blank">仕様</a>があるけど、<a href="https://github.com/CocoaPods/Specs" rel="nofollow noopener" target="_blank">既存Pod</a>のpodspecを見たりすると勉強になる。</p>

<p>ディレクトリ構成の推奨<br>
<a href="https://github.com/CocoaPods/CocoaPods/wiki/Creating-and-maintaining-a-pod" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/CocoaPods/CocoaPods/wiki/Creating-and-maintaining-a-pod</a></p>

<div class="code-frame" data-lang="/path/to/Pods/NAME"><div class="highlight"><pre><span></span>.
├── Classes
    └── ios
    └── osx
├── Resources
├── Project
    └── Podfile
├── LICENSE
├── Readme.markdown
└── NAME.podspec
</pre></div></div>

<p>ただこの形になっていないPodが多数存在する。（現状がPod以前のライブラリをかき集めている状態のせいかも）</p>

<p>個人的には以下のような構成にしてる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>MyPodName
├── MyPodName
    └── {*.h,*.m}
├── MyPodNameDemo
    ├── MyPodNameDemo.xcodeproj
    └── Podfile
└── MyPodName.podspec
</pre></div></div>

<p>デモプロジェクトからもPodを使って確認する。以下のようにpathオプションでPodを指定する。(MyPodName/MyPodNameDemo/PodfileからMyPodNameに依存)</p>

<p><strong>CocoaPods 0.19からlocalオプションはpathオプションに名前変更<a href="https://github.com/CocoaPods/CocoaPods/issues/971" rel="nofollow noopener" target="_blank">#971</a></strong></p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">MyPodNameDemo/Podfile</span></div>
<div class="highlight"><pre><span></span><span class="n">platform</span> <span class="ss">:ios</span><span class="p">,</span><span class="s1">'5.0'</span>
<span class="n">pod</span> <span class="s1">'MyPodName'</span><span class="p">,</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">'..'</span>
</pre></div>
</div>

<p>なおPodfile、podspecファイルを編集する場合はエディタでRubyと認識させるといい。</p>

<h3>
<span id="ローカルで自分のpodを自分の複数のプロジェクトで共有する" class="fragment"></span><a href="#%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A7%E8%87%AA%E5%88%86%E3%81%AEpod%E3%82%92%E8%87%AA%E5%88%86%E3%81%AE%E8%A4%87%E6%95%B0%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%A7%E5%85%B1%E6%9C%89%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ローカルで自分のPodを自分の複数のプロジェクトで共有する</h3>

<p>再利用可能な自分のPodを複数のプロジェクトから参照する場合、相対パスだと面倒なのでどこかにPodプロジェクトをまとめるディレクトリを作って以下のようにすると参照しやすい。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Podfile</span></div>
<div class="highlight"><pre><span></span><span class="n">pod</span> <span class="s1">'MyPodName'</span><span class="p">,</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">'~/code/Pods/MyPodName'</span>
</pre></div>
</div>

<h2>
<span id="podの配布" class="fragment"></span><a href="#pod%E3%81%AE%E9%85%8D%E5%B8%83"><i class="fa fa-link"></i></a>Podの配布</h2>

<p>Pod公式リポジトリに公開しなくても</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Podfile</span></div>
<div class="highlight"><pre><span></span><span class="n">pod</span> <span class="s1">'TTTFormatterKit'</span><span class="p">,</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s1">'https://github.com/gowalla/AFNetworking.git'</span>
</pre></div>
</div>

<p>のようにしてSCM経由で利用してもらうこともできる。Forkしたライブラリを利用するときに有効。</p>

<h2>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h2>

<ul>
<li><a href="http://d.hatena.ne.jp/Watson/20111205/mac_dev_jp_advent_calendar_cocoapods02" rel="nofollow noopener" target="_blank">CocoaPods ではじめる Objective-C ライブラリ管理 (2)</a></li>
<li>
<a href="https://github.com/CocoaPods/CocoaPods/wiki" rel="nofollow noopener" target="_blank">CocoaPods wiki</a>

<ul>
<li><a href="https://github.com/CocoaPods/CocoaPods/wiki/Creating-and-maintaining-a-pod" rel="nofollow noopener" target="_blank">Creating and maintaining a pod</a></li>
</ul>
</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />4位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>269</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/cbe93d4ebbc35f3b43fd">OS XにJenkinsをHomebrewでセットアップする</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-11-05 14:38:44</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[homebrew]</b> <b>[Jenkins]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>Jenkinsは <a href="http://jenkins-ci.org/" rel="nofollow noopener" target="_blank">jenkins-ci.org</a> からMac OS  X用のインストーラも配布されている。公式のインストーラはシステム、Homebrewの場合はユーザ環境で使うことを想定している。どちらも一長一短あるが特に致命的で回避できない問題はないように思えるのでセットアップが楽なHomebrewを使っている。</p>

<h2>
<span id="インストール" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>インストール</h2>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>brew install jenkins
</pre></div></div>

<p>jekinsをhomebrewでアップデートすると起動ファイルも更新されてしまうのでシンボリックリンクを張るのではなくコピーを <code>~/Library/LaunchAgents/homebrew.mxcl.jenkins.plist</code> に置くため以下を実行する。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>cp -p /usr/local/opt/jenkins/*.plist ~/Library/LaunchAgents
</pre></div></div>

<h2>
<span id="サーバの起動コマンドのカスタマイズ" class="fragment"></span><a href="#%E3%82%B5%E3%83%BC%E3%83%90%E3%81%AE%E8%B5%B7%E5%8B%95%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%AE%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA"><i class="fa fa-link"></i></a>サーバの起動コマンドのカスタマイズ</h2>

<p><code>~/Library/LaunchAgents/homebrew.mxcl.jenkins.plist</code> を編集し、起動時のパラメータを指定する。</p>

<p>起動引数: <a href="https://wiki.jenkins-ci.org/display/JENKINS/Starting+and+Accessing+Jenkins" class="autolink" rel="nofollow noopener" target="_blank">https://wiki.jenkins-ci.org/display/JENKINS/Starting+and+Accessing+Jenkins</a></p>

<p>変更例</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">~/Library/LaunchAgents/homebrew.mxcl.jenkins.plist</span></div>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;string&gt;</span>homebrew.mxcl.jenkins<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;key&gt;</span>ProgramArguments<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;array&gt;</span>
      <span class="nt">&lt;string&gt;</span>/usr/bin/java<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;string&gt;</span>-Xms512m<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;string&gt;</span>-Xmx1024m<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;string&gt;</span>-XX:MaxPermSize=128m<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;string&gt;</span>-Dfile.encoding=utf-8<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;string&gt;</span>-jar<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;string&gt;</span>/usr/local/opt/jenkins/libexec/jenkins.war<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;/array&gt;</span>
    <span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;true/&gt;</span>
  <span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</pre></div>
</div>

<h3>
<span id="文字コードの変更" class="fragment"></span><a href="#%E6%96%87%E5%AD%97%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>文字コードの変更</h3>

<p>GitのUTF-8のコメントが化ける場合があるのでエンコードを設定している。</p>

<p><code>&lt;string&gt;-Dfile.encoding=utf-8&lt;/string&gt;</code></p>

<h3>
<span id="外部から接続させる場合" class="fragment"></span><a href="#%E5%A4%96%E9%83%A8%E3%81%8B%E3%82%89%E6%8E%A5%E7%B6%9A%E3%81%95%E3%81%9B%E3%82%8B%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>外部から接続させる場合</h3>

<p>外部からアクセスさせるため <code>&lt;string&gt;--httpListenAddress=127.0.0.1&lt;/string&gt;</code> の行を削除している。</p>

<h3>
<span id="メールサーバの証明書が不完全な場合" class="fragment"></span><a href="#%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%B5%E3%83%BC%E3%83%90%E3%81%AE%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%8C%E4%B8%8D%E5%AE%8C%E5%85%A8%E3%81%AA%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>メールサーバの証明書が不完全な場合</h3>

<p>社内メールサーバなどでメールサーバの証明書が完全に信頼できない場合でもメールを送信できるように <code>&lt;string&gt;-Dmail.smtp.starttls.enable=true&lt;/string&gt;</code> の行を削除している</p>

<p>※Gmailなどを使う場合は関係なし</p>

<h3>
<span id="ポートを変える場合" class="fragment"></span><a href="#%E3%83%9D%E3%83%BC%E3%83%88%E3%82%92%E5%A4%89%E3%81%88%E3%82%8B%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>ポートを変える場合</h3>

<p>例では入れていないが <code>&lt;string&gt;/usr/local/opt/jenkins/libexec/jenkins.war&lt;/string&gt;</code> の次の行あたりに以下のように追加すると良い。<br>
<code>&lt;string&gt;--httpPort=80&lt;/string&gt;</code></p>

<h3>
<span id="メモリの変更" class="fragment"></span><a href="#%E3%83%A1%E3%83%A2%E3%83%AA%E3%81%AE%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>メモリの変更</h3>

<p>適当。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>&lt;string&gt;-Xms512m&lt;/string&gt;
&lt;string&gt;-Xmx1024m&lt;/string&gt;
&lt;string&gt;-XX:MaxPermSize=128m&lt;/string&gt;
</pre></div></div>

<p>参考: <a href="https://wiki.jenkins-ci.org/display/JENKINS/Builds+failing+with+OutOfMemoryErrors" class="autolink" rel="nofollow noopener" target="_blank">https://wiki.jenkins-ci.org/display/JENKINS/Builds+failing+with+OutOfMemoryErrors</a></p>

<h2>
<span id="自動起動の設定" class="fragment"></span><a href="#%E8%87%AA%E5%8B%95%E8%B5%B7%E5%8B%95%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>自動起動の設定</h2>

<p>以下を実行しておく。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>launchctl load ~/Library/LaunchAgents/homebrew.mxcl.jenkins.plist
</pre></div></div>

<h2>
<span id="自動起動の解除" class="fragment"></span><a href="#%E8%87%AA%E5%8B%95%E8%B5%B7%E5%8B%95%E3%81%AE%E8%A7%A3%E9%99%A4"><i class="fa fa-link"></i></a>自動起動の解除</h2>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.jenkins.plist
</pre></div></div>

<h2>
<span id="launchctlで再起動したり" class="fragment"></span><a href="#launchctl%E3%81%A7%E5%86%8D%E8%B5%B7%E5%8B%95%E3%81%97%E3%81%9F%E3%82%8A"><i class="fa fa-link"></i></a>launchctlで再起動したり</h2>

<p>自動起動が設定済みであれば以下のコマンドを利用できる。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>launchctl stop homebrew.mxcl.jenkins
launchctl start homebrew.mxcl.jenkins
</pre></div></div>

<h2>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h2>

<ul>
<li>Mountain Lion環境への「Jenkins」のインストール手順: <a href="http://qiita.com/skinoshita/items/6862b4a6726fc3b24944" class="autolink" id="reference-c7395954dba692f63916">http://qiita.com/skinoshita/items/6862b4a6726fc3b24944</a>
</li>
<li>Jenkins を Mac で使う: <a href="http://tech.hazi.jp/2012-08/13/" class="autolink" rel="nofollow noopener" target="_blank">http://tech.hazi.jp/2012-08/13/</a>
</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />5位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>267</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/53a84380559c087eb8fb">Chefレシピ逆引きメモ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-03-04 01:02:52</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[chef]</b> <b>[chef-solo]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>よく使うものを逆引きできるように。</p>

<h2>
<span id="アンチパターンを知る" class="fragment"></span><a href="#%E3%82%A2%E3%83%B3%E3%83%81%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%82%92%E7%9F%A5%E3%82%8B"><i class="fa fa-link"></i></a>アンチパターンを知る</h2>

<p><a href="http://www.slideshare.net/JulianDunn/beginner-chef-antipatterns" class="autolink" rel="nofollow noopener" target="_blank">http://www.slideshare.net/JulianDunn/beginner-chef-antipatterns</a><br>
<a href="http://www.creationline.com/lab/3080" class="autolink" rel="nofollow noopener" target="_blank">http://www.creationline.com/lab/3080</a></p>

<ol>
<li>すべてのChefデータを1つの巨大なGitレポジトリに入れてしまう

<ul>
<li>cookbooksにはバージョンがあるが、environmentsやrolesにはない</li>
<li>cookbooksとして分割すべきものはリポジトリを分けるべき</li>
</ul>
</li>
<li>会社名つきの巨大なCookbookを作ってしまう

<ul>
<li>本来組み合わせるべきでないものが混ざる危険がある</li>
<li>プロジェクト別に分けるべき</li>
</ul>
</li>
<li> Environmentsを論理的な環境以上の目的で使ってしまう

<ul>
<li>developmentとかproductionとか論理的な環境で使い、クラスタとかデータセンターといった割り当てに使わない</li>
</ul>
</li>
<li>Community Cookbookをフォークしてしまう

<ul>
<li>開発元のバグ修正や機能追加といった恩恵を受け取れない、なるべくラップする方が良い</li>
</ul>
</li>
<li>Role内でrun_listを管理してしまう

<ul>
<li>roleはバージョンが付かない、代わりに <code>include_recipe</code> を使いrecipeでまとめる</li>
</ul>
</li>
<li>無秩序なdata bagを作ってしまう

<ul>
<li>data bagとdata bag itemという2階層なので作る前に計画しておく</li>
</ul>
</li>
<li>chef-shellを知らない、使わない

<ul>
<li>Cookbook開発、デバッグに適している</li>
</ul>
</li>
<li>LWRPを怖がってしまう

<ul>
<li>言うほどLWRPの実装は難しくない</li>
</ul>
</li>
<li>外部発祥だから利用しない症候群に陥ってしまう

<ul>
<li>まず使えるものがあるか探し、変更が必要ならコントリビュートする</li>
</ul>
</li>
<li>孤独なChef使いになってしまう

<ul>
<li>あるセットアップに自分より詳しいメンバーがいるなら任せ、チームで責任を持つ</li>
</ul>
</li>
</ol>

<h2>
<span id="レシピをチェックする" class="fragment"></span><a href="#%E3%83%AC%E3%82%B7%E3%83%94%E3%82%92%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>レシピをチェックする</h2>

<p><a href="http://acrmp.github.io/foodcritic/" class="autolink" rel="nofollow noopener" target="_blank">http://acrmp.github.io/foodcritic/</a></p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>gem i foodcritic
foodcritic -C .
</pre></div></div>

<p><a href="http://acrmp.github.io/foodcritic/#FC001" rel="nofollow noopener" target="_blank">FC001</a>など警告の内容についてはサイトに載っている。</p>

<h3>
<span id="fc001以外をチェックする" class="fragment"></span><a href="#fc001%E4%BB%A5%E5%A4%96%E3%82%92%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>FC001以外をチェックする</h3>

<p><code>FC001</code>はdeprecatedになった。<code>FC001</code>を除外して検証するには以下のようにする。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>foodcritic -t ~FC001 site-cookbooks
</pre></div></div>

<h2>
<span id="ログを出す" class="fragment"></span><a href="#%E3%83%AD%E3%82%B0%E3%82%92%E5%87%BA%E3%81%99"><i class="fa fa-link"></i></a>ログを出す</h2>

<p><a href="http://docs.opscode.com/resource_log.html" rel="nofollow noopener" target="_blank">log</a>リソースを使う。でもレシピの一時的なデバッグならrubyの<code>puts</code>や<code>p</code>でもいいかもしれない。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">log</span> <span class="s2">"a debug string"</span> <span class="k">do</span>
  <span class="n">level</span> <span class="ss">:debug</span>
<span class="k">end</span>

<span class="n">log</span> <span class="s2">"message"</span> <span class="k">do</span>
  <span class="n">message</span> <span class="s2">"This is the message that will be added to the log."</span>
  <span class="n">level</span> <span class="ss">:info</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="vagrantのプロビジョニングでログレベルを変更する" class="fragment"></span><a href="#vagrant%E3%81%AE%E3%83%97%E3%83%AD%E3%83%93%E3%82%B8%E3%83%A7%E3%83%8B%E3%83%B3%E3%82%B0%E3%81%A7%E3%83%AD%E3%82%B0%E3%83%AC%E3%83%99%E3%83%AB%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Vagrantのプロビジョニングでログレベルを変更する</h2>

<p><code>log_level</code>属性を使う。<br>
<a href="http://docs.vagrantup.com/v2/provisioning/chef_common.html" class="autolink" rel="nofollow noopener" target="_blank">http://docs.vagrantup.com/v2/provisioning/chef_common.html</a></p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">provision</span> <span class="ss">:chef_solo</span> <span class="k">do</span> <span class="o">|</span><span class="n">chef</span><span class="o">|</span>
  <span class="n">chef</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="ss">:debug</span>
</pre></div></div>

<h2>
<span id="nodeの属性を出力する" class="fragment"></span><a href="#node%E3%81%AE%E5%B1%9E%E6%80%A7%E3%82%92%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>nodeの属性を出力する</h2>

<p>とりあえずjsonで</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="nb">puts</span> <span class="no">JSON</span><span class="o">.</span><span class="n">pretty_generate</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</pre></div></div>

<p>またはレシピ内で使いそうなものだけ確認。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="o">[</span><span class="ss">:platform</span><span class="p">,</span> <span class="ss">:platform_version</span><span class="p">,</span> <span class="ss">:ipaddress</span><span class="p">,</span> <span class="ss">:fqdn</span><span class="p">,</span> <span class="ss">:hostname</span><span class="p">,</span> <span class="ss">:domain</span><span class="o">].</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="s2">"node['</span><span class="si">#{</span><span class="n">key</span><span class="si">}</span><span class="s2">'] = </span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="n">key</span><span class="o">]</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="置き換わったファイルのバックアップを見る" class="fragment"></span><a href="#%E7%BD%AE%E3%81%8D%E6%8F%9B%E3%82%8F%E3%81%A3%E3%81%9F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97%E3%82%92%E8%A6%8B%E3%82%8B"><i class="fa fa-link"></i></a>置き換わったファイルのバックアップを見る</h2>

<p><code>template</code>リソースなどでファイルを置き換えた場合に、元のファイルはリモートサーバの <code>/var/chef/backup/</code> に保存されている。</p>

<h2>
<span id="パスワードのハッシュを生成する" class="fragment"></span><a href="#%E3%83%91%E3%82%B9%E3%83%AF%E3%83%BC%E3%83%89%E3%81%AE%E3%83%8F%E3%83%83%E3%82%B7%E3%83%A5%E3%82%92%E7%94%9F%E6%88%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>パスワードのハッシュを生成する</h2>

<p>Unixではパスワードを <code>$＜ハッシュ方式＞$＜salt＞$＜ハッシュ後のパスワード＞</code> で表現している。以下のコマンドでそれに対応したMD5のhashを出力できる。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>openssl passwd -1 <span class="s1">'password'</span>
</pre></div></div>

<h2>
<span id="environmentで分岐する" class="fragment"></span><a href="#environment%E3%81%A7%E5%88%86%E5%B2%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Environmentで分岐する</h2>

<p><code>node.chef_environment</code> を見る</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">chef_environment</span> <span class="o">==</span> <span class="s1">'development'</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="osで分岐する" class="fragment"></span><a href="#os%E3%81%A7%E5%88%86%E5%B2%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>OSで分岐する</h2>

<h3>
<span id="os" class="fragment"></span><a href="#os"><i class="fa fa-link"></i></a>OS</h3>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="s2">"platform"</span><span class="o">]</span>
<span class="k">when</span> <span class="s2">"debian"</span><span class="p">,</span> <span class="s2">"ubuntu"</span>
  <span class="c1"># do debian/ubuntu things</span>
<span class="k">when</span> <span class="s2">"redhat"</span><span class="p">,</span> <span class="s2">"centos"</span><span class="p">,</span> <span class="s2">"fedora"</span>
  <span class="c1"># do redhat/centos/fedora things</span>
<span class="k">end</span>
</pre></div></div>

<h3>
<span id="osカテゴリ" class="fragment"></span><a href="#os%E3%82%AB%E3%83%86%E3%82%B4%E3%83%AA"><i class="fa fa-link"></i></a>OSカテゴリ</h3>

<p>xx系で分岐する場合。yumかaptでpackage名が変わったりパスが変わったりするときなどで使う。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="n">node</span><span class="o">[</span><span class="s2">"platform_family"</span><span class="o">]</span>
<span class="k">when</span> <span class="s2">"debian"</span>
  <span class="c1"># do things on debian-ish platforms (debian, ubuntu, linuxmint)</span>
<span class="k">when</span> <span class="s2">"rhel"</span>
  <span class="c1"># do things on RHEL platforms (redhat, centos, scientific, etc)</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="テンポラリファイルのパスを組み立てる" class="fragment"></span><a href="#%E3%83%86%E3%83%B3%E3%83%9D%E3%83%A9%E3%83%AA%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%91%E3%82%B9%E3%82%92%E7%B5%84%E3%81%BF%E7%AB%8B%E3%81%A6%E3%82%8B"><i class="fa fa-link"></i></a>テンポラリファイルのパスを組み立てる</h2>

<p>foodcritic の <a href="http://acrmp.github.io/foodcritic/#FC013" rel="nofollow noopener" target="_blank">FC013</a>で <code>/tmp</code> ではなく <code>Chef::Config[:file_cache_path]</code> を使えとある。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">remote_file</span> <span class="s2">"</span><span class="si">#{</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span><span class="si">}</span><span class="s2">/large-file.tar.gz"</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">"http://www.example.org/large-file.tar.gz"</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="事前に用意した静的ファイルを配置する" class="fragment"></span><a href="#%E4%BA%8B%E5%89%8D%E3%81%AB%E7%94%A8%E6%84%8F%E3%81%97%E3%81%9F%E9%9D%99%E7%9A%84%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>事前に用意した静的ファイルを配置する</h2>

<p><a href="http://docs.opscode.com/resource_cookbook_file.html" rel="nofollow noopener" target="_blank">cookbook_file</a>リソースを使う。</p>

<p>デフォルトではファイルは上書きになる。上書きが困る場合は <code>action: create_if_missing</code> や <code>not_if {File.exist?}</code> などを使う。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="c1"># files/default/testfile</span>
<span class="n">cookbook_file</span> <span class="s2">"/</span><span class="si">#{</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span><span class="si">}</span><span class="s2">/testfile"</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s2">"testfile"</span>
  <span class="n">mode</span> <span class="mo">00644</span>
  <span class="n">owner</span> <span class="s1">'root'</span>
  <span class="n">group</span> <span class="s1">'root'</span>
<span class="k">end</span>
</pre></div></div>

<p>配置する元ファイルは以下の順番で <code>files</code> のサブディレクトリから検索される。</p>

<ol>
<li>ホスト名 <code>host-#{node[:fqdn]}</code>
</li>
<li>OS-フルバージョン <code>#{node[:platform]}-#{node[:platform_version]}</code>
</li>
<li>OS-メジャーバージョン <code>#{node[:platform]}-#{version_components}</code>
</li>
<li>OS <code>node[:platform]</code>
</li>
<li><code>default</code></li>
</ol>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>files/
   host-foo.example.com
   ubuntu-10.04
   ubuntu-10
   ubuntu
   default
</pre></div></div>

<h2>
<span id="テンプレートを使ってファイルを配置する" class="fragment"></span><a href="#%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E9%85%8D%E7%BD%AE%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>テンプレートを使ってファイルを配置する</h2>

<p><a href="http://docs.opscode.com/resource_template.html" rel="nofollow noopener" target="_blank">template</a>リソースを使う。</p>

<p><a href="http://docs.opscode.com/resource_cookbook_file.html" rel="nofollow noopener" target="_blank">cookbook_file</a>リソースとの違いは用意できるファイルがerbテンプレートであり動的に出力を変えられるところ。テンプレートのデフォルトのコンテキストは<code>node</code>オブジェクトで、<code>variables</code>属性で任意のhashをテンプレートに渡すことも可能。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="s2">"/etc/apache2/ports.conf"</span> <span class="k">do</span>
  <span class="n">source</span> <span class="s1">'apache/ports.conf.erb'</span>
  <span class="n">mode</span> <span class="s1">'0644'</span>
<span class="k">end</span>
</pre></div></div>

<p>ソースのテンプレートファイルは <code>files</code> ディレクトリではなく、<code>templates</code> ディレクトリに配置する。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>templates/
   host-foo.example.com
   ubuntu-10.04
   ubuntu-10
   ubuntu
   default
</pre></div></div>

<h2>
<span id="書き換えてしまったファイルの前のバージョンを見る" class="fragment"></span><a href="#%E6%9B%B8%E3%81%8D%E6%8F%9B%E3%81%88%E3%81%A6%E3%81%97%E3%81%BE%E3%81%A3%E3%81%9F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E5%89%8D%E3%81%AE%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%92%E8%A6%8B%E3%82%8B"><i class="fa fa-link"></i></a>書き換えてしまったファイルの前のバージョンを見る</h2>

<p><a href="http://docs.opscode.com/resource_cookbook_file.html" rel="nofollow noopener" target="_blank">cookbook_file</a>リソースや<a href="http://docs.opscode.com/resource_template.html" rel="nofollow noopener" target="_blank">template</a>リソースで既存のファイルを上書きしてしまった場合に世代バックアップが<code>/var/chef/backup</code> にある。</p>

<h2>
<span id="空のファイルを作成する" class="fragment"></span><a href="#%E7%A9%BA%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>空のファイルを作成する</h2>

<p><a href="http://docs.opscode.com/resource_file.html" rel="nofollow noopener" target="_blank">file</a>リソースの<code>: create_if_missing</code>アクションを使う。(ファイルが無い時限定)</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="s2">"/tmp/something"</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:create_if_missing</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="ファイルを削除する" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ファイルを削除する</h2>

<p><a href="http://docs.opscode.com/resource_file.html" rel="nofollow noopener" target="_blank">file</a>リソースを使う。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="s2">"/tmp/something"</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:delete</span>
<span class="k">end</span>
</pre></div></div>

<p>削除対象がシンボリックリンクの場合は警告がでるので、<a href="http://docs.opscode.com/resource_link.html" rel="nofollow noopener" target="_blank">link</a>リソースを使うのがエレガント。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">link</span> <span class="s2">"/tmp/mylink"</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:delete</span>
  <span class="n">only_if</span> <span class="s2">"test -L /tmp/mylink"</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="ディレクトリを作成する" class="fragment"></span><a href="#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ディレクトリを作成する</h2>

<p><a href="http://docs.opscode.com/resource_directory.html" rel="nofollow noopener" target="_blank">directory</a>リソースを使う。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">directory</span> <span class="s2">"/var/lib/foo"</span> <span class="k">do</span>
  <span class="n">owner</span> <span class="s2">"root"</span>
  <span class="n">group</span> <span class="s2">"root"</span>
  <span class="n">mode</span> <span class="mo">00755</span>
  <span class="n">action</span> <span class="ss">:create</span>
<span class="k">end</span>
</pre></div></div>

<p>親ディレクトリが存在しないと失敗する。<code>recursive true</code>をつけると親ディレクトリを再帰的に作成する。</p>

<h2>
<span id="シンボリックリンクを作成する" class="fragment"></span><a href="#%E3%82%B7%E3%83%B3%E3%83%9C%E3%83%AA%E3%83%83%E3%82%AF%E3%83%AA%E3%83%B3%E3%82%AF%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>シンボリックリンクを作成する</h2>

<p><a href="http://docs.opscode.com/resource_link.html" rel="nofollow noopener" target="_blank">link</a>リソースを使う。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">link</span> <span class="s2">"/tmp/passwd"</span> <span class="k">do</span>
  <span class="n">to</span> <span class="s2">"/etc/passwd"</span>
<span class="k">end</span>

<span class="n">link</span> <span class="s2">"/tmp/passwd"</span> <span class="k">do</span>
  <span class="n">to</span> <span class="s2">"/etc/passwd"</span>
  <span class="n">link_type</span> <span class="ss">:hard</span>
<span class="k">end</span>

<span class="n">link</span> <span class="s2">"/tmp/mylink"</span> <span class="k">do</span>
  <span class="n">action</span> <span class="ss">:delete</span>
  <span class="n">only_if</span> <span class="s2">"test -L /tmp/mylink"</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="ファイルがなければリソースを実行する" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%8C%E3%81%AA%E3%81%91%E3%82%8C%E3%81%B0%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ファイルがなければリソースを実行する</h2>

<p><code>not_if</code>でファイルをチェックする。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">execute</span> <span class="s2">"create file hoge"</span> <span class="k">do</span>
  <span class="n">command</span> <span class="s2">"touch /tmp/hoge"</span>
  <span class="n">not_if</span> <span class="p">{</span><span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="s2">"/tmp/hoge"</span><span class="p">)}</span>
<span class="k">end</span>
</pre></div></div>

<p><code>Dir.exist?</code> も使える(rubyの世界)</p>

<h2>
<span id="コマンドを実行する" class="fragment"></span><a href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>コマンドを実行する</h2>

<p><a href="http://docs.getchef.com/resource_execute.html" rel="nofollow noopener" target="_blank">execute</a>リソースを使う。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">execute</span> <span class="s1">'bundle install'</span> <span class="k">do</span>
  <span class="n">cwd</span> <span class="s1">'/myapp'</span>
  <span class="n">not_if</span> <span class="s1">'bundle check'</span> <span class="c1"># This is not run inside /myapp</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="シェルファイルを実行する" class="fragment"></span><a href="#%E3%82%B7%E3%82%A7%E3%83%AB%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>シェルファイルを実行する</h2>

<p>正確には以下の例は<a href="http://docs.opscode.com/resource_bash.html" rel="nofollow noopener" target="_blank">bash</a>リソースからコマンドを実行。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="s2">"install_ruby_build"</span> <span class="k">do</span>
  <span class="n">cwd</span> <span class="s2">"</span><span class="si">#{</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="ss">:file_cache_path</span><span class="o">]</span><span class="si">}</span><span class="s2">/ruby-build"</span>
  <span class="n">user</span> <span class="s2">"rbenv"</span>
  <span class="n">group</span> <span class="s2">"rbenv"</span>
  <span class="n">code</span> <span class="o">&lt;&lt;-</span><span class="dl">EOH</span>
<span class="sh">    ./install.sh</span>
<span class="dl">  EOH</span>
  <span class="n">environment</span> <span class="s1">'PREFIX'</span> <span class="o">=&gt;</span> <span class="s2">"/usr/local"</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="gitリポジトリからファイルを取得する" class="fragment"></span><a href="#git%E3%83%AA%E3%83%9D%E3%82%B8%E3%83%88%E3%83%AA%E3%81%8B%E3%82%89%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Gitリポジトリからファイルを取得する</h2>

<p><a href="http://docs.opscode.com/resource_git.html" rel="nofollow noopener" target="_blank">git</a>リソースを使う。<code>revision</code>属性にタグなどを指定できる。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="s2">"/home/</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span><span class="si">}</span><span class="s2">/redmine"</span>  <span class="k">do</span>
  <span class="n">repository</span> <span class="s2">"git://github.com/edavis10/redmine.git"</span>
  <span class="n">revision</span> <span class="s1">'2.5.1'</span>
  <span class="n">user</span> <span class="n">node</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span>
  <span class="n">group</span> <span class="n">node</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="ウェブにあるアーカイブファイルを展開する" class="fragment"></span><a href="#%E3%82%A6%E3%82%A7%E3%83%96%E3%81%AB%E3%81%82%E3%82%8B%E3%82%A2%E3%83%BC%E3%82%AB%E3%82%A4%E3%83%96%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%B1%95%E9%96%8B%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ウェブにあるアーカイブファイルを展開する</h2>

<p><a href="http://docs.opscode.com/resource_remote_file.html" rel="nofollow noopener" target="_blank">remote_file</a>リソースでダウンロード。<a href="http://docs.opscode.com/resource_bash.html" rel="nofollow noopener" target="_blank">bash</a>リソースで展開。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="c1">#  the following code sample is similar to the ``upload_progress_module`` recipe in the ``nginx`` cookbook: https://github.com/opscode-cookbooks/nginx</span>

<span class="n">src_filename</span> <span class="o">=</span> <span class="s2">"foo123-nginx-module-v</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">'nginx'</span><span class="o">][</span><span class="s1">'foo123'</span><span class="o">][</span><span class="s1">'version'</span><span class="o">]</span><span class="si">}</span><span class="s2">.tar.gz"</span>
<span class="n">src_filepath</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="s1">'file_cache_path'</span><span class="o">]</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">src_filename</span><span class="si">}</span><span class="s2">"</span>
<span class="n">extract_path</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="no">Chef</span><span class="o">::</span><span class="no">Config</span><span class="o">[</span><span class="s1">'file_cache_path'</span><span class="o">]</span><span class="si">}</span><span class="s2">/nginx_foo123_module/</span><span class="si">#{</span><span class="n">node</span><span class="o">[</span><span class="s1">'nginx'</span><span class="o">][</span><span class="s1">'foo123'</span><span class="o">][</span><span class="s1">'checksum'</span><span class="o">]</span><span class="si">}</span><span class="s2">"</span>

<span class="n">remote_file</span> <span class="n">src_filepath</span> <span class="k">do</span>
  <span class="n">source</span> <span class="n">node</span><span class="o">[</span><span class="s1">'nginx'</span><span class="o">][</span><span class="s1">'foo123'</span><span class="o">][</span><span class="s1">'url'</span><span class="o">]</span>
  <span class="n">checksum</span> <span class="n">node</span><span class="o">[</span><span class="s1">'nginx'</span><span class="o">][</span><span class="s1">'foo123'</span><span class="o">][</span><span class="s1">'checksum'</span><span class="o">]</span>
  <span class="n">owner</span> <span class="s1">'root'</span>
  <span class="n">group</span> <span class="s1">'root'</span>
  <span class="n">mode</span> <span class="mo">00644</span>
<span class="k">end</span>

<span class="n">bash</span> <span class="s1">'extract_module'</span> <span class="k">do</span>
  <span class="n">cwd</span> <span class="o">::</span><span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">src_filepath</span><span class="p">)</span>
  <span class="n">code</span> <span class="o">&lt;&lt;-</span><span class="dl">EOH</span>
<span class="sh">    mkdir -p #{extract_path}</span>
<span class="sh">    tar xzf #{src_filename} -C #{extract_path}</span>
<span class="sh">    mv #{extract_path}/*/* #{extract_path}/</span>
<span class="dl">    EOH</span>
  <span class="n">not_if</span> <span class="p">{</span> <span class="o">::</span><span class="no">File</span><span class="o">.</span><span class="n">exist?</span><span class="p">(</span><span class="n">extract_path</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="hostsファイルにエントリを追加する" class="fragment"></span><a href="#hosts%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AA%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>hostsファイルにエントリを追加する</h2>

<p><code>hostsfile</code> cookbook を追加し、<a href="https://github.com/customink-webops/hostsfile" rel="nofollow noopener" target="_blank">hostsfile_entry</a> リソースを使う。</p>

<div class="code-frame" data-lang="ruby"><div class="highlight"><pre><span></span><span class="n">hostsfile_entry</span> <span class="s1">'1.2.3.4'</span> <span class="k">do</span>
  <span class="n">hostname</span>  <span class="s1">'www2.example.com'</span>
  <span class="n">aliases</span>   <span class="o">[</span><span class="s1">'foo.com'</span><span class="p">,</span> <span class="s1">'foobar.com'</span><span class="o">]</span>
  <span class="n">comment</span>   <span class="s1">'Append by Recipe X'</span>
  <span class="n">action</span>    <span class="ss">:append</span>
<span class="k">end</span>
</pre></div></div>

<h2>
<span id="ファイルを置き換えたのでサービスを再起動する" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E7%BD%AE%E3%81%8D%E6%8F%9B%E3%81%88%E3%81%9F%E3%81%AE%E3%81%A7%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%82%92%E5%86%8D%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ファイルを置き換えたのでサービスを再起動する</h2>

<p><a href="http://docs.getchef.com/resource_common.html#notifications" rel="nofollow noopener" target="_blank">Notifications</a>を使う。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>template '/etc/httpd/conf/httpd.conf' do
  source 'httpd/httpd.conf.erb'
  notifies :restart, 'service[httpd]'
end
service 'httpd' do
  action [ :enable ]
end
</pre></div></div>

<p><code>notifies</code>で指定するリソース名が存在しないといけないので <a href="http://docs.getchef.com/resource_service.html" rel="nofollow noopener" target="_blank">service</a>リソースで <code>:enable</code> や <code>:nothing</code>などのActionで記述しておく。</p>

<h2>
<span id="ohaiで取得して使える属性" class="fragment"></span><a href="#ohai%E3%81%A7%E5%8F%96%E5%BE%97%E3%81%97%E3%81%A6%E4%BD%BF%E3%81%88%E3%82%8B%E5%B1%9E%E6%80%A7"><i class="fa fa-link"></i></a>Ohaiで取得して使える属性</h2>

<table>
<thead>
<tr>
<th style="text-align: left">属性</th>
<th style="text-align: left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">node['platform']</td>
<td style="text-align: left">nodeのプラットフォーム</td>
</tr>
<tr>
<td style="text-align: left">node['platform_version']</td>
<td style="text-align: left">プラットフォームのバージョン</td>
</tr>
<tr>
<td style="text-align: left">node['ipaddress']</td>
<td style="text-align: left">IPアドレス。nodeがデフォルトルートを持っている場合はIPv4アドレス、もっていない場合はnil</td>
</tr>
<tr>
<td style="text-align: left">node['macaddress']</td>
<td style="text-align: left">MACアドレス</td>
</tr>
<tr>
<td style="text-align: left">node['fqdn']</td>
<td style="text-align: left">完全修飾ドメイン名</td>
</tr>
<tr>
<td style="text-align: left">node['hostname']</td>
<td style="text-align: left">ホスト名</td>
</tr>
<tr>
<td style="text-align: left">node['domain']</td>
<td style="text-align: left">ドメイン</td>
</tr>
<tr>
<td style="text-align: left">node['recipes']</td>
<td style="text-align: left">関連付けられたレシピのリスト</td>
</tr>
<tr>
<td style="text-align: left">node['roles']</td>
<td style="text-align: left">関連付けられたroleのリスト</td>
</tr>
<tr>
<td style="text-align: left">node['ohai_time']</td>
<td style="text-align: left">Ohaiが最後に実行された時刻。knife statusサブコマンドでサーバに保存し参照できる</td>
</tr>
</tbody>
</table>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />6位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>224</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/cc73b628c9ef039f6e6f">rbenvでRubyのバージョンを指定する方法</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-03-11 11:32:10</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>rvmからrbenvに切り替えてみたのでrbenvがどういう方法でRubyバージョンを指定したり、状況によって切り替えることができるのか確認してみた。基本 <a href="https://github.com/sstephenson/rbenv/" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/sstephenson/rbenv/</a> の要約および動作確認、バージョンは0.4.0。</p>

<h2>
<span id="shims" class="fragment"></span><a href="#shims"><i class="fa fa-link"></i></a>shims</h2>

<p>~/.rbenv/shimsにあるスクリプトが使うコマンド(irb, gem, rake, rails, rubyなど)を振り分けてくれる。shimsが振り分けた先を知るには<code>rbenv which</code>を使う。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv which ruby
~/.rbenv/versions/1.9.3-p392/bin/ruby
</pre></div></div>

<p><strong>bundle</strong>などgemでインストールして新しいコマンドが増える場合は~/.rbenv/shimsに振り分けるスクリプトを置かないといけないので<code>rbenv rehash</code>を唱える必要がある。</p>

<h2>
<span id="rbenv_version" class="fragment"></span><a href="#rbenv_version"><i class="fa fa-link"></i></a>RBENV_VERSION</h2>

<p>ドキュメントによると <strong>RBENV_VERSION</strong> 環境変数が使うバージョンを決める。従ってコマンドラインからだと以下で切り替えられる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ export RBENV_VERSION=1.9.3-p392
$ ruby -v
ruby 1.9.3p392 ...
</pre></div></div>

<h2>
<span id="globallocalshell" class="fragment"></span><a href="#globallocalshell"><i class="fa fa-link"></i></a>global/local/shell</h2>

<p>実際のところRBENV_VERSIONは直接意識しなくてもいいようになっている。</p>

<p>使うデフォルトのバージョンを固定したい場合は <strong>global</strong> を使う。すると <em>~/.rbenv/version</em> に使うバージョンが書き込まれる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv global 1.9.3-p392
</pre></div></div>

<p>プロジェクトで特定のバージョンを使いたいときは、 <strong>local</strong> を使う。すると、カレントディレクトリの <em>.ruby-version</em> に使うバージョンが書き込まれる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv local 1.8.7-p371
</pre></div></div>

<p>コマンドラインから一時的に切り替えたい場合は <strong>shell</strong> を使う。すると、環境変数 <em>RBENV_VERSION</em> に設定される。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv shell 2.0.0-p0
</pre></div></div>

<p>localおよびshellに指定したバージョンは--unsetオプションにより取り消せる(globalは取り消せなかった、後述のsystemに戻すことで代用できる)。なおlocalの場合は <em>.ruby-version</em> ファイルが削除される。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv local --unset
$ rbenv shell --unset
</pre></div></div>

<p>念のため実験したところ優先順位はちゃんとshell &gt; local &gt; globalの順で適応された。つまりは 環境変数 <em>RBENV_VERSION</em> &gt; カレントディレクトリの <em>.ruby-version</em> &gt; <em>~/.rbenv/version</em> の順に優先されることになる。</p>

<h2>
<span id="system" class="fragment"></span><a href="#system"><i class="fa fa-link"></i></a>system</h2>

<p>ディストリビューションなどで例えば/usr/bin/rubyにRubyがインストールされていることがある。こういったRubyは <strong>system</strong> というキーワードで指定することができる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ rbenv shell system
$ rbenv local system
$ rbenv global system
</pre></div></div>

<p><code>rbenv global --unset</code>の代わりとして<code>rbenv global system</code>が利用できる。</p>

<h2>
<span id="古いrbenv-version" class="fragment"></span><a href="#%E5%8F%A4%E3%81%84rbenv-version"><i class="fa fa-link"></i></a>古い.rbenv-version</h2>

<p>互換性のために.rbenv-versionから.ruby-versionを使うようになっている。</p>

<ul>
<li>.rbenv-versionと.ruby-versionの両方が存在する場合

<ul>
<li>.ruby-versionが優先される</li>
<li>
<code>rbenv local</code>使った場合は.ruby-versionのみ更新される</li>
<li>
<code>rbenv local --unset</code>使った場合は.ruby-versionも.rbenv-versoinも削除される</li>
</ul>
</li>
<li>.rbenv-versionだけがある場合

<ul>
<li>
<code>rbenv local</code>を実行すると.rbenv-versionが削除され.ruby-versionが作成される。</li>
<li>
<code>rbenv local --unset</code>使った場合は.rbenv-versoinが削除される。</li>
</ul>
</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />7位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>212</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/5a99e37f7172337ae4be">iOSアプリ未インストール時にSafariでカスタムURLスキームを開く時の対策</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-03-04 15:07:13</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> <b>[Safari]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>iOSアプリケーションにカスタムURLスキームを実装し、SafariからそのURLを開く際にまだユーザがそのアプリケーションをインストールしていなければそのURLを開けずにページエラーになってしまう。その場合はアプリケーションをインストールする導線を張りたい。</p>

<h2>
<span id="対策1" class="fragment"></span><a href="#%E5%AF%BE%E7%AD%961"><i class="fa fa-link"></i></a>対策1</h2>

<p>workaroundとして以下のhackがある。</p>

<div class="code-frame" data-lang="javascript"><div class="highlight"><pre><span></span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">"http://itunes.com/apps/yourappname"</span><span class="p">;</span>
<span class="p">},</span> <span class="mi">25</span><span class="p">);</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">"custom-uri://"</span><span class="p">;</span>
</pre></div></div>

<h3>
<span id="hack1の説明" class="fragment"></span><a href="#hack1%E3%81%AE%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>hack1の説明</h3>

<p>window.locationにてカスタムURLスキームを設定し、そのURLに対応したアプリケーションがない場合（Safari自身も対応していない場合）、<code>window.location = "custom-uri://"</code> の処理で画面遷移はせず、Safariは現在のページにとどまるためsetTimeoutがすぐ処理され、<code>window.location = "http://itunes.com/apps/yourappname"</code> によりStoreへ飛ばすコードが実行される。</p>

<p>これによりアプリがインストールしていない場合にStoreに飛ばすということが実現できる。</p>

<h3>
<span id="hack2の説明" class="fragment"></span><a href="#hack2%E3%81%AE%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>hack2の説明</h3>

<p>SafariはURL ( <code>custom-uri://</code> ) を開くアプリケーションが見つからない場合にAlertを表示する。</p>

<p>Alertを表示後にさらに別のアプリケーション(上記の例ではApp Storeアプリが <code>http://itunes.com/apps/yourappname</code> をハンドリング)で開けるカスタムURLスキームを開くと、SafariがAlertを消す動きを見せるため、25msのような短い間隔であればユーザにAlertを見せないように振る舞うことができる。</p>

<p>逆にsetTimeoutで開くページがSafariで扱えるウェブページの場合Alertはキャンセルされず残ったままになるようだった。そのためApp Storeの前に自前のヘルプページを挟みたいという要件があるとsetTimeoutの間隔を短くするこのhackは使えずにAlertが残ったままになる。</p>

<h3>
<span id="対策1の問題点" class="fragment"></span><a href="#%E5%AF%BE%E7%AD%961%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9"><i class="fa fa-link"></i></a>対策1の問題点</h3>

<p>カスタムURLスキーム ( <code>custom-uri://</code> )  を実装したアプリケーションがインストール済みの場合のフローが問題になる。</p>

<p>インストール済みならURL ( <code>custom-uri://</code> ) をそのアプリケーションがフォラグランドになって処理を行うが、setTimeoutの処理はキャンセルされないので、ユーザがSafariに戻ったときにインストール済みにもかかわらず毎回 <code>window.location = "http://itunes.com/apps/yourappname";</code> が実行されストアのページが開れてしまうという問題が起きる。</p>

<h2>
<span id="対策2" class="fragment"></span><a href="#%E5%AF%BE%E7%AD%962"><i class="fa fa-link"></i></a>対策2</h2>

<p>対策1の問題点を回避するworkaroundとして時刻をチェックするというhackがある。</p>

<div class="code-frame" data-lang="javascript"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">checkedAt</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
<span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="o">-</span> <span class="nx">checkedAt</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">t</span> <span class="o">&lt;</span> <span class="mi">2000</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">"http://itunes.com/apps/yourappname"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">"custom-uri://"</span><span class="p">;</span>
</pre></div></div>

<h3>
<span id="hack3の説明" class="fragment"></span><a href="#hack3%E3%81%AE%E8%AA%AC%E6%98%8E"><i class="fa fa-link"></i></a>hack3の説明</h3>

<p>アプリケーションがURLを開いてフォラグランドになれば当然Safariがバックグランドに回るためSafariの実行が停止し、すぐにはsetTimeoutの処理は実行されない。</p>

<p>Safariに戻ったあとにこのsetTimeoutが実行されるがこの時には時間が経っているのでsetTimeout内で時刻をチェックすれば、インストール済みのフローではApp StoreのURLを開かないようにできる。</p>

<p>iPhone 4Sで試したところ500msくらいであればSafariがバックグランドに入る前にsetTimeoutが実行されてしまったので、1000msにしてみたがこの辺りはタイミング次第なので調整が必要かもしれない。</p>

<h3>
<span id="対策2の問題点" class="fragment"></span><a href="#%E5%AF%BE%E7%AD%962%E3%81%AE%E5%95%8F%E9%A1%8C%E7%82%B9"><i class="fa fa-link"></i></a>対策2の問題点</h3>

<p>対策1のhack2が使えないということになる。対策1のhack2ではアプリケーション未インストール時に表示されるAlertをsetTimeoutを25msにすることで即座にキャンセルしていたが、この対策を使うと1000msなのでその間1秒間ユーザにAlertを見せてしまうことになる。</p>

<h2>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h2>

<p>今のところこれ以外のworkaroundを知らないため全ての解決方法がわからない。対策1と対策2の問題を比較した場合、インストール前のフロー問題とインストール後のフローの問題のどちらに優先度を置くかによって判断が変わる。</p>

<p>個人的にはインストール前にちょっとAlertが表示されることよりも、インストール後に毎回ストアに遷移してしまうほうが問題だと感じているので対策2を選ぶのがよいと考えている。</p>

<h2>
<span id="参考にしたもの" class="fragment"></span><a href="#%E5%8F%82%E8%80%83%E3%81%AB%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE"><i class="fa fa-link"></i></a>参考にしたもの</h2>

<ul>
<li>Stack Overflow - <a href="http://stackoverflow.com/questions/1108693/is-it-possible-to-register-a-httpdomain-based-url-scheme-for-iphone-apps-like/1109200#1109200" rel="nofollow noopener" target="_blank">Is it possible to register a http+domain-based URL Scheme for iPhone apps, like YouTube and Maps?</a>
</li>
<li>Stack Overflow - <a href="http://stackoverflow.com/questions/627916/iphone-safari-check-if-url-scheme-is-supported-in-javascript" rel="nofollow noopener" target="_blank">iPhone Safari: check if URL scheme is supported in javascript?</a>
</li>
<li>Safari Developer Guide - <a href="http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html" rel="nofollow noopener" target="_blank">Safari Web Content Guide: Handling Events</a>
</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />8位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>124</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/d86fada0e38e9245912a">Modern Objective-C ビフォーアフター </a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-03-13 11:45:37</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>Adopting Modern Objective-Cより</p>

<h2>
<span id="instancetype" class="fragment"></span><a href="#instancetype"><i class="fa fa-link"></i></a>instancetype</h2>

<p><code>instancetype</code> の方がコンパイラのチェックがきく。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">MyObject</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">myFactoryMethod</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">MyObject</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">myFactoryMethod</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>

<h2>
<span id="enumeration-macros" class="fragment"></span><a href="#enumeration-macros"><i class="fa fa-link"></i></a>￼Enumeration Macros</h2>

<p>iOS6 SDKから追加されたマクロ。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">enum</span> <span class="p">{</span>
    <span class="n">UITableViewCellStyleDefault</span><span class="p">,</span>
    <span class="n">UITableViewCellStyleValue1</span><span class="p">,</span>
    <span class="n">UITableViewCellStyleValue2</span><span class="p">,</span>
    <span class="n">UITableViewCellStyleSubtitle</span>
<span class="p">};</span>
<span class="k">typedef</span> <span class="n">NSInteger</span> <span class="n">UITableViewCellStyle</span><span class="p">;</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">NS_ENUM</span><span class="p">(</span><span class="n">NSInteger</span><span class="p">,</span> <span class="n">UITableViewCellStyle</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">UITableViewCellStyleDefault</span><span class="p">,</span>
    <span class="n">UITableViewCellStyleValue1</span><span class="p">,</span>
    <span class="n">UITableViewCellStyleValue2</span><span class="p">,</span>
    <span class="n">UITableViewCellStyleSubtitle</span>
<span class="p">};</span>
</pre></div>
</div>

<p>bitmaskは <code>NS_OPTIONS</code> を使う</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">enum</span> <span class="p">{</span>
    <span class="n">UIViewAutoresizingNone</span>                 <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleLeftMargin</span>   <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleWidth</span>        <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleRightMargin</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleTopMargin</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleHeight</span>       <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleBottomMargin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span>
<span class="p">};</span><span class="k">typedef</span> <span class="n">NSUInteger</span> <span class="n">UIViewAutoresizing</span><span class="p">;</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">NS_OPTIONS</span><span class="p">(</span><span class="n">NSUInteger</span><span class="p">,</span> <span class="n">UIViewAutoresizing</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">UIViewAutoresizingNone</span>                 <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleLeftMargin</span>   <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleWidth</span>        <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleRightMargin</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleTopMargin</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleHeight</span>       <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">UIViewAutoresizingFlexibleBottomMargin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">};</span>
</pre></div>
</div>

<hr>

<p>Migrating to Modern Objective-Cより</p>

<h2>
<span id="importing-headers" class="fragment"></span><a href="#importing-headers"><i class="fa fa-link"></i></a>￼Importing Headers</h2>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="cp">#import &lt;Foundation/NSObject.h&gt;</span>
<span class="cp">#import &lt;Foundation/NSString.h&gt; </span><span class="c1">//or @class NSString;</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="cp">#import &lt;Foundation/Foundation.h&gt;</span>
</pre></div>
</div>

<p>--</p>

<h2>
<span id="accessor-methods" class="fragment"></span><a href="#accessor-methods"><i class="fa fa-link"></i></a>￼Accessor Methods</h2>

<p>常にアクセサメソッドを使おう。ただしinitializerやdealloc内は除く。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">myMethod</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="p">[</span><span class="nb">self</span> <span class="nl">setTitle</span><span class="p">:[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@"Area: %1.2f"</span><span class="p">,</span> <span class="p">[</span><span class="nb">self</span> <span class="n">area</span><span class="p">]]];</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">myMethod</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nb">self</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSString</span> <span class="nl">stringWithFormat</span><span class="p">:</span><span class="s">@"Area: %1.2f"</span><span class="p">,</span> <span class="nb">self</span><span class="p">.</span><span class="n">area</span><span class="p">];</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>

<p>--</p>

<h2>
<span id="memory-management" class="fragment"></span><a href="#memory-management"><i class="fa fa-link"></i></a>￼Memory Management</h2>

<p>ARCを使う。ARCはXcode 4.2(LLVM compiler 3.0)からサポート、一部の動作がコンパイラだけで解決できないためiOS5以上が必要になる。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSMutableArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSMutableArray</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
<span class="c1">// Use the array</span>
<span class="p">[</span><span class="n">array</span> <span class="k">release</span><span class="p">];</span>

<span class="c1">// or </span>

<span class="bp">NSMutableArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">[[[</span><span class="bp">NSMutableArray</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">]</span> <span class="n">autoelease</span><span class="p">];</span>
<span class="c1">// Use the array</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSMutableArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSMutableArray</span> <span class="n">array</span><span class="p">];</span>
<span class="c1">// Use the array</span>
</pre></div>
</div>

<p>--</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="kt">id</span> <span class="n">heisenObject</span> <span class="o">=</span> <span class="p">[[</span><span class="n">array</span> <span class="nl">objectAtIndex</span><span class="p">:</span><span class="n">n</span><span class="p">]</span> <span class="k">retain</span><span class="p">];</span>
<span class="p">[</span><span class="n">array</span> <span class="nl">removeObjectAtIndex</span><span class="p">:</span><span class="n">n</span><span class="p">];</span>
<span class="c1">// ...</span>
<span class="p">[</span><span class="n">heisenObject</span> <span class="n">doSomething</span><span class="p">];</span>
<span class="p">[</span><span class="n">heisenObject</span> <span class="k">release</span><span class="p">];</span>
<span class="c1">// ...</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="kt">id</span> <span class="n">heisenObject</span> <span class="o">=</span> <span class="p">[</span><span class="n">array</span> <span class="nl">objectAtIndex</span><span class="p">:</span><span class="n">n</span><span class="p">];</span>
<span class="p">[</span><span class="n">array</span> <span class="nl">removeObjectAtIndex</span><span class="p">:</span><span class="n">n</span><span class="p">];</span>
<span class="c1">// ...</span>
<span class="p">[</span><span class="n">heisenObject</span> <span class="n">doSomething</span><span class="p">];</span>
<span class="c1">// ...</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">takeLastNameFrom:</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="p">)</span><span class="nv">person</span> <span class="p">{</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">oldLastname</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">self</span> <span class="n">lastName</span><span class="p">]</span> <span class="k">retain</span><span class="p">];</span>
    <span class="p">[</span><span class="nb">self</span> <span class="nl">setLastName</span><span class="p">:[</span><span class="n">person</span> <span class="n">lastName</span><span class="p">]];</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Lastname changed from %@ to %@"</span><span class="p">,</span> <span class="n">oldLastname</span><span class="p">,</span> <span class="p">[</span><span class="nb">self</span> <span class="n">lastName</span><span class="p">]);</span>
    <span class="p">[</span><span class="n">oldLastName</span> <span class="k">release</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">takeLastNameFrom:</span><span class="p">(</span><span class="n">Person</span> <span class="o">*</span><span class="p">)</span><span class="nv">person</span> <span class="p">{</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">oldLastname</span> <span class="o">=</span> <span class="p">[</span><span class="nb">self</span> <span class="n">lastName</span><span class="p">];</span>
    <span class="p">[</span><span class="nb">self</span> <span class="nl">setLastName</span><span class="p">:[</span><span class="n">person</span> <span class="n">lastName</span><span class="p">]];</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Lastname changed from %@ to %@"</span><span class="p">,</span> <span class="n">oldLastname</span><span class="p">,</span> <span class="p">[</span><span class="nb">self</span> <span class="n">lastName</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>

<p>--</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="n">CFUUIDRef</span> <span class="n">cfUUID</span> <span class="o">=</span> <span class="n">CFUUIDCreate</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">noteUUID</span> <span class="o">=</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">CFUUIDCreateString</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">cfUUID</span><span class="p">);</span>
<span class="n">CFRelease</span><span class="p">(</span><span class="n">cfUUID</span><span class="p">);</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="n">CFUUIDRef</span> <span class="n">cfUUID</span> <span class="o">=</span> <span class="n">CFUUIDCreate</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">noteUUID</span> <span class="o">=</span> <span class="p">(</span><span class="k">__bridge_transfer</span> <span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">CFUUIDCreateString</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">cfUUID</span><span class="p">);</span>
<span class="n">CFRelease</span><span class="p">(</span><span class="n">cfUUID</span><span class="p">);</span>
</pre></div>
</div>

<p>--</p>

<h2>
<span id="properties" class="fragment"></span><a href="#properties"><i class="fa fa-link"></i></a>Properties</h2>

<p><code>property</code>宣言、実装では<code>synthesize</code>を使う。インスタンス変数に直接アクセスしたい場合は<code>@synthesize title = _title;</code>にして_title変数を使う。この時_titleは宣言しなくてもコンパイラが解決する。また<code>@synthesize</code>自体を省略することも可能(Xcode 4.4 - Apple LLVM 4.0 Compilerから)。</p>

<p>一つの考え方として変数 <code>_title</code> を参照用、プロパティ <code>self.title = ...</code> (setter) を更新用に使うという方法がある。（initializerやdeallocは除く)</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> : <span class="bp">NSObject</span> <span class="p">{</span>
  <span class="bp">NSString</span> <span class="o">*</span><span class="n">title</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">title</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setTitle:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">newTitle</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">Thing</span>
<span class="p">-</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">title</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">title</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setTitle:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">newTitle</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">title</span> <span class="o">!=</span> <span class="n">newTitle</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">title</span> <span class="k">release</span><span class="p">];</span>
        <span class="n">title</span> <span class="o">=</span> <span class="p">[</span><span class="n">newTitle</span> <span class="k">copy</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> : <span class="bp">NSObject</span> 
<span class="k">@property</span> <span class="p">(</span><span class="k">copy</span><span class="p">)</span> <span class="bp">NSString</span> <span class="o">*</span><span class="n">title</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">Thing</span>
<span class="k">@synthesize</span> <span class="n">title</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> : <span class="bp">NSObject</span> <span class="p">{</span>
    <span class="kt">float</span> <span class="n">radius</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nf">radius</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setRadius:</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nv">newValue</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nf">area</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">Thing</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nf">radius</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">radius</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setRadius:</span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nv">newValue</span> <span class="p">{</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">newValue</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nf">area</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">M_PI</span> <span class="o">*</span> <span class="n">pow</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> : <span class="bp">NSObject</span>
<span class="k">@property</span> <span class="kt">float</span> <span class="n">radius</span><span class="p">;</span>
<span class="k">@property</span> <span class="p">(</span><span class="k">readonly</span><span class="p">,</span> <span class="k">nonatomic</span><span class="p">)</span> <span class="kt">float</span> <span class="n">area</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">Thing</span>
<span class="k">@synthesize</span> <span class="n">radius</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="nf">area</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">M_PI</span> <span class="o">*</span> <span class="n">pow</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">radius</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="p">;}</span>
<span class="k">@end</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> : <span class="bp">NSObject</span> <span class="p">{</span>
    <span class="kt">id</span> <span class="n">delegate</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">delegate</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setDelegate:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">newDelegate</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">Thing</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">delegate</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">delegate</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setDelegate:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">newDelegate</span> <span class="p">{</span>
    <span class="n">delegate</span> <span class="o">=</span> <span class="n">newDelegate</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> : <span class="bp">NSObject</span>
<span class="k">@property</span> <span class="p">(</span><span class="k">weak</span><span class="p">)</span> <span class="kt">id</span> <span class="n">delegate</span><span class="p">;</span>
<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">Thing</span>
<span class="k">@synthesize</span> <span class="n">delegate</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>

<h2>
<span id="private-state" class="fragment"></span><a href="#private-state"><i class="fa fa-link"></i></a>￼Private State</h2>

<p>非公開な変数はクラスエクステンション内でpropertyとして宣言する。メソッドも同様にクラスエクステンションを使う。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> <span class="p">{</span>
   <span class="kt">BOOL</span> <span class="n">privateTest</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> <span class="p">()</span>
<span class="k">@property</span> <span class="kt">BOOL</span> <span class="n">privateTest</span><span class="p">;</span>
<span class="k">@end</span>
<span class="c1">// ...</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> <span class="nl">(PrivateMethods)</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">doSomethingPrivate</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">doSomethingElsePrivate</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">Thing</span> <span class="p">()</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">doSomethingPrivate</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">doSomethingElsePrivate</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>

<h2>
<span id="outlets" class="fragment"></span><a href="#outlets"><i class="fa fa-link"></i></a>Outlets</h2>

<p>メモリ管理のためにstrongかweakかをproperty宣言する。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">MyViewController</span> : <span class="nc">MySuperclass</span> <span class="p">{</span>
    <span class="kt">IBOutlet</span> <span class="n">ElementClass</span> <span class="o">*</span><span class="n">uiElement</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">@end</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@interface</span> <span class="nc">MyViewController</span> : <span class="nc">MySuperclass</span>
<span class="k">@property</span> <span class="p">(</span><span class="k">weak</span><span class="p">)</span> <span class="kt">IBOutlet</span> <span class="n">ElementClass</span> <span class="o">*</span><span class="n">uiElement</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>

<h2>
<span id="initializer-methods-and-dealloc" class="fragment"></span><a href="#initializer-methods-and-dealloc"><i class="fa fa-link"></i></a>￼Initializer Methods and dealloc</h2>

<p>初期化と解放はアクセサじゃなくて変数で。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">init</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">self</span> <span class="o">=</span> <span class="p">[</span><span class="nb">super</span> <span class="n">init</span><span class="p">])</span> <span class="p">{</span>
        <span class="p">[</span><span class="nb">self</span> <span class="nl">setTitle</span><span class="p">:</span><span class="s">@"default"</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">init</span> <span class="p">{</span>
    <span class="nb">self</span> <span class="o">=</span> <span class="p">[</span><span class="nb">super</span> <span class="n">init</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_title</span> <span class="o">=</span> <span class="s">@"default"</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">self</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">dealloc</span> <span class="p">{</span>
    <span class="p">[</span><span class="nb">self</span> <span class="nl">setTitle</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">dealloc</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">dealloc</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">_title</span> <span class="k">release</span><span class="p">];</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">dealloc</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>

<h2>
<span id="protocols" class="fragment"></span><a href="#protocols"><i class="fa fa-link"></i></a>Protocols</h2>

<p>必須ではない実装していないメソッドがあるためにidをそのまま使ったりせずにoptional宣言を使ってid型にもちゃんとprotocolを指定する。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="p">@</span><span class="n">ButlerProtocol</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">makeTea</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">serveSandwiches</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">mowTheLawn</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@protocol</span> <span class="nc">ButlerProtocol</span> <span class="o">&lt;</span><span class="bp">NSObject</span><span class="o">&gt;</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">makeTea</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">serveSandwiches</span><span class="p">;</span>
<span class="k">@optional</span>
<span class="o">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">mowTheLawn</span><span class="p">;</span><span class="k">@end</span>
</pre></div>
</div>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">id</span> <span class="o">&lt;</span><span class="n">ButlerProtocol</span><span class="o">&gt;</span><span class="p">)</span><span class="nf">butler</span><span class="p">;</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="k">@property</span> <span class="kt">id</span> <span class="o">&lt;</span><span class="n">ButlerProtocol</span><span class="o">&gt;</span> <span class="n">butler</span><span class="p">;</span>
</pre></div>
</div>

<h2>
<span id="collections-and-literals" class="fragment"></span><a href="#collections-and-literals"><i class="fa fa-link"></i></a>￼Collections and Literals</h2>

<p><code>@</code> リテラルシンタックス と <code>[]</code> 添字シンタックスはXcode 4.4(Apple LLVM 4.0 Compiler)でサポートされたがiOSで使えるようになったのはXcode4.5から。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSNumber</span> <span class="o">*</span><span class="n">aNumber</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithFloat</span><span class="p">:</span><span class="mf">2.3</span><span class="p">];</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSNumber</span> <span class="o">*</span><span class="n">aNumber</span> <span class="o">=</span> <span class="mf">@2.3f</span><span class="p">;</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSNumber</span> <span class="o">*</span><span class="n">anotherNumber</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithFloat</span><span class="p">:</span><span class="n">x</span><span class="p">];</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSNumber</span> <span class="o">*</span><span class="n">anotherNumber</span> <span class="o">=</span> <span class="l">@(</span><span class="n">x</span><span class="l">)</span><span class="p">;</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">anArray</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSArray</span> <span class="nl">arrayWithObjects</span><span class="p">:</span><span class="n">aThing</span><span class="p">,</span> <span class="s">@"A String"</span><span class="p">,</span>
                       <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithFloat</span><span class="p">:</span><span class="mf">3.14</span><span class="p">],</span> <span class="nb">nil</span><span class="p">];</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">anArray</span> <span class="o">=</span> <span class="l">@[</span> <span class="n">aThing</span><span class="p">,</span> <span class="s">@"A String"</span><span class="p">,</span> <span class="mf">@3.14</span> <span class="l">]</span><span class="p">;</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">aDictionary</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSDictionary</span> <span class="nl">dictionaryWithObjectsAndKeys</span><span class="p">:</span>
                                <span class="n">value</span><span class="p">,</span> <span class="s">@"Key"</span><span class="p">,</span>
                                <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithBOOL</span><span class="p">:</span><span class="nb">YES</span><span class="p">],</span> <span class="s">@"OtherKey"</span><span class="p">,</span>                                <span class="nb">nil</span><span class="p">];</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>objectivec:afterNSDictionary *aDictionary = @{ @"Key" : value, @"OtherKey" : @YES };
</pre></div></div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">distanceDict</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSDictionary</span> <span class="nl">dictionaryWithObjectsAndKeys</span><span class="p">:</span>            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">0.0</span><span class="p">],</span> <span class="n">kCIAttributeMin</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">1.0</span><span class="p">],</span> <span class="n">kCIAttributeMax</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">0.0</span><span class="p">],</span> <span class="n">kCIAttributeSliderMin</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">0.7</span><span class="p">],</span> <span class="n">kCIAttributeSliderMax</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">0.2</span><span class="p">],</span> <span class="n">kCIAttributeDefault</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">0.0</span><span class="p">],</span> <span class="n">kCIAttributeIdentity</span><span class="p">,</span>
            <span class="n">kCIAttributeTypeScalar</span><span class="p">,</span>            <span class="n">kCIAttributeType</span><span class="p">,</span>
            <span class="nb">nil</span><span class="p">];</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">distanceDict</span> <span class="o">=</span> <span class="l">@{</span>
        <span class="nl">kCIAttributeMin</span>       <span class="p">:</span> <span class="mf">@0.0</span><span class="p">,</span>
        <span class="nl">kCIAttributeMax</span>       <span class="p">:</span> <span class="mf">@1.0</span><span class="p">,</span>
        <span class="nl">kCIAttributeSliderMin</span> <span class="p">:</span> <span class="mf">@0.0</span><span class="p">,</span>
        <span class="nl">kCIAttributeSliderMax</span> <span class="p">:</span> <span class="mf">@0.7</span><span class="p">,</span>
        <span class="nl">kCIAttributeDefault</span>   <span class="p">:</span> <span class="mf">@0.2</span><span class="p">,</span>
        <span class="nl">kCIAttributeIdentity</span>  <span class="p">:</span> <span class="mf">@0.0</span><span class="p">,</span>
        <span class="nl">kCIAttributeType</span>      <span class="p">:</span> <span class="n">kCIAttributeTypeScalar</span>
<span class="l">}</span><span class="p">;</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">slopeDict</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSDictionary</span> <span class="nl">dictionaryWithObjectsAndKeys</span><span class="p">:</span>            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">],</span> <span class="n">kCIAttributeSliderMin</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">0.01</span><span class="p">],</span> <span class="n">kCIAttributeSliderMax</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">0.00</span><span class="p">],</span> <span class="n">kCIAttributeDefault</span><span class="p">,</span>
            <span class="p">[</span><span class="bp">NSNumber</span> <span class="nl">numberWithDouble</span><span class="p">:</span>  <span class="mf">0.00</span><span class="p">],</span> <span class="n">kCIAttributeIdentity</span><span class="p">,</span>
            <span class="n">kCIAttributeTypeScalar</span><span class="p">,</span>             <span class="n">kCIAttributeType</span><span class="p">,</span>
            <span class="nb">nil</span><span class="p">];</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">slopeDict</span> <span class="o">=</span> <span class="l">@{</span>
        <span class="nl">kCIAttributeSliderMin</span> <span class="p">:</span> <span class="p">@</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span>
        <span class="nl">kCIAttributeSliderMax</span> <span class="p">:</span> <span class="mf">@0.01</span><span class="p">,</span>
        <span class="nl">kCIAttributeDefault</span>   <span class="p">:</span> <span class="mf">@0.00</span><span class="p">,</span>
        <span class="nl">kCIAttributeIdentity</span>  <span class="p">:</span> <span class="mf">@0.00</span><span class="p">,</span>
        <span class="nl">kCIAttributeType</span>      <span class="p">:</span> <span class="n">kCIAttributeTypeScalar</span> <span class="l">}</span><span class="p">;</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="kt">id</span> <span class="n">firstElement</span> <span class="o">=</span> <span class="p">[</span><span class="n">anArray</span> <span class="nl">objectAtIndex</span><span class="p">:</span><span class="mi">0</span><span class="p">];</span>
<span class="p">[</span><span class="n">anArray</span> <span class="nl">replaceObjectAtIndex</span><span class="p">:</span><span class="mi">0</span> <span class="nl">withObject</span><span class="p">:</span><span class="n">newValue</span><span class="p">];</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="kt">id</span> <span class="n">firstElement</span> <span class="o">=</span> <span class="n">anArray</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="n">anArray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">newValue</span><span class="p">;</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="kt">id</span> <span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">aDictionary</span> <span class="nl">objectForKey</span><span class="p">:</span><span class="s">@"key"</span><span class="p">];</span>
<span class="p">[</span><span class="n">aDictionary</span> <span class="nl">setObject</span><span class="p">:</span><span class="n">newValue</span> <span class="nl">forKey</span><span class="p">:</span><span class="s">@"key"</span><span class="p">];</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="kt">id</span> <span class="n">value</span> <span class="o">=</span> <span class="n">aDictionary</span><span class="p">[</span><span class="s">@"key"</span><span class="p">];</span>
<span class="n">aDictionary</span><span class="p">[</span><span class="s">@"key"</span><span class="p">]</span> <span class="o">=</span> <span class="n">newValue</span><span class="p">;</span>
</pre></div>
</div>

<hr>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">...;</span>
<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">[</span><span class="n">array</span> <span class="n">count</span><span class="p">];</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">id</span> <span class="n">element</span> <span class="o">=</span> <span class="p">[</span><span class="n">array</span> <span class="nl">objectAtIndex</span><span class="p">:</span><span class="n">i</span><span class="p">];</span>
    <span class="c1">// ... </span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">...;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">id</span> <span class="n">element</span> <span class="k">in</span> <span class="n">array</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>

<h2>
<span id="blocks" class="fragment"></span><a href="#blocks"><i class="fa fa-link"></i></a>Blocks</h2>

<h3>
<span id="nsarray" class="fragment"></span><a href="#nsarray"><i class="fa fa-link"></i></a>NSArray</h3>

<p>ソートは<code>(NSArray *)sortedArrayUsingComparator:(NSComparator)cmptr</code>が使える。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">...;</span>
<span class="bp">NSArray</span> <span class="o">*</span><span class="n">sortedArray</span><span class="p">;</span>
<span class="n">sortedArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">array</span> <span class="nl">sortedArrayUsingFunction</span><span class="p">:</span><span class="n">MySort</span> <span class="nl">context</span><span class="p">:</span><span class="nb">NULL</span><span class="p">];</span>

<span class="n">NSInteger</span> <span class="nf">MySort</span><span class="p">(</span><span class="kt">id</span> <span class="n">num1</span><span class="p">,</span> <span class="kt">id</span> <span class="n">num2</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSComparisonResult</span> <span class="n">result</span><span class="p">;</span>
    <span class="c1">// Do comparison</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">...;</span>
<span class="kt">BOOL</span> <span class="n">reverse</span> <span class="o">=</span> <span class="p">...;</span>
<span class="bp">NSArray</span> <span class="o">*</span><span class="n">sortedArray</span><span class="p">;</span>
<span class="n">sortedArray</span> <span class="o">=</span> <span class="p">[</span><span class="n">array</span> <span class="nl">sortedArrayUsingComparator</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">id</span> <span class="n">num1</span><span class="p">,</span> <span class="kt">id</span> <span class="n">num2</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">NSComparisonResult</span> <span class="n">result</span><span class="p">;</span>
    <span class="c1">// Do comparison</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}];</span>
</pre></div>
</div>

<p>--</p>

<p>eachには<code>(void)enumerateObjectsUsingBlock:(void (^)(id obj, NSUInteger idx, BOOL *stop))block</code>が使える。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">...;</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">id</span> <span class="n">element</span> <span class="k">in</span> <span class="n">array</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// ... </span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">array</span> <span class="o">=</span> <span class="p">...;</span>
<span class="p">[</span><span class="n">array</span> <span class="nl">enumerateObjectsUsingBlock</span><span class="p">:</span>
      <span class="o">^</span><span class="p">(</span><span class="kt">id</span> <span class="n">obj</span><span class="p">,</span> <span class="n">NSUInteger</span> <span class="n">idx</span><span class="p">,</span> <span class="kt">BOOL</span> <span class="o">*</span><span class="n">stop</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// ...</span>
      <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Processing %@ at index %d”, obj, idx);</span>
      <span class="c1">// ...</span>
<span class="p">}];</span>
</pre></div>
</div>

<p>--</p>

<h3>
<span id="nsdictionary" class="fragment"></span><a href="#nsdictionary"><i class="fa fa-link"></i></a>NSDictionary</h3>

<p><code>(void)enumerateKeysAndObjectsUsingBlock:(void (^)(id key, id obj, BOOL *stop))block</code>が使える。</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span>NSDictionary *dictionary = ...;
for (NSString *key in dictionary) {
    id object = [dictionary objectForKey:key];
    // Do things with key and object.
}
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span>NSDictionary *dictionary = ...;
[dictionary enumerateKeysAndObjectsUsingBlock:^(id key, id object, BOOL *stop) {
    // Do things with key and object.
}];
</pre></div>
</div>

<p>--</p>

<h3>
<span id="notifications" class="fragment"></span><a href="#notifications"><i class="fa fa-link"></i></a>Notifications</h3>

<p><code>(id)addObserverForName:(NSString *)name object:(id)obj queue:(NSOperationQueue *)queue usingBlock:(void (^)(NSNotification *note))block</code>が使える。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">before</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">registerForNotifications</span> <span class="p">{</span>
    <span class="bp">NSNotificationCenter</span> <span class="o">*</span><span class="n">center</span> <span class="o">=</span> <span class="p">...</span>
    <span class="p">[</span><span class="n">center</span> <span class="nl">addObserver</span><span class="p">:</span><span class="nb">self</span>
        <span class="nl">selector</span><span class="p">:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">windowBecameKey</span><span class="p">:)</span>
        <span class="nl">name</span><span class="p">:</span><span class="n">NSWindowDidBecomeKeyNotification</span>
        <span class="nl">object</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">window</span><span class="p">];</span>
<span class="p">}</span>
<span class="c1">// Different context</span>
<span class="c1">// No queue information</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">windowBecameKey:</span><span class="p">(</span><span class="bp">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="nv">notification</span> <span class="p">{</span>
    <span class="c1">// Get contextual information.</span>
<span class="p">}</span>
</pre></div>
</div>

<p>↓</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">after</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">registerForNotifications</span> <span class="p">{</span>
    <span class="bp">NSNotificationCenter</span> <span class="o">*</span><span class="n">center</span> <span class="o">=</span> <span class="p">...</span>
    <span class="bp">MyClass</span> <span class="o">*</span><span class="k">__weak</span> <span class="n">weakSelf</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
    <span class="p">[</span><span class="n">center</span> <span class="nl">addObserverForName</span><span class="p">:</span><span class="n">NSWindowDidBecomeKeyNotification</span>
        <span class="nl">object</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">window</span>
        <span class="nl">queue</span><span class="p">:[</span><span class="bp">NSOperationQueue</span> <span class="n">mainQueue</span><span class="p">]</span>
        <span class="nl">usingBlock</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSNotification</span> <span class="o">*</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// ...</span>
            <span class="p">[</span><span class="n">weakSelf</span> <span class="n">doSomething</span><span class="p">];</span>
            <span class="c1">// ...</span>
    <span class="p">}];</span>
<span class="p">}</span>
</pre></div>
</div>

<p>Blosks内でselfは直接参照せず、弱参照 <code>MyClass *__weak</code>に変換して使わないといけない。</p>

<p>--</p>

<h2>
<span id="その他" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96"><i class="fa fa-link"></i></a>その他</h2>

<ul>
<li>元資料は <a href="https://developer.apple.com/library/mac/navigation/index.html" rel="nofollow noopener" target="_blank">Mac Developer Library</a> <strong>modern</strong>で検索</li>
<li>使いたいメソッドがBlocksに対応していない場合 → <a href="https://github.com/pandamonia/BlocksKit" rel="nofollow noopener" target="_blank">BlocksKit</a>の利用を検討する</li>
<li>Xcode(コンパイラ)の更新は <a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Conceptual/WhatsNewXcode/00-Introduction/Introduction.html" rel="nofollow noopener" target="_blank">What’s New in Xcode</a> を参照</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />9位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>96</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/38c0300cbbaf8d2f2370">JekyllをStep by Stepで使って理解する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-03-25 13:06:15</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> <b>[Jekyll]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="http://jekyllrb.com/" rel="nofollow noopener" target="_blank">jekyll</a>は静的サイトジェネレータ。Github Pageなどでも使われており、ブログとしても使うことができて、ブログのフレームワークとして<a href="http://octopress.org/" rel="nofollow noopener" target="_blank">Octopress</a>や<a href="http://jekyllbootstrap.com/" rel="nofollow noopener" target="_blank">Jekyll-Bootstrap</a>がメジャーどころ。</p>

<p>OctopressやJekyll-Bootstrapを読んで勉強するのもありだがあえて素の<a href="http://jekyllrb.com/" rel="nofollow noopener" target="_blank">jekyll</a>を使って流れを理解するの巻。<strong>事前セットアップとしてRubyとbundlerは入れておいてください。</strong></p>

<h1>
<span id="step1" class="fragment"></span><a href="#step1"><i class="fa fa-link"></i></a>Step1</h1>

<p>まずはブログとは関係ない任意のページをmarkdownで作成して公開する。</p>

<h2>
<span id="ファイル構成" class="fragment"></span><a href="#%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E6%A7%8B%E6%88%90"><i class="fa fa-link"></i></a>ファイル構成</h2>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>.bundle/
 └─ config
_layouts/
 └─ default.html # レイアウト
_site/
 │ code.html
 │ index.html
 └─ pygments.css
vendor/
 └─ bundle/
.gitignore
_config.yml # jekyll構成ファイル
code.md # _site/code.htmlのソース
Gemfile
Gemfile.lock
index.md  # _site/index.htmlのソース
pygments.css
</pre></div></div>

<h2>
<span id="jekyllのインストール" class="fragment"></span><a href="#jekyll%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Jekyllのインストール</h2>

<p>作業ディレクトリを作ってGemfileを作成する。markdownの変換はredcarpetを使う。 </p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Gemfile</span></div>
<div class="highlight"><pre><span></span><span class="n">source</span> <span class="s1">'http://rubygems.org'</span>

<span class="n">gem</span> <span class="s1">'jekyll'</span>
<span class="n">gem</span> <span class="s1">'redcarpet'</span>
</pre></div>
</div>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>bundle install --path vendor/bundle
</pre></div></div>

<h2>
<span id="構成ファイルの作成" class="fragment"></span><a href="#%E6%A7%8B%E6%88%90%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>構成ファイルの作成</h2>

<p>まずは必要最低限。設定項目については<a href="https://github.com/mojombo/jekyll/wiki/configuration" rel="nofollow noopener" target="_blank">Configuration</a>を参照。</p>

<div class="code-frame" data-lang="yaml">
<div class="code-lang"><span class="bold">_config.yml</span></div>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">markdown</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">redcarpet</span>
<span class="l l-Scalar l-Scalar-Plain">exclude</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">"vendor"</span><span class="p p-Indicator">,</span> <span class="s">"Gemfile"</span><span class="p p-Indicator">,</span> <span class="s">"Gemfile.lock"</span><span class="p p-Indicator">]</span>
</pre></div>
</div>

<h2>
<span id="レイアウトファイルの用意" class="fragment"></span><a href="#%E3%83%AC%E3%82%A4%E3%82%A2%E3%82%A6%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E7%94%A8%E6%84%8F"><i class="fa fa-link"></i></a>レイアウトファイルの用意</h2>

<p><code>_layouts/default.html</code>を作成する。_layoutディレクトリに拡張子htmlのファイルを置くとそれをページ側から参照できるようになる。ページ側から入力するコンテンツとしてpage.title, contentを入力している。テンプレートの詳細は <a href="http://liquidmarkup.org/" rel="nofollow noopener" target="_blank">Liquid </a> を参照。</p>

<div class="code-frame" data-lang="html">
<div class="code-lang"><span class="bold">_layouts/default.html</span></div>
<div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">"ja"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"utf-8"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{ page.title }}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
{{ content }}
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>

<h2>
<span id="最初のページを作る" class="fragment"></span><a href="#%E6%9C%80%E5%88%9D%E3%81%AE%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%92%E4%BD%9C%E3%82%8B"><i class="fa fa-link"></i></a>最初のページを作る</h2>

<p>トップディレクトリに<code>index.md</code>を作成する。</p>

<p>まずコンテンツの前に<code>---</code>で囲った内容をページの属性として設定できる。レイアウトで指定した名前が先ほどの_layout/<strong>名前</strong>.htmlで参照できる。titleに設定したものが先のレイアウトでは<code>{{ page.title }}</code>の部分になる。</p>

<div class="code-frame" data-lang="gcc-machine-description">
<div class="code-lang"><span class="bold">index.md</span></div>
<div class="highlight"><pre><span></span>---
layout: default
title: Hello
---
## 最初ページべし。
...ぜ。
</pre></div>
</div>

<h2>
<span id="サイトの確認" class="fragment"></span><a href="#%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AE%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>サイトの確認</h2>

<p><code>jekyll --server</code>コマンドでローカルにWebサーバを起動することができる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>bundle exec jekyll --server 3000 --auto
</pre></div></div>

<p><a href="http://localhost:3000/" rel="nofollow noopener" target="_blank">http://localhost:3000/</a>でindex.mdの内容が表示されたらok。</p>

<h2>
<span id="コードハイライトを使う" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>コードハイライトを使う</h2>

<p>Pygmentsを入れる。</p>

<p>OS Xの場合。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>brew install python
export PATH="/usr/local/share/python:${PATH}"
easy_install pip
pip install --upgrade distribute
pip install pygments
</pre></div></div>

<p>構成ファイルを修正。1行目を追加。</p>

<div class="code-frame" data-lang="yaml">
<div class="code-lang"><span class="bold">_config.yml</span></div>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">pygments</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="l l-Scalar l-Scalar-Plain">markdown</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">redcarpet</span>
<span class="l l-Scalar l-Scalar-Plain">exclude</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span><span class="s">"vendor"</span><span class="p p-Indicator">,</span> <span class="s">"Gemfile"</span><span class="p p-Indicator">,</span> <span class="s">"Gemfile.lock"</span><span class="p p-Indicator">]</span>
</pre></div>
</div>

<p>css作成</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>pygmentize -S default -f html &gt; pygments.css
</pre></div></div>

<p>レイアウトファイルに追加。</p>

<div class="code-frame" data-lang="html">
<div class="code-lang"><span class="bold">_layouts/default.html</span></div>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span> <span class="na">href</span><span class="o">=</span><span class="s">"/pygments.css"</span><span class="p">&gt;</span>
</pre></div>
</div>

<p>ページを作成、code.mdで保存。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>---
layout: default
title: code
---
```ruby
p 'hello'
```
</pre></div></div>

<p>jekyll立ち上げ直し。さすがに_config.ymlの変更までは追従されない。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>bundle exec jekyll --server 3000 --auto
</pre></div></div>

<p><a href="http://localhost:3000/code.html" rel="nofollow noopener" target="_blank">http://localhost:3000/code.html</a> が表示されたらok。</p>

<h2>
<span id="変数を使う" class="fragment"></span><a href="#%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>変数を使う</h2>

<p>テンプレートで変数を使うことができる。いくつかの変数がビルトインで用意されており<a href="https://github.com/mojombo/jekyll/wiki/Template-Data" rel="nofollow noopener" target="_blank">Template-Data</a>で確認できる。</p>

<p>さらに_config.ymlに入れた値はviewでは<strong>site</strong>変数から参照できる。例えば以下のようにリソースのURLを設定しておき、テンプレートで参照することができる。</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">_config.yml</span></div>
<div class="highlight"><pre><span></span>bootstrap_url: //netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1
</pre></div>
</div>

<div class="code-frame" data-lang="html">
<div class="code-lang"><span class="bold">_layouts/default.html</span></div>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">"{{ site.bootstrap_url }}/css/bootstrap-combined.min.css"</span> <span class="na">rel</span><span class="o">=</span><span class="s">"stylesheet"</span><span class="p">&gt;</span>
</pre></div>
</div>

<h1>
<span id="step2" class="fragment"></span><a href="#step2"><i class="fa fa-link"></i></a>Step2</h1>

<h2>
<span id="ブログのエントリーの作成" class="fragment"></span><a href="#%E3%83%96%E3%83%AD%E3%82%B0%E3%81%AE%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AA%E3%83%BC%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>ブログのエントリーの作成</h2>

<p>ブログのエントリーは<code>_post</code>ディレクトリに<code>YEAR-MONTH-DAY-title.MARKUP</code>といった日付を含めたファイル名でページを作成する。</p>

<p>以下のような<code>_post/2013-01-01-new-year.html</code>を作成してまたjekyll --serverを起動する。</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">_post/2013-01-01-new-year.html</span></div>
<div class="highlight"><pre><span></span>---
layout: default
title: 2013
---
&lt;p&gt;Happy, New Year!&lt;/p&gt;
</pre></div>
</div>

<p>すると<code>_site/2013/01/01/new-year.html</code>というファイルが作成された。したがって <a href="http://localhost:3000/2013/01/01/new-year.html" rel="nofollow noopener" target="_blank">http://localhost:3000/2013/01/01/new-year.html</a>にアクセスができる。</p>

<p>_postにあるファイルをどういう階層で出力するかをpermalinkの設定で行える。指定できる項目は <a href="https://github.com/mojombo/jekyll/wiki/Permalinks" rel="nofollow noopener" target="_blank">Permalinks</a> を参照。作成されたファイルから逆算するとデフォルトの設定が</p>

<p><code>permalink: /:year/:month/:day/:title.html</code></p>

<p>になっていると理解できる。titleにマルチバイト文字を入れるとややこしくなるのでなるべく避ける方がいい。</p>

<h2>
<span id="エントリーを列挙する" class="fragment"></span><a href="#%E3%82%A8%E3%83%B3%E3%83%88%E3%83%AA%E3%83%BC%E3%82%92%E5%88%97%E6%8C%99%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>エントリーを列挙する</h2>

<p>_config.ymlにpaginateを設定する。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>paginate: 3 # the number of post per page
</pre></div></div>

<p>paginateがindex.htmlでないと動作しないためトップディレクトリに以下のようなindex.htmlファイルを作成する。<strong>前回作ったindex.mdはhello.mdなどに変更しておく。</strong> </p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">index.html</span></div>
<div class="highlight"><pre><span></span>---
layout: default
title: Blog
---

{% for post in paginator.posts %}

   &lt;!-- here add you post markup --&gt;
   &lt;h1&gt;&lt;a href="{{ post.url }}"&gt;{{ post.title }}&lt;/a&gt;&lt;/h1&gt;
   &lt;p class="author"&gt;
    &lt;span class="date"&gt;{{post.date}}&lt;/span&gt;
  &lt;/p&gt;
  &lt;div class="content"&gt;
    {{ post.content }}
  &lt;/div&gt;
{% endfor %}

&lt;!-- Pagination links --&gt;
&lt;div class="pagination"&gt;
  {% if paginator.previous_page %}
    &lt;a href="/page{{paginator.previous_page}}" class="previous"&gt;Previous&lt;/a&gt;
  {% else %}
    &lt;span class="previous"&gt;Previous&lt;/span&gt;
  {% endif %}
  &lt;span class="page_number "&gt;Page: {{paginator.page}} of {{paginator.total_pages}}&lt;/span&gt;
  {% if paginator.next_page %}
    &lt;a href="/page{{paginator.next_page}}" class="next "&gt;Next&lt;/a&gt;
  {% else %}
    &lt;span class="next "&gt;Next&lt;/span&gt;
  {% endif %}
&lt;/div&gt;
</pre></div>
</div>

<p>_config.ymlを変更したのでまたロールサーバを起動しなおすと、<a href="http://localhost:3000/" rel="nofollow noopener" target="_blank">http://localhost:3000/</a> にアクセスすると投稿が一覧で表示される。</p>

<h1>
<span id="step3" class="fragment"></span><a href="#step3"><i class="fa fa-link"></i></a>Step3</h1>

<h2>
<span id="サーバに配置" class="fragment"></span><a href="#%E3%82%B5%E3%83%BC%E3%83%90%E3%81%AB%E9%85%8D%E7%BD%AE"><i class="fa fa-link"></i></a>サーバに配置</h2>

<p><a href="https://github.com/mojombo/jekyll/wiki/Deployment" rel="nofollow noopener" target="_blank">Deployment</a>はいろいろ応用があって自動化もできる。</p>

<p>静的ファイルとして<code>_site</code>に階層ができてあがっているので単純にこれをサーバのドキュメントルートにFTPでアップロードすることもできる。</p>

<h2>
<span id="サイトのコミット" class="fragment"></span><a href="#%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AE%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88"><i class="fa fa-link"></i></a>サイトのコミット</h2>

<p>静的ファイルと依存gemを除外する。</p>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">.gitignore</span></div>
<div class="highlight"><pre><span></span>/_site
/vendor
</pre></div>
</div>

<h2>
<span id="終わりに" class="fragment"></span><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>終わりに</h2>

<p>レイアウト使えてGithub Flavored Markdownで文章が書ける。エンジニアが会社やサービスのちょっとしたサイトを作らないといけないときはこれで十分な気がする。逆に非エンジニアの人が使うシステムに持っていくには編集やファイルの生成や配置の流れを考えると敷居が高い。</p>

<p><a href="http://octopress.org/" rel="nofollow noopener" target="_blank">Octopress</a>や<a href="http://jekyllbootstrap.com/" rel="nofollow noopener" target="_blank">Jekyll-Bootstrap</a>を使うとブログに必要なページをより簡単に作成することができる。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />10位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>90</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/26ecf8fa5b04220c0174">HomebrewでPhpStorm向けのPHP環境を構築する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-01-19 13:59:15</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[PHP]</b> <b>[PhpStorm]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>基本的にウェブの開発環境は仮想環境で実行しているんだけどPhpStormで開発しているときはホストOSに実行環境があると便利なのでhomebrewで環境構築してみたメモ。</p>

<h2>
<span id="環境" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>環境</h2>

<ul>
<li>Mac OS X 10.8.2</li>
<li>Homebrew + phpjosegonzalez/homebrew-php</li>
<li>PhpStorm 5.0.4</li>
</ul>

<p>PHPのバージョンを細かく管理するならphpbrewだが、ただPhpStormから使いたかっただけなのでjosegonzalezさんのFomuraで手っ取り早く構築する。</p>

<h2>
<span id="php-54のインストール" class="fragment"></span><a href="#php-54%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>PHP 5.4のインストール</h2>

<p>PHP5.4で<a href="http://php.net/manual/ja/features.commandline.webserver.php" rel="nofollow noopener" target="_blank">ビルトインのウェブサーバ</a>が追加されてちょっとした確認のときに便利なのでPHP5.4を使う。</p>

<p>OSXに入っているものは使う思想のHomebrewではPHPの最新バージョンは入っていないので<a href="https://github.com/josegonzalez/homebrew-php" rel="nofollow noopener" target="_blank">phpjosegonzalez/homebrew-php</a>を使う。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>brew tap homebrew/dupes
brew tap josegonzalez/homebrew-php
brew install php54 --with-mysql --with-fpm
brew install php54-intl
</pre></div></div>

<p>オプションは<code>brew options php54</code>で見れるので必要なものを入れるといい、デフォルトでpearオプションは付いている。なぜか--with-intlが壊れてるなど警告がでたので<code>php54-intl</code>を別途追加。</p>

<p>php --iniで <code>/usr/local/etc/php/5.4/php.ini</code> あたりが設定ファイルのパスとして出力される。</p>

<p>PhpStormではOSXでデフォルトでインストールされているPHP(/usr/bin/php)が認識されていたりするので<br>
Project Settings &gt; PHP &gt; Interpreter の … で Interpreters ウインドウを開いて + で</p>

<table>
<thead>
<tr>
<th style="text-align: left">項目</th>
<th style="text-align: left">値</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">Name</td>
<td style="text-align: left">homebrew/php</td>
</tr>
<tr>
<td style="text-align: left">PHP Home</td>
<td style="text-align: left">/usr/local/bin</td>
</tr>
</tbody>
</table>

<p>を追加して Interpreter で homebrew/php を選ぶ。更に include pathに /userr/local/Cellar/php54/5.4.x/lib/php を追加しておく。</p>

<h2>
<span id="composer" class="fragment"></span><a href="#composer"><i class="fa fa-link"></i></a>Composer</h2>

<p><a href="http://getcomposer.org/" rel="nofollow noopener" target="_blank">Composer</a>もあったのでHomebrewからインストール。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>brew install composer
</pre></div></div>

<p>PhpStormのProject Settings &gt; PHP &gt; Composerの<strong>Path to composer.phar</strong>に<code>/usr/local/bin/composer</code>を設定する。</p>

<p>/usr/local/bin/composer</p>

<h2>
<span id="php-code-sniffer" class="fragment"></span><a href="#php-code-sniffer"><i class="fa fa-link"></i></a>PHP Code Sniffer</h2>

<p>コードスタイルの検証ツールである<a href="http://pear.php.net/package/PHP_CodeSniffer" rel="nofollow noopener" target="_blank">PHP Code Sniffer</a>は</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>brew install php-code-sniffer
</pre></div></div>

<p>でインストールできる。</p>

<p>PhpStormからは Project Settings &gt; PHP &gt; Code Sniffer から path に /usr/local/bin/phpcs を設定。</p>

<p>Project Settings &gt; Inspections &gt; PHP &gt; PHP Code Sniffer validation にチェックを入れておくと、ファイルやディレクトリを右クリック &gt; Inspect Code… からも利用できる。</p>

<h2>
<span id="phpunit" class="fragment"></span><a href="#phpunit"><i class="fa fa-link"></i></a>PHPUnit</h2>

<h3>
<span id="pearを使う" class="fragment"></span><a href="#pear%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>PEARを使う</h3>

<p>Fomuraには見当たらないのでPEARで入れてしまう。ただ下記作業はPHPのバージョンが変わるごとに同期する必要あるのであまり良いやり方には思えない。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>sudo pear config-set auto_discover 1
sudo pear install pear.phpunit.de/PHPUnit
</pre></div></div>

<p>成功すれば/usr/local/Cellar/php54/5.4.x/lib/php/PHPUnit/に入る。</p>

<p>プロジェクトに<a href="http://www.phpunit.de/manual/3.7/ja/appendixes.configuration.html" rel="nofollow noopener" target="_blank">phpunit.xml</a>を作っておき右クリック &gt; Run … で実行できる。</p>

<p>ターミナルから使いたい場合はパスを通しておく。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>cd /usr/local/bin
ln -s ../Cellar/php54/5.4.11/bin/phpunit phpunit
</pre></div></div>

<h3>
<span id="composerを使う" class="fragment"></span><a href="#composer%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>Composerを使う</h3>

<p>プロジェクト毎に<a href="http://qiita.com/makoto_kw/items/b700a954f044f0b7a23d" id="reference-f628613d069a15a91508">PHPUnitをcomposerでインストール</a>する場合は PHP &gt; PHPUnit の設定で <strong>Use Custom Loader</strong>  を選択し vendor/autoload.php を <strong>Path to script</strong> から選択すればいい。<br>
（絶対パスを設定しても設定ファイルには$PROJECT_DIR$/vendor/autoload.phpになっている）</p>

<h2>
<span id="xdebug" class="fragment"></span><a href="#xdebug"><i class="fa fa-link"></i></a>Xdebug</h2>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>brew install php54-xdebug
</pre></div></div>

<p>でインストール。</p>

<div class="code-frame" data-lang="ini">
<div class="code-lang"><span class="bold">/usr/local/etc/php/5.4/conf.d/ext-xdebug.ini</span></div>
<div class="highlight"><pre><span></span><span class="na">xdebug.remote_enable</span><span class="o">=</span><span class="s">1</span>
<span class="na">xdebug.remote_autostart</span><span class="o">=</span><span class="s">1</span>
</pre></div>
</div>

<p>を設定するか、あるいはサーバ実行時に指定。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>php -S localhost:8080 -t /path/to/document-root -d xdebug.remote_enable=1 -d xdebug.remote_autostart=1
</pre></div></div>

<p>ちなみにPhpStormではRun &gt; Edit Configration… から + で<strong>PHP Built-in Web Server</strong>を追加すると、PhpStromから実行、停止ができるようになる。</p>

<p>あとは Run &gt; Start Listen PHP Debug Connectionsを実行する。ツールバーの電話の受話器みたいなアイコンからもOn/Offできる。</p>

<p>リスニングを開始するとxdebug.remote_autostartを有効にしているのでブラウザでページにアクセスするとPhpStormとお話が始まり、最初のアクセスでは実行しているファイルのパスを聞かれるのでそれを合わせるとソースコード上でブレークできる。</p>

<h2>
<span id="stubs" class="fragment"></span><a href="#stubs"><i class="fa fa-link"></i></a>stubs</h2>

<p>拡張ライブラリの補完のため</p>

<ul>
<li><a href="http://youtrack.jetbrains.com/issue/WI-174" class="autolink" rel="nofollow noopener" target="_blank">http://youtrack.jetbrains.com/issue/WI-174</a></li>
<li><a href="http://youtrack.jetbrains.com/issue/WI-15465" class="autolink" rel="nofollow noopener" target="_blank">http://youtrack.jetbrains.com/issue/WI-15465</a></li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />11位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>82</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/447448d8fcabc4a9e8e0">CocoaPods podspec作成の逆引きいろいろ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-05-14 11:27:57</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[iOS]</b> <b>[CocoaPods]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>当初ドキュメントがあまり網羅されていなかったりしたので今までやろうとしたことの逆引き的なメモ。完成の終わりがわからないので随時更新(予定)。</p>

<h2>
<span id="一つのpodをモジュールごとに分割するよ" class="fragment"></span><a href="#%E4%B8%80%E3%81%A4%E3%81%AEpod%E3%82%92%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%94%E3%81%A8%E3%81%AB%E5%88%86%E5%89%B2%E3%81%99%E3%82%8B%E3%82%88"><i class="fa fa-link"></i></a>一つのPodをモジュールごとに分割するよ</h2>

<p>subspecを使う。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span>  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">'ModuleA'</span> <span class="k">do</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span>
    <span class="n">a</span><span class="o">.</span><span class="n">source_files</span> <span class="o">=</span> <span class="s1">'ModuleA/*.{h,m}'</span>
    <span class="n">a</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">'Reachability'</span>
  <span class="k">end</span>
  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">'ModuleB'</span> <span class="k">do</span> <span class="o">|</span><span class="n">b</span><span class="o">|</span>
    <span class="n">b</span><span class="o">.</span><span class="n">source_files</span> <span class="o">=</span> <span class="s1">'ModuleB/*.{h,m}'</span>
  <span class="k">end</span>
</pre></div>
</div>

<p><code>source_files</code>の指定上、予めソースファイルをディレクトリごとに分けておくと管理しやすい。</p>

<p>アプリで使ってもらうときはPodの名前とsubspecの名前を<code>/</code>で区切り以下のように指定する。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span><span class="n">pod</span> <span class="s1">'MyPodName/ModuleA'</span>
</pre></div>
</div>

<p>Pod内でもモジュール間の依存関係を解決できる。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span>  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">'Core'</span> <span class="k">do</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span>
  <span class="k">end</span>
  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">'ModuleA'</span> <span class="k">do</span> <span class="o">|</span><span class="n">b</span><span class="o">|</span>
    <span class="n">b</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">'MyPodName/Core'</span>
  <span class="k">end</span>
</pre></div>
</div>

<p>さらにはmainspecをsubspecに依存させることもできる。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span>  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">'ModuleA'</span> <span class="k">do</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span>
  <span class="k">end</span>
  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">'MyPodName/ModuleA'</span>
</pre></div>
</div>

<h2>
<span id="arc無効にするよ" class="fragment"></span><a href="#arc%E7%84%A1%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B%E3%82%88"><i class="fa fa-link"></i></a>ARC無効にするよ</h2>

<p><code>requires_arc</code>を設定する。CocoaPods 0.17.0からデフォルトが <code>true</code> (ARC有効) 、それ以前が <code>false</code> (ARC無効)なので、どちらの設定にせよ明示的に書くべき。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">requires_arc</span> <span class="o">=</span> <span class="kp">false</span>
</pre></div>
</div>

<h2>
<span id="pod内の特定のファイルだけarcを無効にするよ" class="fragment"></span><a href="#pod%E5%86%85%E3%81%AE%E7%89%B9%E5%AE%9A%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%A0%E3%81%91arc%E3%82%92%E7%84%A1%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B%E3%82%88"><i class="fa fa-link"></i></a>Pod内の特定のファイルだけARCを無効にするよ</h2>

<p>subspecを利用してPodを分割して、設定をわけて、そのsubspecに依存させる。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span>  <span class="n">s</span><span class="o">.</span><span class="n">name</span>         <span class="o">=</span> <span class="s1">'MyPodName'</span>
  <span class="n">s</span><span class="o">.</span><span class="n">requires_arc</span> <span class="o">=</span> <span class="kp">true</span>
  <span class="err">…</span>

  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">'NoARC'</span> <span class="k">do</span> <span class="o">|</span><span class="nb">sub</span><span class="o">|</span>
    <span class="err">…</span>
    <span class="nb">sub</span><span class="o">.</span><span class="n">requires_arc</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="k">end</span>

  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">'MyPodName/NoARC'</span>
</pre></div>
</div>

<h2>
<span id="libxml2とか使うよ" class="fragment"></span><a href="#libxml2%E3%81%A8%E3%81%8B%E4%BD%BF%E3%81%86%E3%82%88"><i class="fa fa-link"></i></a>libxml2とか使うよ</h2>

<p>SDKのスタティックライブラリを使う場合。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">libraries</span> <span class="o">=</span> <span class="s1">'xml2'</span>
<span class="n">s</span><span class="o">.</span><span class="n">xcconfig</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'HEADER_SEARCH_PATHS'</span> <span class="o">=&gt;</span> <span class="s1">'$(SDKROOT)/usr/include/libxml2'</span> <span class="p">}</span>
</pre></div>
</div>

<h2>
<span id="stl使うからリンクするよ" class="fragment"></span><a href="#stl%E4%BD%BF%E3%81%86%E3%81%8B%E3%82%89%E3%83%AA%E3%83%B3%E3%82%AF%E3%81%99%E3%82%8B%E3%82%88"><i class="fa fa-link"></i></a>STL使うからリンクするよ</h2>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">libraries</span> <span class="o">=</span> <span class="s1">'stdc++'</span>
</pre></div>
</div>

<h2>
<span id="プリコンパイルヘッダ使うよ" class="fragment"></span><a href="#%E3%83%97%E3%83%AA%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB%E3%83%98%E3%83%83%E3%83%80%E4%BD%BF%E3%81%86%E3%82%88"><i class="fa fa-link"></i></a>プリコンパイルヘッダ使うよ</h2>

<p><code>prefix_header_contents</code> に設定する。以下のようにRubyのヒアドキュメントを使うこともできる。</p>

<p>ただしsubspecを使った場合に親の<code>prefix_header_contents</code>が反映されることがあり、何度も<code>prefix_header_contents</code>が実行されてしまうことがあるのでsubspecを使っている場合には<code>Core</code>subspecみたいなものを別につくってそこに書いた方がいい。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span>  <span class="n">s</span><span class="o">.</span><span class="n">prefix_header_contents</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="dl">EOC</span>
<span class="sh">#ifdef __OBJC__</span>
<span class="sh">    #import &lt;SystemConfiguration/SystemConfiguration.h&gt;</span>
<span class="sh">#endif</span>
<span class="dl">EOC</span>
</pre></div>
</div>

<h2>
<span id="static-libraryを含めるよ" class="fragment"></span><a href="#static-library%E3%82%92%E5%90%AB%E3%82%81%E3%82%8B%E3%82%88"><i class="fa fa-link"></i></a>Static Libraryを含めるよ</h2>

<p>Static Libraryで配布されている外部のSDKをPodにする場合に有効。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">preserve_paths</span> <span class="o">=</span> <span class="s1">'lib/libExternal.a'</span>
<span class="n">s</span><span class="o">.</span><span class="n">library</span> <span class="o">=</span> <span class="s1">'External'</span>
<span class="n">s</span><span class="o">.</span><span class="n">xcconfig</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'LIBRARY_SEARCH_PATHS'</span> <span class="o">=&gt;</span> <span class="s1">'"$(PODS_ROOT)/MyPodName/lib"'</span> <span class="p">}</span>
</pre></div>
</div>

<h2>
<span id="localで使うpodだけどstatic-libraryを含めるよ" class="fragment"></span><a href="#local%E3%81%A7%E4%BD%BF%E3%81%86pod%E3%81%A0%E3%81%91%E3%81%A9static-library%E3%82%92%E5%90%AB%E3%82%81%E3%82%8B%E3%82%88"><i class="fa fa-link"></i></a>localで使うPodだけどStatic Libraryを含めるよ</h2>

<p><strong>この方法は0.17か0.18あたりで使えなくなった。localのPodが<code>Pods/Local Podspecs</code>にコピーされて使われるため。<code>MYPODNAME_ROOT</code>が意図通りの値にならない。</strong></p>

<p>ローカルにあるpodを使う場合、</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Podfile</span></div>
<div class="highlight"><pre><span></span><span class="n">pod</span> <span class="s1">'MyPodName'</span><span class="p">,</span> <span class="ss">:local</span> <span class="o">=&gt;</span> <span class="s1">'~/Pods/MyPodName'</span>
</pre></div>
</div>

<p>のようにPodfileがかけるが、アプリプロジェクトからは相対パスで参照される。従って、アプリのプロジェクトから見れば <code>$(PODS_ROOT)/MyPodName</code> にファイルがないため、<code>'LIBRARY_SEARCH_PATHS' =&gt; '"$(PODS_ROOT)/MyPodName/lib"'</code> という指定は使えない。</p>

<p>そのPodをlocalだけで使う前提でいいなら、以下のように設定を絶対パスにすることで強引にいける。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">xcconfig</span> <span class="o">=</span> <span class="p">{</span> 
    <span class="s2">"MYPODNAME_ROOT"</span> <span class="o">=&gt;</span> <span class="no">File</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">__FILE__</span><span class="p">),</span>
    <span class="s1">'HEADER_SEARCH_PATHS'</span> <span class="o">=&gt;</span> <span class="s1">'"$(MYPODNAME_ROOT)/include"'</span><span class="p">,</span>
    <span class="s1">'LIBRARY_SEARCH_PATHS'</span> <span class="o">=&gt;</span> <span class="s1">'"$(MYPODNAME_ROOT)/lib"'</span>
  <span class="p">}</span>
</pre></div>
</div>

<h2>
<span id="localとかprivateカテゴリのヘッダ隠蔽するよ" class="fragment"></span><a href="#local%E3%81%A8%E3%81%8Bprivate%E3%82%AB%E3%83%86%E3%82%B4%E3%83%AA%E3%81%AE%E3%83%98%E3%83%83%E3%83%80%E9%9A%A0%E8%94%BD%E3%81%99%E3%82%8B%E3%82%88"><i class="fa fa-link"></i></a>LocalとかPrivateカテゴリのヘッダ隠蔽するよ</h2>

<h3>
<span id="非推奨-rakefilelist-版" class="fragment"></span><a href="#%E9%9D%9E%E6%8E%A8%E5%A5%A8-rakefilelist-%E7%89%88"><i class="fa fa-link"></i></a>非推奨 Rake::FileList 版</h3>

<p><a href="http://rake.rubyforge.org/classes/Rake/FileList.html#M000152" rel="nofollow noopener" target="_blank">FileList.exclude</a>で正規表現つかって除外する。</p>

<p><strong>CocoaPods 0.17からRake::FileListが非推奨になった</strong></p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">public_header_files</span> <span class="o">=</span> <span class="no">FileList</span><span class="o">[</span><span class="s1">'MyPodName/*.h'</span><span class="o">].</span><span class="n">exclude</span><span class="p">(</span><span class="sr">/\+(:?Local|Private)\.h/</span><span class="p">)</span>
</pre></div>
</div>

<h3>
<span id="正規表現で頑張る" class="fragment"></span><a href="#%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE%E3%81%A7%E9%A0%91%E5%BC%B5%E3%82%8B"><i class="fa fa-link"></i></a>正規表現で頑張る</h3>

<p>文字列ではなく正規表現のリテラルを使う</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">podspec</span></div>
<div class="highlight"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">public_header_files</span> <span class="o">=</span> <span class="sr">/MyPodName\/[\w_-]+(?!\+Private|\+Local)\.h/</span><span class="p">;</span>
</pre></div>
</div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />12位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>66</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/0638c0af1002647e3f7a">忙しい人のためのA Tour of Go</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-04-15 13:09:47</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Go]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>Go Conference 2013 Springのハンズオンで<a href="http://go-tour-jp.appspot.com/" rel="nofollow noopener" target="_blank">A Tour of Go</a>やったけど目で読んでも頭に入ってこないのでメモりながらやった。</p>

<p>ちょっとしたまとめページになったのでさらっとよんで感触をつかむときには役に立つかもしれないけど、結局は演習などでコード書かないと身につかないことがわかったので時間をつくってちゃんとやった方がいいと思う。</p>

<h2>
<span id="packages" class="fragment"></span><a href="#packages"><i class="fa fa-link"></i></a>Packages</h2>

<ul>
<li>すべてのプログラムは <code>package</code> で構成される</li>
<li>プログラムの処理は <code>main</code> パッケージの <code>main</code> 関数で始まる</li>
<li>他のパッケージは <code>import</code> で取り込める</li>
<li>
<code>import "websocket"</code>のwebsoketは<code>code.google.com/p/go.net/websocket</code>を指している</li>
</ul>

<h2>
<span id="imports" class="fragment"></span><a href="#imports"><i class="fa fa-link"></i></a>Imports</h2>

<ul>
<li>
<code>import</code> は括弧でグループすることができる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="s">"fmt"</span>
<span class="kn">import</span> <span class="s">"math"</span>
</pre></div></div>

<p>↓</p>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="p">(</span>
    <span class="s">"fmt"</span>
    <span class="s">"math"</span>
<span class="p">)</span>
</pre></div></div>

<h2>
<span id="exported-names" class="fragment"></span><a href="#exported-names"><i class="fa fa-link"></i></a>Exported names</h2>

<ul>
<li>インポートしたパッケージが外部に公開(Export)している名前を参照できる</li>
<li>公開する名前は最初の文字が大文字になっている <code>math.Pi</code>
</li>
</ul>

<h2>
<span id="functions" class="fragment"></span><a href="#functions"><i class="fa fa-link"></i></a>Functions</h2>

<ul>
<li>関数は0個以上の引数を取ることができる</li>
<li>変数、戻り値の型は後ろに来る <code>func add(x int, y int) int</code>

<ul>
<li>理由は<a href="http://golang.org/doc/articles/gos_declaration_syntax.html" rel="nofollow noopener" target="_blank">Go's Declaration Syntax</a>を参照</li>
</ul>
</li>
</ul>

<h2>
<span id="functions-continued" class="fragment"></span><a href="#functions-continued"><i class="fa fa-link"></i></a>Functions continued</h2>

<ul>
<li>同じ型の引数の場合は最後の型だけ残して省略できる <code>func add(x, y int) int</code>
</li>
</ul>

<h2>
<span id="multiple-results" class="fragment"></span><a href="#multiple-results"><i class="fa fa-link"></i></a>Multiple results</h2>

<ul>
<li>関数は複数の戻り値を返すことができる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">swap</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">x</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">a</span><span class="p">,</span> <span class="nx">b</span> <span class="o">:=</span> <span class="nx">swap</span><span class="p">(</span><span class="s">"hello"</span><span class="p">,</span> <span class="s">"world"</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="named-results" class="fragment"></span><a href="#named-results"><i class="fa fa-link"></i></a>Named results</h2>

<ul>
<li>複数の戻り値は名前付きで宣言しておくと <code>return</code> だけで返せる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">split</span><span class="p">(</span><span class="nx">sum</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">x</span> <span class="p">=</span> <span class="nx">sum</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">9</span>
    <span class="nx">y</span> <span class="p">=</span> <span class="nx">sum</span> <span class="o">-</span> <span class="nx">x</span>
    <span class="k">return</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">split</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="variables" class="fragment"></span><a href="#variables"><i class="fa fa-link"></i></a>Variables</h2>

<ul>
<li>
<code>var</code> を変数の宣言に使える</li>
<li>同じ型が連続する場合は最後以外は省略可能</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">z</span> <span class="kt">int</span>
<span class="kd">var</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">python</span><span class="p">,</span> <span class="nx">java</span> <span class="kt">bool</span>
</pre></div></div>

<h2>
<span id="variables-with-initializers" class="fragment"></span><a href="#variables-with-initializers"><i class="fa fa-link"></i></a>Variables with initializers</h2>

<ul>
<li>
<code>var</code> 宣言では、変数ひとつひとつに初期値を渡せる <code>var x, y, z int = 1, 2, 3</code>
</li>
<li>初期値によって型を省略することができそのリテラルの型になる <code>var c, python, java = true, false, "no!"</code>
</li>
</ul>

<h2>
<span id="short-variable-declarations" class="fragment"></span><a href="#short-variable-declarations"><i class="fa fa-link"></i></a>Short variable declarations</h2>

<ul>
<li>関数内では <code>var</code> 宣言の代わりに、暗黙的な型宣言ができる <code>:=</code> の代入文を使うことができる <code>c, python, java := true, false, "no!"</code>
</li>
</ul>

<h2>
<span id="basic-types" class="fragment"></span><a href="#basic-types"><i class="fa fa-link"></i></a>Basic types</h2>

<ul>
<li>基本型（組み込み型）</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kt">bool</span>
<span class="kt">string</span>
<span class="kt">int</span>  <span class="kt">int8</span>  <span class="kt">int16</span>  <span class="kt">int32</span>  <span class="kt">int64</span>
<span class="kt">uint</span> <span class="kt">uint8</span> <span class="kt">uint16</span> <span class="kt">uint32</span> <span class="kt">uint64</span> <span class="kt">uintptr</span>
<span class="kt">byte</span> <span class="c1">// uint8 の別名</span>
<span class="kt">rune</span> <span class="c1">// int32 の別名</span>
     <span class="c1">// Unicode のコードポイントを表す</span>
<span class="kt">float32</span> <span class="kt">float64</span>
<span class="kt">complex64</span> <span class="kt">complex128</span>
</pre></div></div>

<h2>
<span id="constants-numeric-constants" class="fragment"></span><a href="#constants-numeric-constants"><i class="fa fa-link"></i></a>Constants, Numeric Constants</h2>

<ul>
<li>
<code>const</code> キーワードを使い定数を宣言できる <code>const Pi = 3.14</code>
</li>
<li>型としてはcharacter、string、boolean、数値(numeric)のみで使える</li>
<li>数値定数は高精度な値である</li>
<li>型のない定数は、その状況によって必要な型を取る</li>
</ul>

<h2>
<span id="for" class="fragment"></span><a href="#for"><i class="fa fa-link"></i></a>For</h2>

<ul>
<li>繰り返し文は <code>for</code> だけで while文 はない</li>
<li>括弧 <code>()</code> は不要で中括弧 <code>{}</code> は必要</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span>    <span class="nx">sum</span> <span class="o">:=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="nx">sum</span> <span class="o">+=</span> <span class="nx">i</span>
    <span class="p">}</span>
</pre></div></div>

<h2>
<span id="for-continued-for-is-gos-while" class="fragment"></span><a href="#for-continued-for-is-gos-while"><i class="fa fa-link"></i></a>For continued, For is Go's "while"</h2>

<ul>
<li>
<code>for</code> の条件の前後は省略可能 <code>for sum &lt; 1000 {}</code>
</li>
<li>
<code>;</code> も省略できるのでこれが while の代わりになる</li>
<li>ループ条件も省略して <code>for {}</code> にすれば無限ループになる</li>
</ul>

<h2>
<span id="if-if-with-a-short-statement-if-and-else" class="fragment"></span><a href="#if-if-with-a-short-statement-if-and-else"><i class="fa fa-link"></i></a>If, If with a short statement, If and else</h2>

<ul>
<li>
<code>if</code> は 括弧 <code>()</code> は不要で中括弧 <code>{}</code>は必要 <code>if x &lt; 0 {}</code>
</li>
<li>
<code>if</code> も <code>for</code> のように条件の前にステートメントを記述できる <code>if v := math.Pow(x, n); v &lt; lim {}</code>
</li>
<li>そのステートメントで宣言された変数は <code>if</code> および <code>else</code> ブロック内で有効になる</li>
</ul>

<h2>
<span id="structs-struct-fields" class="fragment"></span><a href="#structs-struct-fields"><i class="fa fa-link"></i></a>Structs, Struct Fields</h2>

<ul>
<li>構造体 <code>struct</code> はフィールドの集まり</li>
<li>フィールドは <code>.</code> でアクセスする <code>v.X = 4</code>
</li>
<li>
<code>type</code> 宣言できる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Vertex</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">X</span> <span class="kt">int</span>
    <span class="nx">Y</span> <span class="kt">int</span>
<span class="p">}</span>
<span class="nx">Vertex</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}</span>
</pre></div></div>

<h2>
<span id="pointers" class="fragment"></span><a href="#pointers"><i class="fa fa-link"></i></a>Pointers</h2>

<ul>
<li>ポインタはあるがポインタ演算はない</li>
<li>構造体のポインタを渡して <code>.</code> でフィールドにアクセスできる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="nx">p</span> <span class="o">:=</span> <span class="nx">Vertex</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">}</span>
<span class="nx">q</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">p</span>
<span class="nx">q</span><span class="p">.</span><span class="nx">X</span> <span class="p">=</span> <span class="mf">1e9</span>
</pre></div></div>

<h2>
<span id="struct-literals" class="fragment"></span><a href="#struct-literals"><i class="fa fa-link"></i></a>Struct Literals</h2>

<ul>
<li>
<code>struct</code> リテラルは <code>Name:</code> 構文を使って初期化できる <code>r = Vertex{X: 1}</code>
</li>
<li>
<code>Name:</code> 構文を使った場合は指定順序は無関係になる</li>
<li>接頭辞 <code>&amp;</code> は <code>struct</code> リテラルへのポインタを示す <code>q = &amp;Vertex{1, 2}</code>
</li>
</ul>

<h2>
<span id="the-new-function" class="fragment"></span><a href="#the-new-function"><i class="fa fa-link"></i></a>The new function</h2>

<ul>
<li>
<code>new(T)</code> という表現は、ゼロ初期化した <code>T</code> の値をメモリに割り当て、そのポインタを返す</li>
<li>
<code>var t *T = new(T)</code> または <code>t := new(T)</code> と書ける </li>
</ul>

<h2>
<span id="slices" class="fragment"></span><a href="#slices"><i class="fa fa-link"></i></a>Slices</h2>

<ul>
<li>Goの配列表現sliceは値の配列を参照し、長さも含む</li>
<li>
<code>T</code> 型要素のsliceは <code>[]T</code> となる <code>p := []int{2, 3, 5, 7, 11, 13}</code>
</li>
</ul>

<h2>
<span id="slicing-slices" class="fragment"></span><a href="#slicing-slices"><i class="fa fa-link"></i></a>Slicing slices</h2>

<ul>
<li>
<code>s[lo:hi]</code>のように範囲を指定してsliceからsliceを作成できる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="nx">p</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">7</span> <span class="mi">11</span> <span class="mi">13</span><span class="p">]</span>
<span class="nx">p</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">3</span> <span class="mi">5</span> <span class="mi">7</span><span class="p">]</span>
<span class="nx">p</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">5</span><span class="p">]</span>
<span class="nx">p</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">11</span> <span class="mi">13</span><span class="p">]</span>
</pre></div></div>

<h2>
<span id="making-slices" class="fragment"></span><a href="#making-slices"><i class="fa fa-link"></i></a>Making slices</h2>

<ul>
<li>
<code>make</code> 関数はゼロ初期化した配列をメモリに割り当て、その配列を参照したsliceを返す <code>a := make([]int, 5)</code>
</li>
<li>sliceは、長さと容量を持っており、容量より長くすることはできない</li>
<li>長さは <code>len(a)</code> 容量は <code>cap(a)</code> 関数をつかって調べられる</li>
<li>容量を指定するには <code>make</code> の <strong>3</strong> 番目の引数を使う <code>b := make([]int, 0, 5) // len(b)=0, cap(b)=5</code>

<ul>
<li>省略した場合、容量は長さと同じになる</li>
</ul>
</li>
<li>容量はre-slicingによって縮小することがある</li>
</ul>

<h2>
<span id="nil-slices" class="fragment"></span><a href="#nil-slices"><i class="fa fa-link"></i></a>Nil slices</h2>

<ul>
<li>
<code>var z []int</code> などで宣言したsliceの初期値は <code>nil</code> </li>
<li>
<code>nil</code>な sliceの長さと容量を <code>len(z), cap(z)</code> で計算した時の値は <strong>0</strong> である</li>
</ul>

<h2>
<span id="range" class="fragment"></span><a href="#range"><i class="fa fa-link"></i></a>Range</h2>

<ul>
<li>
<code>for</code> ループの <code>range</code> はsliceやmapを1つずつ反復処理する</li>
<li>あとからでてくるチャネルからも1つずつ処理できる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">pow</span> <span class="p">=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">pow</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">"2**%d = %d\n"</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="range-continued" class="fragment"></span><a href="#range-continued"><i class="fa fa-link"></i></a>Range continued</h2>

<ul>
<li>
<code>range</code> で受け取ったインデックスや値を使わない場合は <code>_</code> へ代入することで破棄することができる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span>    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">value</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">pow</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">"%d\n"</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">pow</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">"%d\n"</span><span class="p">,</span> <span class="nx">pow</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span>
    <span class="p">}</span>
</pre></div></div>

<h2>
<span id="maps" class="fragment"></span><a href="#maps"><i class="fa fa-link"></i></a>Maps</h2>

<ul>
<li>map はキーと値とを関連付ける <code>var m map[string]Vertex</code>
</li>
<li>mapはsliceでも使った <code>make</code> 関数で作成する</li>
<li>makeで作成するまでの <code>nil</code> のmapは空なので要素を割り当てられない <code>m = make(map[string]Vertex)</code>
</li>
</ul>

<h2>
<span id="map-literals-map-literals-continued" class="fragment"></span><a href="#map-literals-map-literals-continued"><i class="fa fa-link"></i></a>Map literals, Map literals continued</h2>

<ul>
<li>mapリテラルは、structリテラルに似ているがキーが必要</li>
<li>
<code>string</code> がキーで、<code>struct</code> が値のmapのリテラルは以下のようになる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Vertex</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Lat</span><span class="p">,</span> <span class="nx">Long</span> <span class="kt">float64</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">m</span> <span class="p">=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Vertex</span><span class="p">{</span>
    <span class="s">"Bell Labs"</span><span class="p">:</span> <span class="nx">Vertex</span><span class="p">{</span>
        <span class="mf">40.68433</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.39967</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s">"Google"</span><span class="p">:</span> <span class="nx">Vertex</span><span class="p">{</span>
        <span class="mf">37.42202</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.08408</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div></div>

<ul>
<li>リテラルの要素から型が推定できる場合は型名を以下のように省略可能</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">m</span> <span class="p">=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Vertex</span><span class="p">{</span>
    <span class="s">"Bell Labs"</span><span class="p">:</span> <span class="p">{</span><span class="mf">40.68433</span><span class="p">,</span> <span class="o">-</span><span class="mf">74.39967</span><span class="p">},</span>
    <span class="s">"Google"</span><span class="p">:</span>    <span class="p">{</span><span class="mf">37.42202</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.08408</span><span class="p">},</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="mutating-maps" class="fragment"></span><a href="#mutating-maps"><i class="fa fa-link"></i></a>Mutating Maps</h2>

<ul>
<li>map <code>m</code> へ要素(elem)の挿入や更新は：<code>m[key] = elem</code>
</li>
<li>要素の取り出しは：<code>elem = m[key]</code>
</li>
<li>要素の削除は：<code>delete(m, key)</code>
</li>
<li>キーが存在するかどうかは、２つの値の代入で確認する <code>elem, ok = m[key]</code>

<ul>
<li>キーが存在しない場合は ok は <code>false</code> になり、elemは要素の型のゼロ値になる</li>
</ul>
</li>
</ul>

<h2>
<span id="function-values" class="fragment"></span><a href="#function-values"><i class="fa fa-link"></i></a>Function values</h2>

<ul>
<li>関数も変数として扱える <code>hypot := func(x, y float64) float64 { return math.Sqrt(x*x + y*y) }</code>
</li>
<li>関数そのものを関数の引数とすることもできる</li>
</ul>

<h2>
<span id="function-closures" class="fragment"></span><a href="#function-closures"><i class="fa fa-link"></i></a>Function closures</h2>

<ul>
<li>関数はclosureである</li>
<li>関数が変数として代入されたスコープの関数外の変数を使える</li>
</ul>

<h2>
<span id="switch-switch-evaluation-order" class="fragment"></span><a href="#switch-switch-evaluation-order"><i class="fa fa-link"></i></a>Switch, Switch evaluation order</h2>

<ul>
<li>
<code>switch</code> は <code>case</code> の最後で自動的にbreakする</li>
<li>
<code>case</code> には式も書けて上から下へ <code>case</code> を評価する</li>
<li>brakeせずに次の <code>case</code> のブロックへ通したい場合は<code>fallthrough</code>を入れる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span>   <span class="k">case</span> <span class="s">"linux"</span><span class="p">:</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"Linux."</span><span class="p">)</span>
        <span class="k">fallthrough</span>
</pre></div></div>

<h2>
<span id="switch-with-no-condition" class="fragment"></span><a href="#switch-with-no-condition"><i class="fa fa-link"></i></a>Switch with no condition</h2>

<ul>
<li>条件のない <code>switch</code> は <code>switch true</code> と同じになる</li>
<li>長いif-then-elseのつながりをシンプルに表現できる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span>    <span class="nx">t</span> <span class="o">:=</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">()</span>
    <span class="k">switch</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Hour</span><span class="p">()</span> <span class="p">&lt;</span> <span class="mi">12</span><span class="p">:</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"Good morning!"</span><span class="p">)</span>
    <span class="k">case</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Hour</span><span class="p">()</span> <span class="p">&lt;</span> <span class="mi">17</span><span class="p">:</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"Good afternoon."</span><span class="p">)</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"Good evening."</span><span class="p">)</span>
    <span class="p">}</span>
</pre></div></div>

<h2>
<span id="methods-methods-with-pointer-receivers" class="fragment"></span><a href="#methods-methods-with-pointer-receivers"><i class="fa fa-link"></i></a>Methods, Methods with pointer receivers</h2>

<ul>
<li>Goにはクラスはないが <code>struct</code> にメソッドを定義できる</li>
<li>メソッドレシーバを <code>func</code> キーワードとメソッド名の間で、それ自身の引数リストで表現する (下記の例では <code>(v *Vertex)</code> )</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Vertex</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">X</span><span class="p">,</span> <span class="nx">Y</span> <span class="kt">float64</span>
<span class="p">}</span>
<span class="c1">// Vertex.Absメソッド</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">v</span> <span class="o">*</span><span class="nx">Vertex</span><span class="p">)</span> <span class="nx">Abs</span><span class="p">()</span> <span class="kt">float64</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">math</span><span class="p">.</span><span class="nx">Sqrt</span><span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">X</span><span class="o">*</span><span class="nx">v</span><span class="p">.</span><span class="nx">X</span> <span class="o">+</span> <span class="nx">v</span><span class="p">.</span><span class="nx">Y</span><span class="o">*</span><span class="nx">v</span><span class="p">.</span><span class="nx">Y</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">v</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Vertex</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">v</span><span class="p">.</span><span class="nx">Abs</span><span class="p">())</span>
<span class="p">}</span>
</pre></div></div>

<ul>
<li>ポインタのメソッドレシーバを使うのはメソッド呼び出し時に値をコピーによるオーバヘッドを避けるためと<code>struct</code> のフィールドの内容を更新するためがある</li>
</ul>

<h2>
<span id="methods-continued" class="fragment"></span><a href="#methods-continued"><i class="fa fa-link"></i></a>Methods continued</h2>

<ul>
<li>
<code>struct</code> だけではなくパッケージ内で任意の型にもメソッドを定義できる</li>
<li>ただし他のパッケージからの型や基本型 <strong>以外</strong> に限る</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">MyFloat</span> <span class="kt">float64</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">MyFloat</span><span class="p">)</span> <span class="nx">Abs</span><span class="p">()</span> <span class="kt">float64</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">f</span> <span class="p">&lt;</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">float64</span><span class="p">(</span><span class="o">-</span><span class="nx">f</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">float64</span><span class="p">(</span><span class="nx">f</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">f</span> <span class="o">:=</span> <span class="nx">MyFloat</span><span class="p">(</span><span class="o">-</span><span class="nx">math</span><span class="p">.</span><span class="nx">Sqrt2</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">Abs</span><span class="p">())</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="interfaces" class="fragment"></span><a href="#interfaces"><i class="fa fa-link"></i></a>Interfaces</h2>

<ul>
<li>インターフェース型はメソッド群を定義する</li>
<li>インターフェース型で宣言した変数は、それらのメソッドを実装する型の値を持つことができる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Abser</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">Abs</span><span class="p">()</span> <span class="kt">float64</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="interfaces-are-satisfied-implicitly" class="fragment"></span><a href="#interfaces-are-satisfied-implicitly"><i class="fa fa-link"></i></a>Interfaces are satisfied implicitly</h2>

<ul>
<li>型は（インターフェース型が定義した）メソッドを実装することでインターフェースを実装したことになり、明示的にインターフェースを持っていることを定義する必要がない</li>
<li>この暗黙的なインターフェースはインターフェースを定義するパッケージから実装するパッケージを分離することができ、他に依存しない</li>
<li>インタフェースのすべての実装を見つける必要もないし、新しいインターフェースの名前でそのインタフェースを関連付ける必要もないので、正確なインターフェースの定義を推奨する</li>
</ul>

<h2>
<span id="errors" class="fragment"></span><a href="#errors"><i class="fa fa-link"></i></a>Errors</h2>

<ul>
<li>エラーは文字列でエラーそのものを説明する</li>
<li>
<code>error</code> インターフェースの <code>Error</code> メソッドを定義することで表現する</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="kt">error</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">Error</span><span class="p">()</span> <span class="kt">string</span>
<span class="p">}</span>
</pre></div></div>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">MyError</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">When</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span>
    <span class="nx">What</span> <span class="kt">string</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">e</span> <span class="o">*</span><span class="nx">MyError</span><span class="p">)</span> <span class="nx">Error</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">"at %v, %s"</span><span class="p">,</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">When</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">What</span><span class="p">)</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="web-servers" class="fragment"></span><a href="#web-servers"><i class="fa fa-link"></i></a>Web servers</h2>

<ul>
<li>
<code>http</code> パッケージはHTTPリクエストの処理を行うための<code>http.Handler</code> インターフェースを定義する</li>
<li>
<code>http.Handler</code> インターフェースを実装することで HTTPリクエストの処理機能を提供することができる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">Hello</span> <span class="kd">struct</span><span class="p">{}</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">h</span> <span class="nx">Hello</span><span class="p">)</span> <span class="nx">ServeHTTP</span><span class="p">(</span>
    <span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span>
    <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">"Hello!"</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">h</span> <span class="nx">Hello</span>
    <span class="nx">http</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">(</span><span class="s">"localhost:4000"</span><span class="p">,</span> <span class="nx">h</span><span class="p">)</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="images" class="fragment"></span><a href="#images"><i class="fa fa-link"></i></a>Images</h2>

<ul>
<li>
<code>image</code> パッケージは、以下の <code>Image</code> インターフェースを定義する</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">image</span>
<span class="kd">type</span> <span class="nx">Image</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">ColorModel</span><span class="p">()</span> <span class="nx">color</span><span class="p">.</span><span class="nx">Model</span>
    <span class="nx">Bounds</span><span class="p">()</span> <span class="nx">Rectangle</span>
    <span class="nx">At</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="kt">int</span><span class="p">)</span> <span class="nx">color</span><span class="p">.</span><span class="nx">Color</span>
<span class="p">}</span>
</pre></div></div>

<ul>
<li>詳細は <a href="http://golang.org/pkg/image/#Image" rel="nofollow noopener" target="_blank">ドキュメント</a> を参照</li>
<li>
<code>color.Color</code> と <code>color.Model</code> は共にインターフェースで、実装としては定義済みの <code>color.RGBA</code> と <code>color.RGBAModel</code> を使うことができる</li>
</ul>

<h2>
<span id="goroutines" class="fragment"></span><a href="#goroutines"><i class="fa fa-link"></i></a>Goroutines</h2>

<ul>
<li>goroutineは、Goのランタイムに管理される軽量なスレッド、<code>main</code> 関数もgoroutineで実行される</li>
<li>
<code>main</code> 関数のgoroutineの処理が終わると他のgroutineが実行中でもプロセスが終了する</li>
<li>
<code>go f(x, y, z)</code>と書くと 関数f は新しいgoroutine上で実行される</li>
<li>x,y,zの値の評価は現在のgoroutineで発生しfの実行は、新しいgoroutineで行われる</li>
<li>goroutineは同じアドレス空間で実行されるため、共有メモリへのアクセスはきちんと同期する必要がある</li>
<li>同期の方法に<a href="http://golang.org/pkg/sync/" rel="nofollow noopener" target="_blank">sync</a> パッケージがあるが、Goでは以降の章のものがあるのであまり必要されない</li>
</ul>

<h2>
<span id="channels" class="fragment"></span><a href="#channels"><i class="fa fa-link"></i></a>Channels</h2>

<ul>
<li>チャネルはチャネルオペレータの &lt;- を用いて値の送受信ができる直通ルートの型</li>
<li>
<code>map</code>, <code>slice</code>と同じく <code>make</code> 関数で生成する <code>ch := make(chan int)</code>
</li>
<li>送受信する値の型の前に <code>chan</code> をつける</li>
<li>デフォルトでは片方が準備できるまで送受信はブロックする(goroutineの処理がそこで止まる)</li>
<li>これは明確なロックや条件変数がなくてもgoroutineの同期を許す</li>
<li>データは矢印の方向に流れる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="nx">ch</span> <span class="o">&lt;-</span> <span class="nx">v</span>    <span class="c1">// v をチャネル ch へ送る。</span>
<span class="nx">v</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">ch</span>  <span class="c1">// ch から受信し、</span>
           <span class="c1">// 変数を v へ割り当てる</span>
</pre></div></div>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">sum</span><span class="p">(</span><span class="nx">a</span> <span class="p">[]</span><span class="kt">int</span><span class="p">,</span> <span class="nx">c</span> <span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">sum</span> <span class="o">:=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">a</span> <span class="p">{</span>
        <span class="nx">sum</span> <span class="o">+=</span> <span class="nx">v</span>
    <span class="p">}</span>
    <span class="nx">c</span> <span class="o">&lt;-</span> <span class="nx">sum</span> <span class="c1">// send sum to c</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">a</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span>
    <span class="nx">c</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">sum</span><span class="p">(</span><span class="nx">a</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="nx">c</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">sum</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">:],</span> <span class="nx">c</span><span class="p">)</span>
    <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">c</span><span class="p">,</span> <span class="o">&lt;-</span><span class="nx">c</span> <span class="c1">// receive from c</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">x</span><span class="o">+</span><span class="nx">y</span><span class="p">)</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="buffered-channels" class="fragment"></span><a href="#buffered-channels"><i class="fa fa-link"></i></a>Buffered Channels</h2>

<ul>
<li>チャネルはバッファでき、送信した値をためておける</li>
<li>
<code>make</code> 関数の第2引数でバッファの長さを指定できる <code>ch := make(chan int, 100)</code>
</li>
<li>バッファがいっぱいになったチャネルへの送信はブロックする</li>
<li>バッファが空のチャネルには受信をブロックする</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">c</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nx">c</span> <span class="o">&lt;-</span> <span class="mi">1</span>
    <span class="nx">c</span> <span class="o">&lt;-</span> <span class="mi">2</span> <span class="c1">// バッファがいっぱいになる</span>
    <span class="nx">c</span> <span class="o">&lt;-</span> <span class="mi">3</span> <span class="c1">// バッファがいっぱいなので送信がブロックされmainのgoroutinesが止まりデットロック</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">c</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">c</span><span class="p">)</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="range-and-close" class="fragment"></span><a href="#range-and-close"><i class="fa fa-link"></i></a>Range and Close</h2>

<ul>
<li>送り手はこれ以上の送信する値がないことを示すため <code>close(ch)</code> でチャネルを閉じることができる</li>
<li>受け手は受信の式の2つ目のパラメータが <code>false</code> かどうかで送り手が閉じたかどうかをテストできる <code>v, ok := &lt;-ch</code>
</li>
<li>
<code>for i := range c</code> はチャネル <code>c</code> が閉じるまで繰り返し値を受信する</li>
<li>閉じたチャネルに送信するとpanicになるため受け手が勝手にチャネルを閉じると危険である</li>
<li>チャネルは通常は閉じなくてよい</li>
<li>チャネルを閉じないといけないの <code>range</code> ループなどで受け手が送信側の終了を判断しないといけないとき</li>
</ul>

<h2>
<span id="select" class="fragment"></span><a href="#select"><i class="fa fa-link"></i></a>Select</h2>

<ul>
<li>
<code>select</code> ステートメントはgoroutineを複数の通信操作で待たせる</li>
<li>
<code>select</code> は <code>case</code> の条件で通信が実行できるまでブロックし、条件が一致すれば <code>case</code> の中の処理を実行する</li>
<li>以下の例では <code>main</code> 関数と無名関数を処理する２つのgoroutineがあり、<code>main</code> 側のgoroutineは <code>func fibonacci</code> 内の <code>select</code> でブロックする。無名関数を処理するgoroutineが <code>c</code> からの受信、<code>quite</code> の送信を行うことと <code>main</code> 側のgoroutineで <code>case</code> 内の処理が実行され、 <code>quite</code> を受信した際に <code>return</code> し、<code>main</code> 関数のgoroutineが処理を終える</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">quit</span> <span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="k">select</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">c</span> <span class="o">&lt;-</span> <span class="nx">x</span><span class="p">:</span>
            <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="p">=</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">x</span><span class="o">+</span><span class="nx">y</span>
        <span class="k">case</span> <span class="o">&lt;-</span><span class="nx">quit</span><span class="p">:</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"quit"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">c</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span>
    <span class="nx">quit</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">)</span>
    <span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="o">&lt;-</span><span class="nx">c</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nx">quit</span> <span class="o">&lt;-</span> <span class="mi">0</span>
    <span class="p">}()</span>
    <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">quit</span><span class="p">)</span>
<span class="p">}</span>
</pre></div></div>

<h2>
<span id="default-selection" class="fragment"></span><a href="#default-selection"><i class="fa fa-link"></i></a>Default Selection</h2>

<ul>
<li>
<code>select</code> を評価したときにどの <code>case</code> にも一致しないのであれば <code>default</code>が実行される</li>
<li>
<code>select</code> でブロックしたくないときは <code>default</code> を使うことができる</li>
</ul>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">tick</span> <span class="o">:=</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Tick</span><span class="p">(</span><span class="mf">1e8</span><span class="p">)</span>
    <span class="nx">boom</span> <span class="o">:=</span> <span class="nx">time</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="mf">5e8</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="k">select</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">&lt;-</span><span class="nx">tick</span><span class="p">:</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"tick."</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">&lt;-</span><span class="nx">boom</span><span class="p">:</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"BOOM!"</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">default</span><span class="p">:</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"    ."</span><span class="p">)</span>
            <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">5e7</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />13位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>62</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/e6afe3c03abf3d3ff63e">CompassでTwitter Bootstrapの見た目をカスタマイズ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-03-18 11:26:00</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[HTML5]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="http://twitter.github.com/bootstrap/index.html" rel="nofollow noopener" target="_blank">Twitter Bootstrap</a>をダウンロードして使っていたけどやっぱりカスタマイズしたくなった。それもCompass使ってSassで管理したい。</p>

<h2>
<span id="前提" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90"><i class="fa fa-link"></i></a>前提</h2>

<ul>
<li>
<a href="http://compass-style.org/" rel="nofollow noopener" target="_blank">Compass</a>使うのでRubyが必要 (Rubyのセットアップは割愛)</li>
<li>使うアプリケーションのフレームワークに依存せず単独で使う(Ruby以外のプロジェクトでも使う)</li>
<li>カスタマイズはcssのみ、javascriptは対象外</li>
</ul>

<h2>
<span id="sass版を探す" class="fragment"></span><a href="#sass%E7%89%88%E3%82%92%E6%8E%A2%E3%81%99"><i class="fa fa-link"></i></a>Sass版を探す</h2>

<p><a href="https://github.com/twitter/bootstrap" rel="nofollow noopener" target="_blank">github.com/twitter/bootstrap</a>はLessファイルで公開されているのでSassにしてくれてる人を探す。</p>

<p><a href="http://tatiyants.com/compass-or-twitter-bootstrap-why-not-both/" rel="nofollow noopener" target="_blank">Compass or Twitter Bootstrap? Why Not Both</a>より</p>

<ul>
<li><a href="https://github.com/thomas-mcdonald/bootstrap-sass" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/thomas-mcdonald/bootstrap-sass</a></li>
<li><a href="https://github.com/jlong/sass-twitter-bootstrap" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/jlong/sass-twitter-bootstrap</a></li>
</ul>

<p>を知る。他にもありそうだけどとりあえず☆の多いマクドナルドさんの方（以後bootstrap-sassと表記)を使う。</p>

<h2>
<span id="環境セットアップ" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>環境セットアップ</h2>

<p>Compassとbootstrap-sassをインストールする。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>gem install compass
gem install bootstrap-sass
</pre></div></div>

<p>rbenvを使っている場合はcompassコマンドを使うために<code>rbenv rehash</code>しておく</p>

<h2>
<span id="compassプロジェクトのセットアップ" class="fragment"></span><a href="#compass%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>Compassプロジェクトのセットアップ</h2>

<p>ディレクトリをTwittter Bootstrapのビルドに合わせる。以下の例はカレントディレクトリに作成する例。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>compass create . -r bootstrap-sass --using bootstrap --css-dir css --images-dir img --javascripts-dir js
</pre></div></div>

<p>Compass作成済みのプロジェクトに追加する場合、以下のコマンドで追加することもできる。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>compass install bootstrap
</pre></div></div>

<p>--sass-dirも指定できるのでプロジェクトファイルと出力ファイルを分けることも可能。例えば以下のような感じ。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>mkdir sass
<span class="nb">cd</span> sass
compass create . -r bootstrap-sass --using bootstrap --sass-dir . --css-dir ../web/css --images-dir ../web/img --javascripts-dir ../web/js
</pre></div></div>

<p>デフォルトだと*-dirの値が使われるのでconfig.rb内でhttp_*_pathを指定しておく。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">config.rb</span></div>
<div class="highlight"><pre><span></span><span class="n">http_stylesheets_path</span> <span class="o">=</span> <span class="s2">"/css"</span>
<span class="n">http_images_path</span> <span class="o">=</span> <span class="s2">"/img"</span>
<span class="n">http_javascripts_path</span> <span class="o">=</span> <span class="s2">"/js"</span>
</pre></div>
</div>

<h2>
<span id="twitter-bootstrapのカスタマイズ" class="fragment"></span><a href="#twitter-bootstrap%E3%81%AE%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA"><i class="fa fa-link"></i></a>Twitter Bootstrapのカスタマイズ</h2>

<p>bootstrap-sassでは変数が <a href="http://getbootstrap.com/2.3.2/customize.html#variables" class="autolink" rel="nofollow noopener" target="_blank">http://getbootstrap.com/2.3.2/customize.html#variables</a> と同じ名前で定義されている。ありがたい。従って、例えば背景を黒にするにはbodyBackground変数を使って以下のように書ける。</p>

<div class="code-frame" data-lang="sass">
<div class="code-lang"><span class="bold">styles.sass</span></div>
<div class="highlight"><pre><span></span><span class="nv">$bodyBackground</span><span class="o">:</span> <span class="ni">black</span><span class="err">;</span>
<span class="k">@import</span> <span class="s">"bootstrap";</span>
</pre></div>
</div>

<p>( v3から変数名のコーディングルールが変わっているので注意。<code>$bodyBackground</code> → <code>$body-bg</code> など )</p>

<h2>
<span id="ブラウザから確認" class="fragment"></span><a href="#%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%81%8B%E3%82%89%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>ブラウザから確認</h2>

<p><code>compass watch</code>でプロジェクトのディレクトリを指定すればsassファイルの変更を監視してcssファイルを作成してくれる。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>compass watch &lt;dir&gt;
</pre></div></div>

<p>bootstrap-sassのデフォルトでは <em>styles.css</em> が出力ファイルになるのでそれをhtml側で指定すればいい。</p>

<h2>
<span id="javascript" class="fragment"></span><a href="#javascript"><i class="fa fa-link"></i></a>Javascript</h2>

<p>Compass単体だとどうにもならないのでとりあえず<a href="http://twitter.github.com/bootstrap/index.html" rel="nofollow noopener" target="_blank">Twitter Bootstrap</a>ビルド済みのbootstrap.min.jsをそのまま使っている。</p>

<p>bowerでインストールして、Sprocketsをコマンドラインで叩くことを模索中。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />14位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>61</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/4dc3b726ecb0878397d0">Objective-C 非同期処理のCallbackをBlocksで同時に渡す</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-04-01 13:05:40</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>非同期処理を完了したあとの処理をdelegateでやっていたが、Blocksを使って非同期処理メソッドの引数に完了処理を渡すようにしてプログラムをわかりやすくしたい。SDKでやっているクラスを参考にしよう。</p>

<h2>
<span id="sdkのcompletionhandlerの使用例" class="fragment"></span><a href="#sdk%E3%81%AEcompletionhandler%E3%81%AE%E4%BD%BF%E7%94%A8%E4%BE%8B"><i class="fa fa-link"></i></a>SDKのCompletionHandlerの使用例</h2>

<p>CompletionHandlerでSDKを検索。blocksの宣言は可読性がないので以下のようにtypedefしているパターンが多い。</p>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">^</span><span class="n">CLGeocodeCompletionHandler</span><span class="p">)(</span><span class="bp">NSArray</span> <span class="o">*</span><span class="n">placemark</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">);</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">reverseGeocodeLocation:</span><span class="p">(</span><span class="bp">CLLocation</span> <span class="o">*</span><span class="p">)</span><span class="nv">location</span> <span class="nf">completionHandler:</span><span class="p">(</span><span class="n">CLGeocodeCompletionHandler</span><span class="p">)</span><span class="nv">completionHandler</span>
</pre></div></div>

<p>SLComposeViewControllerのようにプロパティで持てるようにしているものもあった。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">SLComposeViewController.h</span></div>
<div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">^</span><span class="n">SLComposeViewControllerCompletionHandler</span><span class="p">)(</span><span class="n">SLComposeViewControllerResult</span> <span class="n">result</span><span class="p">);</span> 
<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">copy</span><span class="p">)</span> <span class="n">SLComposeViewControllerCompletionHandler</span> <span class="n">completionHandler</span>
</pre></div>
</div>

<p>個人的にはメソッド呼び出し時に終了処理をかけないのは魅力半減なので呼び出しメソッドの引数にblockを渡せる方がいい。</p>

<p>というわけで流れとしては</p>

<h2>
<span id="1-typepefする" class="fragment"></span><a href="#1-typepef%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>1. typepefする</h2>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="nf">void</span> <span class="p">(</span><span class="o">^</span><span class="n">MYCompletionHandler</span><span class="p">)(</span><span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">);</span>
</pre></div></div>

<h2>
<span id="2-メソッドを宣言する" class="fragment"></span><a href="#2-%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E5%AE%A3%E8%A8%80%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>2. メソッドを宣言する</h2>

<p>SDKを真似る。</p>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">executeAsyncWithCompletionHandle:</span><span class="p">(</span><span class="n">MYCompletionHandler</span><span class="p">)</span><span class="nv">completionHandler</span><span class="p">;</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">executeAsyncWithObject:</span><span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nv">obj</span> <span class="nf">completionHandler:</span><span class="p">(</span><span class="n">MYCompletionHandler</span><span class="p">)</span><span class="nv">completionHandler</span><span class="p">;</span>
</pre></div></div>

<h2>
<span id="3-メソッドを実装する" class="fragment"></span><a href="#3-%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89%E3%82%92%E5%AE%9F%E8%A3%85%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>3. メソッドを実装する</h2>

<p>SDKのコードは見れないので想像。ARC有効。どのqueueで非同期処理するかは処理に応じて考えるべし。</p>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span><span class="k">@implementation</span> <span class="nc">ViewController</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">viewDidLoad</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">viewDidLoad</span><span class="p">];</span>
    <span class="p">[</span><span class="nb">self</span> <span class="nl">executeAsyncWithCompletionHandler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"in CompletionHandle"</span><span class="p">);</span>
    <span class="p">}];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">executeSync:</span><span class="p">(</span><span class="bp">NSError</span> <span class="o">**</span><span class="p">)</span><span class="nv">error</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">executeAsyncWithCompletionHandler:</span><span class="p">(</span><span class="n">MYCompletionHandler</span><span class="p">)</span><span class="nv">completionHandler</span><span class="p">;</span>
<span class="p">{</span>
    <span class="k">__weak</span> <span class="n">ViewController</span> <span class="o">*</span><span class="n">me</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
    <span class="n">dispatch_async</span><span class="p">(</span><span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">^</span><span class="p">{</span>
        <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
        <span class="p">[</span><span class="n">me</span> <span class="nl">executeSync</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>
        <span class="n">completionHandler</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="k">@end</span>
</pre></div></div>

<h2>
<span id="completionhandlerはどのqueueで呼び出すか" class="fragment"></span><a href="#completionhandler%E3%81%AF%E3%81%A9%E3%81%AEqueue%E3%81%A7%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%99%E3%81%8B"><i class="fa fa-link"></i></a>completionHandlerはどのqueueで呼び出すか？</h2>

<p>completionHandlerはどのスレッドで処理するのかが悩みどころ。試しに以下のようにdispatch_get_current_queueを使って呼び出しスレッドで処理するようにしてみようとしたらdispatch_get_current_queueはiOS6では非推奨になっていた。</p>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">executeAsyncWithCompletionHandler:</span><span class="p">(</span><span class="n">MYCompletionHandler</span><span class="p">)</span><span class="nv">completionHandler</span><span class="p">;</span>
<span class="p">{</span>
    <span class="k">__weak</span> <span class="n">ViewController</span> <span class="o">*</span><span class="n">me</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
    <span class="c1">// 'dispatch_get_current_queue' is deprecated: first deprecated in iOS 6.0</span>
    <span class="n">dispatch_queue_t</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">dispatch_get_current_queue</span><span class="p">();</span>
    <span class="n">dispatch_async</span><span class="p">(</span><span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">DISPATCH_QUEUE_PRIORITY_DEFAULT</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">^</span><span class="p">{</span>
        <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
        <span class="p">[</span><span class="n">me</span> <span class="nl">executeSync</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>
        <span class="n">dispatch_async</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="o">^</span><span class="p">{</span>
            <span class="n">completionHandler</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div></div>

<p>dispatch_get_current_queueを使わないとするとなんらかのqueueを明示的に指定せざるをえない。</p>

<p>非同期処理はそのクラス内部で別スレッドを起こしているからコールバックをどのスレッドで処理するのを考えるかは呼び出し元の責任・・・、と今まで考えていたのだがglobal_main_queueでcompletionHandlerを呼び出してあげたほうがいいのだろうか？</p>

<p>と書いていたらコメントを頂いたので追記。SDKの中には受け取ったBlockを実行するqueueを引数に取るものがある。</p>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span><span class="c1">// NSURLConnection.h</span>
<span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">sendAsynchronousRequest:</span><span class="p">(</span><span class="bp">NSURLRequest</span> <span class="o">*</span><span class="p">)</span><span class="nv">request</span> <span class="nf">queue:</span><span class="p">(</span><span class="bp">NSOperationQueue</span> <span class="o">*</span><span class="p">)</span><span class="nv">queue</span> <span class="nf">completionHandler:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="bp">NSURLResponse</span><span class="o">*</span><span class="p">,</span> <span class="bp">NSData</span><span class="o">*</span><span class="p">,</span> <span class="bp">NSError</span><span class="o">*</span><span class="p">))</span><span class="nv">handler</span>

<span class="c1">// GLKTextureLoader.h</span>
<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cubeMapWithContentsOfFile:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">fileName</span> <span class="nf">options:</span><span class="p">(</span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">textureOperations</span> <span class="nf">queue:</span><span class="p">(</span><span class="n">dispatch_queue_t</span><span class="p">)</span><span class="nv">queue</span> <span class="nf">completionHandler:</span><span class="p">(</span><span class="n">GLKTextureLoaderCallback</span><span class="p">)</span><span class="nv">block</span>
</pre></div></div>

<p>GLKTextureLoaderなどではqueueがNULLならmain dispatch queueで実行するよと書いてある。これを参考にすると以下のように書ける。このほうが呼び出す側は安心はできる。</p>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">viewDidLoad</span>
<span class="p">{</span>
    <span class="p">[</span><span class="nb">super</span> <span class="n">viewDidLoad</span><span class="p">];</span>

    <span class="p">[</span><span class="nb">self</span> <span class="nl">executeAsyncOnQueue</span><span class="p">:</span><span class="n">dispatch_get_main_queue</span><span class="p">()</span> <span class="nl">completionHandle</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@"in CompletionHandle"</span><span class="p">);</span>
    <span class="p">}];</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">executeAsyncOnQueue:</span><span class="p">(</span><span class="n">dispatch_queue_t</span><span class="p">)</span><span class="nv">queue</span> <span class="nf">completionHandle:</span><span class="p">(</span><span class="n">MYCompletionHandler</span><span class="p">)</span><span class="nv">completionHandler</span><span class="p">;</span>
<span class="p">{</span>
    <span class="k">__weak</span> <span class="n">ViewController</span> <span class="o">*</span><span class="n">me</span> <span class="o">=</span> <span class="nb">self</span><span class="p">;</span>
    <span class="n">dispatch_async</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span> <span class="o">^</span><span class="p">{</span>
        <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
        <span class="p">[</span><span class="n">me</span> <span class="nl">executeSync</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>
        <span class="n">completionHandler</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />15位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>59</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/015f218edbda287ef602">iOSでデバッグビルドとリリース版を共存させる</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-08-29 10:27:08</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Xcode]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>iOS上でアプリのデバッグビルドとリリース版と共存させたかったので <a href="http://jaysonlane.net/tech-blog/2012/04/post-release-development-bundle-identifiers-and-display-names/" rel="nofollow noopener" target="_blank">Post-Release Development Bundle Identifiers and Display Names</a> を参考にして、ビルドの構成でアプリのIDや名前を変えるようにしてみた。</p>

<p>これは  <code>Build identifier</code> や <code>Bundle display name</code> がビルドの構成で設定を分けらないので、別のビルド構成で分けられる変数に依存させるという手法。</p>

<p>例えば <code>Bundle identifier</code> の <code>example.com.${PRODUCT_NAME:rfc1034identifier}</code> を</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>example.com.${PRODUCT_NAME:rfc1034identifier}${BUNDLE_IDENTIFIER_SUFFIX}
</pre></div></div>

<p><code>Bundle display name</code> の <code>${PRODUCT_NAME}</code> を</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>${PRODUCT_NAME}${BUNDLE_DISPLAY_NAME_SUFFIX}
</pre></div></div>

<p>のようにそれぞれ <code>${BUNDLE_IDENTIFIER_SUFFIX}</code> と <code>${BUNDLE_DISPLAY_NAME_SUFFIX}</code> を追加する。</p>

<p>次にTARGETのBuild Settingsで <code>Add Build Setting</code> を押して、<code>User-Defined Settings</code> として <code>BUNDLE_IDENTIFIER_SUFFIX</code>と <code>BUNDLE_DISPLAY_NAME_SUFFIX</code> を追加する。</p>

<p><a href="https://camo.qiitausercontent.com/c37905275935139893b99eca528bfcf75b3f5808/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35653237323965382d616362632d616461652d343166312d6438663036663964613739302e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/c37905275935139893b99eca528bfcf75b3f5808/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35653237323965382d616362632d616461652d343166312d6438663036663964613739302e706e67" alt="xcode_2013-08-22_1445.png" title="xcode_2013-08-22_1445.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/5e2729e8-acbc-adae-41f1-d8f06f9da790.png"></a></p>

<p>あとはRelease構成の設定は空にして、Debug構成で好きな値を入れればいい。上記の例ではBundle identifierは <code>.debug</code> 、Bundle display nameには <code>D</code> を追加している。</p>

<p>Display Nameがギリギリの長さの場合は、語尾につけるSuffixが入らないこともあるので <code>BUNDLE_DISPLAY_NAME_PREFIX</code> にして先頭につけてみたり、そもそも <code>BUNDLE_DISPLAY_NAME</code> にしてそれぞれ名前をつけるという方法も有効となる。</p>

<p>ただしDisplay NameについてはInfoPlist.stringsで <code>CFBundleDisplayName</code> をローカライズするとそちらが優先されてしまうため注意。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />16位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>56</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/91b5c21aaf886fd23f5a">iOSのバージョンによる分岐</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-02-25 15:24:54</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="実行時にフレームワークバージョンで判定する" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E6%99%82%E3%81%AB%E3%83%95%E3%83%AC%E3%83%BC%E3%83%A0%E3%83%AF%E3%83%BC%E3%82%AF%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%81%A7%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>実行時にフレームワークバージョンで判定する</h2>

<p>AppleのiOS7移行ドキュメントにも書いてあったので<code>NSFoundationVersionNumber</code> を使うようにしている。</p>

<p><code>[UIDevice currentDevice].systemVersion</code> を使うやり方もちらほら見かけるが、値が文字列であるためバージョンの大小判定としては実装を工夫する必要がある。<code>NSFoundationVersionNumber</code> を使う方が可読性もあり、実装も楽である。<code>[UIDevice currentDevice].systemVersion</code> は表示したりログとして残す方に使うと良いと思う。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>if (floor(NSFoundationVersionNumber) &lt;= NSFoundationVersionNumber_iOS_6_1) {
    // Load resources for iOS 6.1 or earlier
} else {
    // Load resources for iOS 7 or later
}
</pre></div></div>

<p>iOS SDK 8時点での定義値。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>#if TARGET_OS_IPHONE
#define NSFoundationVersionNumber_iPhoneOS_2_0  678.24
#define NSFoundationVersionNumber_iPhoneOS_2_1  678.26
#define NSFoundationVersionNumber_iPhoneOS_2_2  678.29
#define NSFoundationVersionNumber_iPhoneOS_3_0  678.47
#define NSFoundationVersionNumber_iPhoneOS_3_1  678.51
#define NSFoundationVersionNumber_iPhoneOS_3_2  678.60
#define NSFoundationVersionNumber_iOS_4_0  751.32
#define NSFoundationVersionNumber_iOS_4_1  751.37
#define NSFoundationVersionNumber_iOS_4_2  751.49
#define NSFoundationVersionNumber_iOS_4_3  751.49
#define NSFoundationVersionNumber_iOS_5_0  881.00
#define NSFoundationVersionNumber_iOS_5_1  890.10
#define NSFoundationVersionNumber_iOS_6_0  992.00
#define NSFoundationVersionNumber_iOS_6_1  993.00
#define NSFoundationVersionNumber_iOS_7_0 1047.20
#define NSFoundationVersionNumber_iOS_7_1 1047.25
#endif
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />17位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>55</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/e728d74faca469ab0310">Pebble 3.x を取り巻く開発環境</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-03-19 20:59:03</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Pebble]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="http://developer.getpebble.com/" class="autolink" rel="nofollow noopener" target="_blank">http://developer.getpebble.com/</a></p>

<p>いろいろ増えてきたのでまとめてみる。</p>

<h2>
<span id="用語" class="fragment"></span><a href="#%E7%94%A8%E8%AA%9E"><i class="fa fa-link"></i></a>用語</h2>

<table>
<thead>
<tr>
<th style="text-align: left">用語</th>
<th style="text-align: left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">Pebble Classic</td>
<td style="text-align: left">初代のPebble、Pebble Steel, プラットフォーム名は <strong>aplite</strong>
</td>
</tr>
<tr>
<td style="text-align: left">Pebble Time</td>
<td style="text-align: left">カラー対応したPebble Time, Pebble Time Steel, プラットフォーム名は <strong>basalt</strong>、SDK 3以上が必要</td>
</tr>
<tr>
<td style="text-align: left">Pebble Time Round</td>
<td style="text-align: left">丸型のPebble Time, プラットフォーム名は <strong>chalk</strong>、SDK 3.6以上が必要</td>
</tr>
<tr>
<td style="text-align: left">Pebble 2</td>
<td style="text-align: left">Pebble (Cassic)の後継、プラットフォーム名は <strong>diorite</strong>、SDK 4以上が必要</td>
</tr>
<tr>
<td style="text-align: left">Time 2</td>
<td style="text-align: left">カラー対応したPebble Timeの後継、プラットフォーム名は <strong>emery</strong>
</td>
</tr>
<tr>
<td style="text-align: left">Pebble Watchapp</td>
<td style="text-align: left">Pebble本体側で実行するアプリ、iOS/Android側のスマホアプリPebble appを使ってPebbleにインストールする。時計のような機能が限定されたものはWatchfaceと呼ばれる</td>
</tr>
<tr>
<td style="text-align: left">Pebble (mobile) app</td>
<td style="text-align: left">
<a href="https://itunes.apple.com/us/app/pebble-smartwatch/id592012721?ls=1&amp;mt=8" rel="nofollow noopener" target="_blank">AppStore</a>, <a href="https://play.google.com/store/apps/details?id=com.getpebble.android" rel="nofollow noopener" target="_blank">Google Play</a>で配布されている公式のiOS/Androidアプリ、接続するPebbleやインストールするPebble Watchappを管理する、開発中のPebble Watchappをインストールするためにはデベロッパーモードを有効にしておく必要がある</td>
</tr>
<tr>
<td style="text-align: left">Pebble C</td>
<td style="text-align: left">Pebble Watchappの開発でつかう</td>
</tr>
<tr>
<td style="text-align: left">Pebble.js</td>
<td style="text-align: left">Pebble WatchappをJavascriptで記述できるフレームワーク</td>
</tr>
<tr>
<td style="text-align: left">Simplyjs</td>
<td style="text-align: left">簡単なPebble WatchappをJavascriptで記述できるフレームワーク</td>
</tr>
<tr>
<td style="text-align: left">Companion Apps</td>
<td style="text-align: left">Pebble Watchappと連動するiOS/Androidアプリ、開発者がPebbleKitを使って作成する</td>
</tr>
<tr>
<td style="text-align: left">PebbleKit</td>
<td style="text-align: left">iOS/Android側でPebble Watchappと連携するCompanion Appsを実装するためのSDK</td>
</tr>
<tr>
<td style="text-align: left">PebbleKit JS</td>
<td style="text-align: left">PebbleKitのJavascript版、スクリプトはPebble mobile appが取り出し実行する</td>
</tr>
<tr>
<td style="text-align: left">CloudPebble</td>
<td style="text-align: left">クラウド上のPebble Watchappの開発環境</td>
</tr>
<tr>
<td style="text-align: left">Pebble appstore</td>
<td style="text-align: left">Pebble Watchappのアプリストア</td>
</tr>
<tr>
<td style="text-align: left">Pebble Developer Portal</td>
<td style="text-align: left">Pebble appstoreで公開しているWatchappを開発者が管理するサイト</td>
</tr>
</tbody>
</table>

<h2>
<span id="pebblesmartwatch側" class="fragment"></span><a href="#pebblesmartwatch%E5%81%B4"><i class="fa fa-link"></i></a>Pebble(Smartwatch)側</h2>

<h3>
<span id="pebble-c" class="fragment"></span><a href="#pebble-c"><i class="fa fa-link"></i></a>Pebble C</h3>

<ul>
<li>Pebble WatchappをC言語で実装する、Pebble 1.0からあるベースの開発環境</li>
<li>基本的にPebble SDKと言えばこれを指すと考えて良いと思われる</li>
<li>Windows, Mac OS X, Linuxプラートフォームの<a href="http://developer.getpebble.com/sdk/" rel="nofollow noopener" target="_blank">SDK/toolchain</a>が公開されている(Python依存)

<ul>
<li>Mac OS XはHomebrewでインストールできる</li>
<li>各プラットフォームのエミュレータが用意されている</li>
</ul>
</li>
<li>SDKをインストールしなくてもブラウザ上で開発できるClouldPebbleがある</li>
<li>Pebble ClassicでPebble SDK 3.0以上でビルドしたWatchappを実行するにはFirmwareが2.9以上が必要

<ul>
<li>Pebble ClassicのFirmware 3.xがリリースされTimelineなどがサポートされた、これに対応するにはPebble SDK 3.8以上が必要</li>
</ul>
</li>
<li>C言語なので機種ごとに依存する対応は <code>#ifdef</code> で分岐する</li>
</ul>

<h3>
<span id="pebblejs" class="fragment"></span><a href="#pebblejs"><i class="fa fa-link"></i></a>Pebble.js</h3>

<p><a href="https://github.com/pebble/pebblejs/" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/pebble/pebblejs/</a></p>

<ul>
<li>Simplejsからの派生プロダクト</li>
<li>Pebble WatchappをJavascriptで実装するためのツールチェイン</li>
<li>ベータ版(2015/12時点)</li>
<li>ClouldPebbleからも利用できる</li>
<li>Pebble SDKを使って開発する場合は <a href="https://github.com/pebble/pebblejs/" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/pebble/pebblejs/</a> のプロジェクトをforkして<code>src/js/app.js</code>を変更して使うことができる</li>
</ul>

<h3>
<span id="simplyjs" class="fragment"></span><a href="#simplyjs"><i class="fa fa-link"></i></a>Simplyjs</h3>

<p><a href="http://simplyjs.io/" class="autolink" rel="nofollow noopener" target="_blank">http://simplyjs.io/</a></p>

<ul>
<li>シンプルなPebble WatchappをJavascriptで実装するためのツールチェイン</li>
<li>0.3ではテキスト表示や、バイブレーションなどが実行できる

<ul>
<li>表示するテキストの位置などはだいたい決まっており自由なユーザインタフェースは実装できない</li>
</ul>
</li>
<li>派生プロダクトのPebble.jsがあるため、もう機能追加はされないと思われる</li>
</ul>

<h3>
<span id="rockyjs" class="fragment"></span><a href="#rockyjs"><i class="fa fa-link"></i></a>Rocky.js</h3>

<p><a href="https://pebble.github.io/rockyjs/" class="autolink" rel="nofollow noopener" target="_blank">https://pebble.github.io/rockyjs/</a></p>

<ul>
<li>Pebble FirmwareにJavascript Runtimeを載せようとするプロジェクト</li>
<li>Pebble.js/SimplyjsはjavascriptのプログラムからPebble Watchappバイナリファイルを作成するプロダクトであるのに対して、Rocky.jsはjavascriptのプログラムを直接Pebble本体で実行することを目指している</li>
</ul>

<h2>
<span id="mobilesmartphone-tablet側" class="fragment"></span><a href="#mobilesmartphone-tablet%E5%81%B4"><i class="fa fa-link"></i></a>Mobile(Smartphone, Tablet)側</h2>

<h3>
<span id="pebblekit" class="fragment"></span><a href="#pebblekit"><i class="fa fa-link"></i></a>PebbleKit</h3>

<ul>
<li>
<a href="https://github.com/pebble/pebble-ios-sdk/" rel="nofollow noopener" target="_blank">PebbleKit iOS</a>, <a href="https://github.com/pebble/pebble-android-sdk/" rel="nofollow noopener" target="_blank">PebbleKit Android</a>が公開されている</li>
<li>開発者が自作のiOS/AndroidのネイティブアプリにPebble Watchappとやりとりする機能を実装できる

<ul>
<li>Pebble Watchapp側からはそのようなネイティブアプリをCompanion Appsと呼ぶ</li>
</ul>
</li>
<li>ネイティブアプリを用意しなくても済む<a href="http://developer.getpebble.com/docs/js/" rel="nofollow noopener" target="_blank">PebbleKit JS</a>がある</li>
</ul>

<h3>
<span id="pebblekit-js" class="fragment"></span><a href="#pebblekit-js"><i class="fa fa-link"></i></a>PebbleKit JS</h3>

<p><a href="http://developer.getpebble.com/docs/js/" class="autolink" rel="nofollow noopener" target="_blank">http://developer.getpebble.com/docs/js/</a></p>

<ul>
<li>iOS/Android側のPebble appで実行し、Pebble Watchappへデータを送る処理をJavascriptで実装するためのフレームワーク</li>
<li>Pebble Watchapp単体で出来ないクラウドからデータを取得するような実装を追加することができる</li>
<li>スクリプトはPebble Watchappに含め、Pebble appが取り出し実行するので別途ネイティブアプリを配布しなくて良い

<ul>
<li>ただしAppleがインターネットからダウンロードしたコードの実行を禁止しているため、iOSでは回避策として全てのWatchappのJSコードをPebble appに含めるという方式をとっている。したがって公式のPebble appが更新されるまでiOSではリリースしたPebble Watchappが公開されない</li>
<li>このPebble appの更新日は <a href="http://forums.getpebble.com/discussion/12451/pebble-js-bundling-updates" rel="nofollow noopener" target="_blank">Pebble JS Bundling Updates</a> で公開されている</li>
</ul>
</li>
<li>Pebble WatchappをJavascriptで実装するためのツールチェインではない

<ul>
<li>その目的のものは Simplyjs や Pebble.js の方</li>
</ul>
</li>
</ul>

<h2>
<span id="ide等" class="fragment"></span><a href="#ide%E7%AD%89"><i class="fa fa-link"></i></a>IDE等</h2>

<h3>
<span id="cloudpebble" class="fragment"></span><a href="#cloudpebble"><i class="fa fa-link"></i></a>CloudPebble</h3>

<p><a href="https://cloudpebble.net/" class="autolink" rel="nofollow noopener" target="_blank">https://cloudpebble.net/</a></p>

<ul>
<li>Pebble Watchappを開発するためのクラウド上のIDE</li>
<li>C言語だけなくPebble.js、Simplyjsにも対応している</li>
<li>GitHubと連携することでリポジトリ管理もできるらしい</li>
<li>Pebbleシミュレータを実行できる</li>
<li>スマホのIPアドレスを入れることでPebble実機にインストールできる</li>
</ul>

<h3>
<span id="atomエディタ" class="fragment"></span><a href="#atom%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF"><i class="fa fa-link"></i></a>Atomエディタ</h3>

<p><a href="https://atom.io/" class="autolink" rel="nofollow noopener" target="_blank">https://atom.io/</a></p>

<ul>
<li>
<a href="https://github.com/jneubrand/pb-completions" rel="nofollow noopener" target="_blank">pb-completions</a> パッケージを使うとPebble Cのコード補完ができる</li>
</ul>

<h3>
<span id="watchface-generator" class="fragment"></span><a href="#watchface-generator"><i class="fa fa-link"></i></a>Watchface Generator</h3>

<ul>
<li>Pebble Watchappで時計機能だけ表示するwatchfaceを作成するツール</li>
<li>画像をアップロードして、時計の表示位置などの幾つかを設定することでアプリを作成してダウンロードできる</li>
<li>Pebble Classic向け: <a href="http://www.watchface-generator.de/" class="autolink" rel="nofollow noopener" target="_blank">http://www.watchface-generator.de/</a>
</li>
<li>Pebble Time向け: <a href="http://www.watchface-generator.de/v3/" class="autolink" rel="nofollow noopener" target="_blank">http://www.watchface-generator.de/v3/</a>
</li>
</ul>

<h3>
<span id="pebble-dash-docset" class="fragment"></span><a href="#pebble-dash-docset"><i class="fa fa-link"></i></a>Pebble Dash Docset</h3>

<p>Macの<a href="http://kapeli.com/dash" rel="nofollow noopener" target="_blank">Dash (Docs &amp; Snippets)</a>アプリ用のドキュメント。</p>

<p>Preferences &gt; Downloads タブから <strong>+</strong> で以下のURLを追加してダウンロード。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>http://partlyhuman.github.io/PebbleSdkDocset/Pebble.xml
</pre></div></div>

<p>参考: <a href="http://forums.getpebble.com/discussion/8270/sdk-documentation-in-dash-docset" rel="nofollow noopener" target="_blank">SDK Documentation in Dash Docset</a></p>

<h3>
<span id="その他" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96"><i class="fa fa-link"></i></a>その他</h3>

<ul>
<li>
<a href="https://www.kiezelpay.com/" rel="nofollow noopener" target="_blank">KiezelPay</a>: Payment用のライブラリ</li>
<li>
<a href="https://github.com/pebble/clay" rel="nofollow noopener" target="_blank">Clay for Pebble</a>: オフラインで動的に設定画面を作るライブラリ</li>
<li>サンプルコード: <a href="https://developer.getpebble.com/examples/" class="autolink" rel="nofollow noopener" target="_blank">https://developer.getpebble.com/examples/</a>
</li>
</ul>

<h2>
<span id="pebble-appstore" class="fragment"></span><a href="#pebble-appstore"><i class="fa fa-link"></i></a>Pebble appstore</h2>

<h3>
<span id="pebble-appstore-1" class="fragment"></span><a href="#pebble-appstore-1"><i class="fa fa-link"></i></a>Pebble appstore</h3>

<p><a href="https://help.getpebble.com/customer/portal/articles/1701779-pebble-appstore" class="autolink" rel="nofollow noopener" target="_blank">https://help.getpebble.com/customer/portal/articles/1701779-pebble-appstore</a></p>

<ul>
<li>Pebble Watchappの公式なアプリストア</li>
<li>2014年2月ごろから公開</li>
<li>Pebble app内から表示できる</li>
<li>有料販売には対応していない</li>
<li>Pebble WatchappにはAndroid, iOSをサポートしているか、Companion Appsがあるか、などが情報で表示される</li>
<li>公開地域(国)を選択する機能はなく全世界のPebble Watchappが並ぶ</li>
<li>Pebble appstoreは国際化に対応していないため基本的にPebble Watchappの説明は英語で記述する

<ul>
<li>それを気にせず母国語で説明を記述している開発者もいる</li>
</ul>
</li>
<li>Pebble Watchappは <code>.pbw</code> ファイルを公開することでPebble appstore以外で配布することは可能</li>
<li>Pebble appstoreが後発であったため<a href="http://www.mypebblefaces.com/" rel="nofollow noopener" target="_blank">My Pebble Faces</a>のような非公式なギャラリーが存在する</li>
</ul>

<h3>
<span id="pebble-developer-portal" class="fragment"></span><a href="#pebble-developer-portal"><i class="fa fa-link"></i></a>Pebble Developer Portal</h3>

<p><a href="https://dev-portal.getpebble.com/" class="autolink" rel="nofollow noopener" target="_blank">https://dev-portal.getpebble.com/</a></p>

<ul>
<li>開発者がPebble appstoreにPebble Watchappを公開する際に利用するサイト</li>
<li>ここからPebble Watchappをアップロード(提出)したり、アプリの説明を記述したりする</li>
<li>
<a href="https://dev-portal.getpebble.com/publish_to_appstore" rel="nofollow noopener" target="_blank">Pebble Appstore Guide</a>がある</li>
<li>個々のPebble Watchappのパーマリンクが存在し、通常のブラウザで開くことができる

<ul>
<li>開発者は自身のサイトで紹介ができる</li>
<li>Pebbleを購入する導線が用意されている</li>
</ul>
</li>
</ul>

<h2>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h2>

<ul>
<li>Pebble Watchappの開発環境の構築は多少面倒なのでまずはCloudPebbleを試してみるのが吉

<ul>
<li>Mac OS XではHomebrewでPebble SDKがインストールできるようになり多少敷居は下がった</li>
</ul>
</li>
<li>スマホ側で実行する機能をJavascriptで書くものがPebbleKit JSでPebble側で実行する機能(Pebble Watchapp)をJavascriptで書くものがPebble.js</li>
<li>Simplyjsの機能で済むなら、Simplyjs + PebbleKit JSを使いCloudPebbleで開発するのが一番手っ取り早い</li>
<li>C言語の実装に抵抗がある場合はPebble.js + CloudPebbleを選ぶのも手、Beta版のリスクとのトレードオフ</li>
<li>既存のiOS/AndroidアプリのコンテンツをPebbleで表示したい場合はそのアプリのプロジェクトでPebbleKit iOS, PebbleKit Androidを利用して実装する</li>
<li>クラウドでの開発に不安がある場合やエディタやソース管理を自分の方法で行いたい場合などはSDKを使って開発すればよい</li>
<li>単純な時計は Watchface Generator を使えば開発環境は不要</li>
<li>Pebble Watchappを配布する環境として公式なPebble appstore、Pebble Developer Portalが用意されている</li>
<li>Pebbleのプラットフォームが増えたためエミュレータが重宝する</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />18位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>52</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/39d63b86a8a0a5debc3f">Flat UI ColorsをUIColorで表現してみた</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-06-25 20:55:22</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>有りそうで無かったので<a href="http://flatuicolors.com/" rel="nofollow noopener" target="_blank">Flat UI Colors</a>をUIColorで表現してみた。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="bp">UIColor</span> <span class="o">*</span><span class="n">turquoiseFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.10196078431372549</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.7372549019607844</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.611764705882353</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">greenSeaFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.08627450980392157</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.6274509803921569</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.5215686274509804</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">emeraldFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.1803921568627451</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.8</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.44313725490196076</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">nephritisFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.15294117647058825</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.6823529411764706</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.3764705882352941</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">peterRiverFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.20392156862745098</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.596078431372549</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.8588235294117647</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">belizeHoleFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.1607843137254902</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.5019607843137255</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.7254901960784313</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">amethystFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.6078431372549019</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.34901960784313724</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.7137254901960784</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">wisteriaFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.5568627450980392</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.26666666666666666</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.6784313725490196</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">wetAsphaltFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.20392156862745098</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.28627450980392155</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.3686274509803922</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">midnightBlueFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.17254901960784313</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.24313725490196078</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.3137254901960784</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">sunFlowerFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.9450980392156862</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.7686274509803922</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.058823529411764705</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">orangeFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.9529411764705882</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.611764705882353</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.07058823529411765</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">carrotFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.9019607843137255</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.49411764705882355</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.13333333333333333</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">pumpkinFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.8274509803921568</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.32941176470588235</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.0</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">alizarinFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.9058823529411765</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.2980392156862745</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.23529411764705882</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">pomegranateFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.7529411764705882</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.2235294117647059</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.16862745098039217</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">cloudsFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.9254901960784314</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.9411764705882353</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.9450980392156862</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">silverFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.7411764705882353</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.7647058823529411</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.7803921568627451</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">concreteFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.5843137254901961</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.6470588235294118</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.6509803921568628</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
<span class="bp">UIColor</span> <span class="o">*</span><span class="n">asbestosFlatColor</span> <span class="o">=</span> <span class="p">[</span><span class="bp">UIColor</span> <span class="nl">colorWithRed</span><span class="p">:</span><span class="mf">0.4980392156862745</span> <span class="nl">green</span><span class="p">:</span><span class="mf">0.5490196078431373</span> <span class="nl">blue</span><span class="p">:</span><span class="mf">0.5529411764705883</span> <span class="nl">alpha</span><span class="p">:</span><span class="mf">1.0</span><span class="p">];</span>
</pre></div></div>

<p>UIColor+FlatUIも作ってみた。<br>
<a href="https://github.com/makotokw/CocoaWZYFlatUIColor" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/makotokw/CocoaWZYFlatUIColor</a></p>

<p>ついでにiOS7Colorsも少し。</p>

<p><a href="https://camo.qiitausercontent.com/adddbda7f23e7146ac52fc6d15c5d3f4bbddefaf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35306334373039332d323734632d333665642d373366632d3862336566316431323637392e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/adddbda7f23e7146ac52fc6d15c5d3f4bbddefaf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35306334373039332d323734632d333665642d373366632d3862336566316431323637392e706e67" alt="WZYFlatUIColor.png" title="WZYFlatUIColor.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/50c47093-274c-36ed-73fc-8b3ef1d12679.png"></a></p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />19位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>49</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/b7cc2bb77a7a71bc36da">CocoaPodsを使ってビルドが失敗する時にチェックすること</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-07-18 18:17:16</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[iOS]</b> <b>[CocoaPods]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>なんかCocoaPodsのバージョン上げてPodsを入れなおしたらビルドが通らなくなった。どうやらPods.xcconfigから参照していたPODS_BUILD_HEADERS_SEARCH_PATHSやPODS_PUBLIC_HEADERS_SEARCH_PATHSが消えてしまいヘッダファイルが見つけられなくなっている。</p>

<p><a href="http://docs.cocoapods.org/guides/integrating_a_project.html" rel="nofollow noopener" target="_blank">Integrating with an Xcode project</a>を確認。CocoaPodsではビルド設定を <strong>Pods/Pods.xcconfig</strong> に作成して、それをアプリケーションプロジェクトに設定する。</p>

<p>これが正しく適応されているかは、</p>

<ol>
<li>PROJECT が Pods.xcconfig を使っているか</li>
<li>TARGET が PROJECT の設定を継承しているか</li>
</ol>

<p>をチェックする。</p>

<h3>
<span id="projectがpodsxcconfigを使っているか" class="fragment"></span><a href="#project%E3%81%8Cpodsxcconfig%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B%E3%81%8B"><i class="fa fa-link"></i></a>PROJECTがPods.xcconfigを使っているか</h3>

<p>Pods.xcconfigが使われているかは PROJECTの <strong>Info</strong> &gt; <strong>Configrations</strong> の <strong>Based on Configuration File</strong> を見ればわかる。これが <strong>Pods</strong> になっていればok。</p>

<p><a href="https://camo.qiitausercontent.com/abb1e18865ae238c110b46c1912e704b73d3acb0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31633263313730632d353239352d613561342d373066352d3030333933393434646133622e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/abb1e18865ae238c110b46c1912e704b73d3acb0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31633263313730632d353239352d613561342d373066352d3030333933393434646133622e706e67" alt="pods_2013-07-18_1716.png" title="pods_2013-07-18_1716.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/1c2c170c-5295-a5a4-70f5-00393944da3b.png"></a></p>

<h3>
<span id="targetがpodsxcconfigの設定を使っているか" class="fragment"></span><a href="#target%E3%81%8Cpodsxcconfig%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B%E3%81%8B"><i class="fa fa-link"></i></a>TARGETがPods.xcconfigの設定を使っているか</h3>

<p>次に Pods.xcconfig の中身からビルド設定を確認する。</p>

<p>コンパイルが失敗する場合はPods.xcconfigのHEADER_SEARCH_PATHSが、リンクが失敗する場合はLIBRARY_SEARCH_PATHS、OTHER_LDFLAGSが適切に設定されていないおそれがある。</p>

<p>例えばTARGETの Build Settings で 直接 Header Search Paths を設定していると PROJECT(Pods.xcconfig)の値が使われないのでヘッダファイルを探せなくなる。この場合はPROJECTの設定を引き継ぐように  <code>$(inherited)</code> を追加する。</p>

<p><a href="https://camo.qiitausercontent.com/b0036b3951093eed428f931b36d6988ceb4398ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f37363237353434352d633962652d376131612d396164332d3461383237656166356631352e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/b0036b3951093eed428f931b36d6988ceb4398ca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f37363237353434352d633962652d376131612d396164332d3461383237656166356631352e706e67" alt="pods_2013-07-18_1726.png" title="pods_2013-07-18_1726.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/76275445-c9be-7a1a-9ad3-4a827eaf5f15.png"></a></p>

<p>同様にLIBRARY_SEARCH_PATHSが使われているなら <strong>Library Search Paths</strong>を 、OTHER_LDFLAGSが使われているなら <strong>Other Linker Flags</strong> の値に <code>$(inherited)</code> を追加する。</p>

<p>今回ハマッたようにTARGETでは直接Pods.xcconfigの変数を使わずにPROJECTを継承した方が無難。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />20位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>45</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/5891f857cf4795b6955f">Sublime Text 2でGoプログラムを書いて実行する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-04-16 00:18:09</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Go]</b> <b>[SublimeText2]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="goのインストール" class="fragment"></span><a href="#go%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Goのインストール</h2>

<p><a href="http://code.google.com/p/go/downloads/" class="autolink" rel="nofollow noopener" target="_blank">http://code.google.com/p/go/downloads/</a> からプラットフォームに合ったものをダウンロードしてインストールする。</p>

<p>Windows版はソースから入れる以外ではzipを解凍するかMSIインストールを使うかの選択肢がある。バージョンアップなどを考えるとzipの解凍の方が管理しやすいだろうか？ <code>C:\go</code> に配置するのが無難。</p>

<p>OS Xの場合は欲しいバージョンがHomebrewにあったらそれで入れるのが楽。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>$ brew info go
go: stable <span class="m">1</span>.0.3, HEAD
↑でよければ brew install go
$ brew install go
</pre></div></div>

<h2>
<span id="gosublimeのインストール" class="fragment"></span><a href="#gosublime%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>GoSublimeのインストール</h2>

<p>Sublime Text2のプラグインとして <strong><a href="https://github.com/DisposaBoy/GoSublime" rel="nofollow noopener" target="_blank">GoSublime</a></strong> がある。( <a href="http://www.youtube.com/user/GoSublime/videos" rel="nofollow noopener" target="_blank">GoSublimeのデモ動画</a> )</p>

<p><code>Package Control: Install Package</code> でインストールできる。</p>

<p>Homebrewでパスが通っているところにインストールする場合や、C:\goにインストールした場合は特に設定は不要だった。パスが通っていない場合などは <code>Packages/User/GoSublime.sublime-settings</code> にてPATHやGOROOTを設定しないといけないようだ。</p>

<div class="code-frame" data-lang="json"><div class="highlight"><pre><span></span><span class="err">//</span> <span class="err">C:\_goに入れた場合</span>
  <span class="p">{</span>
    <span class="nt">"env"</span><span class="p">:</span> <span class="p">{</span> 
      <span class="nt">"PATH"</span><span class="p">:</span> <span class="s2">"C:\\_go\\bin;$PATH"</span><span class="p">,</span>
      <span class="nt">"GOROOT"</span><span class="p">:</span> <span class="s2">"C:\\_go"</span>
    <span class="p">}</span>
  <span class="p">}</span>
</pre></div></div>

<h2>
<span id="プログラムの実行" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%A0%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>プログラムの実行</h2>

<p>以下のようなプログラムを書く。</p>

<p>(GoSublimeは <code>package</code> と入力するとディレクトリ名を名前にして補完してくれる。しかし goプログラムが実行する <code>main</code> 関数は <code>main</code> パッケージにないといけないのでしばらくそれでハマった)</p>

<div class="code-frame" data-lang="go"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">"fmt"</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">"Hello, Wolrd"</span><span class="p">)</span>
<span class="p">}</span>
</pre></div></div>

<h3>
<span id="コマンドシェルから実行する" class="fragment"></span><a href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%82%B7%E3%82%A7%E3%83%AB%E3%81%8B%E3%82%89%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>コマンドシェルから実行する</h3>

<p>GoSublimeには <strong>9o</strong> というコマンドシェルがあり、<code>ctrl+9</code> or <code>command+9</code> で開ける。</p>

<p>コマンドシェルから <code>run</code> と打てばビルドと実行が行われる。</p>

<p>無限ループなどで強制終了が必要なときは <code>tskill</code> と打つとタスクが表示されるので <code>tskill t1</code> のようにタスクIDを指定して打つと確認のプロンプトが表示され終了できる。</p>

<p>その他コマンドについては<a href="https://github.com/DisposaBoy/GoSublime/blob/master/9o.md" rel="nofollow noopener" target="_blank">ドキュメント</a> を参照。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />21位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>45</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/1122196aace7a79dcd59">SilexでHello World</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-01-23 02:04:11</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[PHP]</b> <b>[Silex]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="sliexとは" class="fragment"></span><a href="#sliex%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>Sliexとは</h2>

<p>sinatraからインスパイアされたPHP 5.3以上で動作するPHPマイクロフレームワーク。Symfony2 のコンポーネントと Pimple を利用して構築されている。</p>

<p>Symfonyの開発元である Sensio Labs より公開されている。<br>
<a href="http://silex.sensiolabs.org/" class="autolink" rel="nofollow noopener" target="_blank">http://silex.sensiolabs.org/</a></p>

<h2>
<span id="インストール方法" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>インストール方法</h2>

<p>以前のバージョンではsilex.pherをincludeするという方式だったけど途中からcomposerを使うようになった。composerはrubyで言うbundlerのようなものでライブラリの依存関係を解決してくれる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>curl -s http://getcomposer.org/installer | php
sudo mv composer.phar /usr/local/bin/composer
</pre></div></div>

<p>のようにしてダウンロードしたphpプログラム(composer.phar)をcomposerとしてパスを通しておくといい。</p>

<p>プロジェクトのディレクトリにcomposer.jsonを書く。Gemfileのようなもの。以下の様に書くとSilex 1.0に依存するということになる。</p>

<div class="code-frame" data-lang="json">
<div class="code-lang"><span class="bold">composer.json</span></div>
<div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">"require"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"silex/silex"</span><span class="p">:</span> <span class="s2">"1.0.*@dev"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>

<p>プロジェクトディレクトリで以下のコマンドを打つとインストールできる。</p>

<div class="code-frame" data-lang="/path/to/project"><div class="highlight"><pre><span></span>composer install
</pre></div></div>

<p>成功すると依存ライブラリはvendorディレクトリ以下に配置され、composerによってautoloadが可能になる。ドキュメントルートをwebサブディレクトリとして公開するなら以下のような階層になる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>├── composer.json
├── composer.lock
├── vendor
│  └── ...
└── web
    └── index.php
</pre></div></div>

<h2>
<span id="hello-world" class="fragment"></span><a href="#hello-world"><i class="fa fa-link"></i></a>Hello World</h2>

<p>web/index.phpを以下のように作り、ブラウザでサーバにアクセスするとHello Worldが表示される。返しているのはHTMLではなくただの文字列。</p>

<div class="code-frame" data-lang="php">
<div class="code-lang"><span class="bold">web/index.php</span></div>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">require_once</span> <span class="no">__DIR__</span><span class="o">.</span><span class="s1">'/../vendor/autoload.php'</span><span class="p">;</span> 

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Silex\Application</span><span class="p">();</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"Hello World!"</span><span class="p">;</span>
<span class="p">});</span> 
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span> 
</pre></div>
</div>

<h2>
<span id="ルーティング" class="fragment"></span><a href="#%E3%83%AB%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>ルーティング</h2>

<p>例えば /hello/taroにアクセスしたときにHello taroと出力する場合は以下のように追加できる。</p>

<div class="code-frame" data-lang="php">
<div class="code-lang"><span class="bold">web/index.php</span></div>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">require_once</span> <span class="no">__DIR__</span><span class="o">.</span><span class="s1">'/../vendor/autoload.php'</span><span class="p">;</span> 

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Silex\Application</span><span class="p">();</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"Hello World!"</span><span class="p">;</span>
<span class="p">});</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/hello/{name}'</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="k">use</span><span class="p">(</span><span class="nv">$app</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">return</span> <span class="s1">'Hello '</span><span class="o">.</span><span class="nv">$app</span><span class="o">-&gt;</span><span class="na">escape</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span> 
<span class="p">});</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span> 
</pre></div>
</div>

<p>※ 使っているウェブサーバですべてのリクエストをweb/index.phpで処理させるように設定しておくこと。Apacheなら.htaccessなどを使って以下のように書ける。</p>

<div class="code-frame" data-lang="apacheconf">
<div class="code-lang"><span class="bold">web/.htaccess</span></div>
<div class="highlight"><pre><span></span><span class="nt">&lt;IfModule</span> <span class="s">mod_rewrite.c</span><span class="nt">&gt;</span>
    <span class="nb">Options</span> -MultiViews

    <span class="nb">RewriteEngine</span> <span class="k">On</span>
    <span class="c">#RewriteBase /path/to/app</span>
    <span class="nb">RewriteCond</span> %{REQUEST_FILENAME} !-f
    <span class="nb">RewriteRule</span> ^ index.php [L]
<span class="nt">&lt;/IfModule&gt;</span>
</pre></div>
</div>

<p>PHP 5.4にビルトインウェブサーバ用意されたのでようやくコマンドラインから簡単にウェブサーバを立ち上げられるようになった。</p>

<div class="code-frame" data-lang="/path/to/project"><div class="highlight"><pre><span></span>php -S 0.0.0.0:8080 -t web
</pre></div></div>

<p>その他の主要なWebサーバの設定例については <a href="http://silex.sensiolabs.org/doc/web_servers.html" class="autolink" rel="nofollow noopener" target="_blank">http://silex.sensiolabs.org/doc/web_servers.html</a> を参照。</p>

<h2>
<span id="テンプレートエンジンを使う" class="fragment"></span><a href="#%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%82%B8%E3%83%B3%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>テンプレートエンジンを使う</h2>

<p>SinatraというかRubyではいろんなテンプレートエンジンが使える。SliexではTwigというテンプレートエンジンがあり、Sensio Labs より公開されているのでこれを使う</p>

<h3>
<span id="twigのインストール" class="fragment"></span><a href="#twig%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>twigのインストール</h3>

<p>composer.jsonを以下のように修正する。</p>

<div class="code-frame" data-lang="json">
<div class="code-lang"><span class="bold">composer.json</span></div>
<div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">"require"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"silex/silex"</span><span class="p">:</span> <span class="s2">"1.0.*@dev"</span><span class="p">,</span>
        <span class="nt">"twig/twig"</span><span class="p">:</span> <span class="s2">"&gt;=1.8,&lt;2.0-dev"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>

<p>依存ライブラリを更新する。</p>

<div class="code-frame" data-lang="/path/to/project"><div class="highlight"><pre><span></span>composer update
</pre></div></div>

<p>でtwigライブラリが追加される。</p>

<h3>
<span id="twigを使う" class="fragment"></span><a href="#twig%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>twigを使う</h3>

<p>SilexからはServiceProviderとしてtwigを登録して呼び出す。</p>

<div class="code-frame" data-lang="php">
<div class="code-lang"><span class="bold">web/index.php</span></div>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">require_once</span> <span class="no">__DIR__</span><span class="o">.</span><span class="s1">'/../vendor/autoload.php'</span><span class="p">;</span> 

<span class="nv">$app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Silex\Application</span><span class="p">();</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">register</span><span class="p">(</span><span class="k">new</span> <span class="nx">Silex\Provider\TwigServiceProvider</span><span class="p">(),</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'twig.path'</span> <span class="o">=&gt;</span> <span class="no">__DIR__</span><span class="o">.</span><span class="s1">'/../views'</span><span class="p">,</span>
<span class="p">));</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"Hello World!"</span><span class="p">;</span>
<span class="p">});</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'/hello/{name}'</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span> <span class="k">use</span><span class="p">(</span><span class="nv">$app</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$app</span><span class="p">[</span><span class="s1">'twig'</span><span class="p">]</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">'hello.twig'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="nv">$name</span><span class="p">,</span>
    <span class="p">));</span>
<span class="p">});</span>
<span class="nv">$app</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">();</span>
</pre></div>
</div>

<p>twigコンテナからrenderメソッドでテンプレートファイル、パラメータを指定して出力を返す。hello.twigは以下のようになる。</p>

<div class="code-frame" data-lang="twig">
<div class="code-lang"><span class="bold">views/hello.twig</span></div>
<div class="highlight"><pre><span></span>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Silex&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello {{ name }}&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>

<p>twigにはレイアウトなどいろいろな機能がある。詳しくは以下を参照。<br>
<a href="http://twig.sensiolabs.org/" class="autolink" rel="nofollow noopener" target="_blank">http://twig.sensiolabs.org/</a></p>

<h2>
<span id="プロジェクトのコミット" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88"><i class="fa fa-link"></i></a>プロジェクトのコミット</h2>

<p>Silexではなくcomposerの話になってしまうが、composerでインストールしたライブラリはコミットしなくていい。つまりvendorは除外できる。</p>

<p>vendor以外のプロジェクトのファイルと共にcomposer.jsonはもちろんcomposer.lockもコミットする。理由はGemfile.lockと同じで、このファイルがあれば他の開発者や運用環境で同じバージョンの依存ライブラリをスナップショットとして使うことができるから。</p>

<p>他の開発者はプロジェクトを取得し、composer installコマンドでcomposer.lockから依存ライブラリを取得できる。</p>

<p>サンプルコードをgithubにあげてみた。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>git clone git://github.com/makotokw/php-silex-hello-world.git
cd php-silex-hello-world
composer install
php -S 0.0.0.0:8080 -t web
</pre></div></div>

<p>でok。</p>

<p>依存ライブラリを最新に更新するときなどはcomposer updateが使える。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />22位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>44</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/0eca7ae87055a3d99520">TestFlightでアプリをテストしてもらう時に読んでもらうページ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-04-05 13:31:39</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> <b>[TestFlight]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><strong>この内容はAppleに買収されiTunes Connectに統合される前のTestFlightについての情報です、testflightapp.comは2015/2/26に終了です</strong></p>

<p>エンジニアじゃない人にもTestFlightを使ってもらうための説明ページ。</p>

<h2>
<span id="testflightって何" class="fragment"></span><a href="#testflight%E3%81%A3%E3%81%A6%E4%BD%95"><i class="fa fa-link"></i></a>TestFlightって何？</h2>

<p><a href="https://testflightapp.com/" rel="nofollow noopener" target="_blank">TestFlight</a>はアメリカにあるTestFlight App Inc.が運営している iOSアプリをチームメンバーにインターネット経由で配布するための無料のサービスです。</p>

<p>iOSアプリのテストツールとしてはメジャーなサービスです。Androidアプリも対応していますが省略します。</p>

<h2>
<span id="なぜtestflight使うのか" class="fragment"></span><a href="#%E3%81%AA%E3%81%9Ctestflight%E4%BD%BF%E3%81%86%E3%81%AE%E3%81%8B"><i class="fa fa-link"></i></a>なぜTestFlight使うのか？</h2>

<p>iOSアプリは基本的に公式のAppStoreからしかインストールできません。</p>

<p>開発者(iOS Developer Program)には最大100台の実機にインストールしてテストすることが許可されていますが、事前に機器のDeviceIDをアプリに紐づけておく必要があります。ここでiOS機器のDeviceIDを調べてもらったり、USB経由でインストールする場合はiOS機器をいちいち開発者のマシンに繋いだりと、面倒な作業が発生します。</p>

<p>これらのテスターと開発者間に発生する面倒な作業を円滑にするためにTestFlightが必要です。</p>

<h2>
<span id="testflightで何をすればいいの" class="fragment"></span><a href="#testflight%E3%81%A7%E4%BD%95%E3%82%92%E3%81%99%E3%82%8C%E3%81%B0%E3%81%84%E3%81%84%E3%81%AE"><i class="fa fa-link"></i></a>TestFlightで何をすればいいの？</h2>

<p>TestFlightでテスターの皆さんが行うことは以下のようなことです</p>

<ul>
<li>アカウントの登録</li>
<li>テストで使うiOS機器をアカウントに紐付ける</li>
<li>アカウントを開発者のチームに加えてもらう</li>
<li>チームからリリースされたアプリをインストールする</li>
</ul>

<p>アカウントと機器、チームの紐付けを一度設定できれば、後はチームの開発者からリリースされるアプリをTestFlightからインストールしてアプリを試すだけです。</p>

<h2>
<span id="testflightアカウントとチーム" class="fragment"></span><a href="#testflight%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%A8%E3%83%81%E3%83%BC%E3%83%A0"><i class="fa fa-link"></i></a>TestFlightアカウントとチーム</h2>

<h3>
<span id="アカウント" class="fragment"></span><a href="#%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88"><i class="fa fa-link"></i></a>アカウント</h3>

<ul>
<li>TestFlightアカウントは無料で作成できます</li>
<li>アカウントに必要な情報はメールアドレスとパスワード名前です

<ul>
<li>アプリケーションがリリースされたときにTestFlightからメールによる通知がきます</li>
<li>iOS端末でTestFlightからのメールを読むことは必須ではありません。TestFlightのウェブサイトからアプリをインストールできるのでPCで通知メールを見てiOS端末でサイトにアクセスするという運用も可能です</li>
<li>メールアドレスを使ってTestFlight経由で開発者とメッセージをやり取りできますが、TestFlight上でコミニケーションするかどうかはプロジェクトによるでしょう</li>
</ul>
</li>
</ul>

<h3>
<span id="チーム" class="fragment"></span><a href="#%E3%83%81%E3%83%BC%E3%83%A0"><i class="fa fa-link"></i></a>チーム</h3>

<ul>
<li>TestFlightには <strong>チーム</strong> という概念があります</li>
<li>アプリケーションをインストールするにはそのアカウントが開発者が作成したチームに属する必要があります</li>
<li>(チームに所属しない状態で公開してもらう別の方法もありますがここでは省略)</li>
<li>チームにはリーダー(おそらく開発者の誰か、複数人いることも)が存在し、チームに入るためにはリーダから招待メールをうけて受理するという作業になります</li>
<li>アカウントは複数のチームに所属することができます。逆に言えば開発者(チーム)が異なるアプリケーションをテストする場合はそのチームごとに所属することが必要になります</li>
</ul>

<h2>
<span id="testflightアカウントにios機器を紐付ける方法" class="fragment"></span><a href="#testflight%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%ABios%E6%A9%9F%E5%99%A8%E3%82%92%E7%B4%90%E4%BB%98%E3%81%91%E3%82%8B%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>TestFlightアカウントにiOS機器を紐付ける方法</h2>

<p>元記事: <a href="http://help.testflightapp.com/customer/portal/articles/829600-how-do-i-connect-my-device-to-my-account-" class="autolink" rel="nofollow noopener" target="_blank">http://help.testflightapp.com/customer/portal/articles/829600-how-do-i-connect-my-device-to-my-account-</a> より。</p>

<p>TestFlightでアカウント作成したら次にiOS機器をTestFlightのアカウントに紐付けます。この作業により開発者がそのiOS機器のDeviceIdをTestFlightから確認でき、そのiOS機器でインストールを許可するアプリケーションを作成することができます。</p>

<p><strong>開発者があなたのDeviceIDに紐づけてアプリを作り直してアップロードする一連の作業があるので、アカウントセットアップした直後にアプリケーションが表示されなかったり、インストールできなくても慌てないでください</strong></p>

<p>iOS端末上でTestFlightからのWelcomeメールを開くとそのメールからログインが出来て、その時にデバイスをあなたのアカウントに紐付けることができます。WelcomeメールがなくてもiOS端末のMobile Safariで <a href="http://www.testflightapp.com/m/login" rel="nofollow noopener" target="_blank">www.testflightapp.com/m/login</a> を開けば大丈夫です。</p>

<p><a href="https://camo.qiitausercontent.com/4c31266157bb434286dac57ccc203391177f8f14/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353936352e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/4c31266157bb434286dac57ccc203391177f8f14/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353936352e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/testflight/testflight_95965.png"></a></p>

<h3>
<span id="ログイン" class="fragment"></span><a href="#%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3"><i class="fa fa-link"></i></a>ログイン</h3>

<p>iOS上でログインページに行ったらログインをします。</p>

<p><a href="https://camo.qiitausercontent.com/7b976fd3b54b599d9c00fbe37ed1c67fa1c7def2/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353936362e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/7b976fd3b54b599d9c00fbe37ed1c67fa1c7def2/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353936362e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/testflight/testflight_95966.png"></a></p>

<h3>
<span id="connect-deviceを押す" class="fragment"></span><a href="#connect-device%E3%82%92%E6%8A%BC%E3%81%99"><i class="fa fa-link"></i></a>Connect Deviceを押す</h3>

<p>するとデバイスを紐付けるページに飛びます。<code>Connect Device</code>ボタンをタップします。</p>

<p><a href="https://camo.qiitausercontent.com/71dbf05d964d7ba750a8ff1653e647fda9b848f4/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353936382e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/71dbf05d964d7ba750a8ff1653e647fda9b848f4/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353936382e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/testflight/testflight_95968.png"></a></p>

<h3>
<span id="profileのインストール" class="fragment"></span><a href="#profile%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>profileのインストール</h3>

<p>Profileのインストールを求められるので<code>Install</code>ボタンをタップします。ProfileがインストールされるとTestFlight mobileのページに戻ります。</p>

<p>Profileをインストールする際にパスコードの入力を求められることがあります。これは設定 &gt; 一般 &gt; パスコードロックの設定によります。</p>

<p><a href="https://camo.qiitausercontent.com/06c68065ecd782fee1bed96c9a03d95927b72651/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353936392e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/06c68065ecd782fee1bed96c9a03d95927b72651/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353936392e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/testflight/testflight_95969.png"></a></p>

<h3>
<span id="メインページ" class="fragment"></span><a href="#%E3%83%A1%E3%82%A4%E3%83%B3%E3%83%9A%E3%83%BC%E3%82%B8"><i class="fa fa-link"></i></a>メインページ</h3>

<p>メインページです。ここからそのiOS機器でダウンロードが許可されたアプリケーションが表示されます。</p>

<p>すぐにはアプリケーションは表示されないでしょう。開発者が紐付けたiOS機器でインストールできるようにするためにアプリケーションをパッケージしなおし、TestFlight上で配布の設定をしないといけないからです。開発者の作業が終わるまで待ちましょう。</p>

<p><a href="https://camo.qiitausercontent.com/29501b14f9c10e871428e75d9c53474e4718766d/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353937312e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/29501b14f9c10e871428e75d9c53474e4718766d/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353937312e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/testflight/testflight_95971.png"></a></p>

<h3>
<span id="ホーム画面" class="fragment"></span><a href="#%E3%83%9B%E3%83%BC%E3%83%A0%E7%94%BB%E9%9D%A2"><i class="fa fa-link"></i></a>ホーム画面</h3>

<p>メインページのWebクリップがホーム画面に追加されるので、そこからTestFlightモバイルページに簡単にアクセスできるようになります。</p>

<p><a href="https://camo.qiitausercontent.com/ee1c24fb5df0ce18a820efef84da7a64082a897d/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353937332e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/ee1c24fb5df0ce18a820efef84da7a64082a897d/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f74657374666c696768742f74657374666c696768745f39353937332e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/testflight/testflight_95973.png"></a></p>

<h2>
<span id="トラブルシューティング" class="fragment"></span><a href="#%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>トラブルシューティング</h2>

<h3>
<span id="アカウントを登録したのにアプリケーションが表示されない" class="fragment"></span><a href="#%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%82%92%E7%99%BB%E9%8C%B2%E3%81%97%E3%81%9F%E3%81%AE%E3%81%AB%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>アカウントを登録したのにアプリケーションが表示されない</h3>

<p>表示するためには開発者側がアプリと機器のIDの紐付けをしたりしないといけないので開発者側の作業を待つ必要があります。開発者に作業の進捗を確認してください。</p>

<h3>
<span id="ダウンロードが途中で失敗する" class="fragment"></span><a href="#%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%81%8C%E9%80%94%E4%B8%AD%E3%81%A7%E5%A4%B1%E6%95%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ダウンロードが途中で失敗する</h3>

<p>TestFlight側の配信サーバ、ネットワークが不安定なのかもしれません。時間を置いて試してください。何度やってもダメな場合は次の項目を参照ください。</p>

<h3>
<span id="インストールができない" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>インストールができない</h3>

<h4>
<span id="原因-ログアウト状態になっている" class="fragment"></span><a href="#%E5%8E%9F%E5%9B%A0-%E3%83%AD%E3%82%B0%E3%82%A2%E3%82%A6%E3%83%88%E7%8A%B6%E6%85%8B%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B"><i class="fa fa-link"></i></a>原因. ログアウト状態になっている</h4>

<p>TestFlightサイトでログアウト状態だと失敗することがあります。しばらくTestFlightを使っていない状態でメールのリンクからインストールしようとすると陥りがちです。</p>

<p>解決方法としてはSafariでTestFlightサイトを開いてログインしているか確認して、ログインしていなければログイン後にもう一度試してください。</p>

<h4>
<span id="原因-アプリとios機器の紐付けがうまく反映されない" class="fragment"></span><a href="#%E5%8E%9F%E5%9B%A0-%E3%82%A2%E3%83%97%E3%83%AA%E3%81%A8ios%E6%A9%9F%E5%99%A8%E3%81%AE%E7%B4%90%E4%BB%98%E3%81%91%E3%81%8C%E3%81%86%E3%81%BE%E3%81%8F%E5%8F%8D%E6%98%A0%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>原因. アプリとiOS機器の紐付けがうまく反映されない</h4>

<p>Provisioning Profileに機器が紐付いていなくてインストールできないことがあります(このビルドにはProvisioning Profileが必要ですというボタンが表示される)</p>

<p>何故か開発者があとからProfileだけをアップロードしても解決できないことがあり（キャッシュか何か?）、解決方法としては開発者にProfileを更新したものをバージョン番号を上げた新しいビルドとしてリリースしてもらうとうまくいくことがあります。</p>

<h3>
<span id="ホーム画面のtestflightアプリが消えてしまったアクセスできなくなった" class="fragment"></span><a href="#%E3%83%9B%E3%83%BC%E3%83%A0%E7%94%BB%E9%9D%A2%E3%81%AEtestflight%E3%82%A2%E3%83%97%E3%83%AA%E3%81%8C%E6%B6%88%E3%81%88%E3%81%A6%E3%81%97%E3%81%BE%E3%81%A3%E3%81%9F%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%9F"><i class="fa fa-link"></i></a>ホーム画面のTestFlightアプリが消えてしまった、アクセスできなくなった</h3>

<p><a href="http://qiita.com/makoto_kw/items/88c43a6e517700d947ee" id="reference-d8ff8b3a68b68bd20116">iOSでTestFlightアプリを再インストールする方法</a> に再インストール方法があります。</p>

<h3>
<span id="ios機器を紐付けするとプロファイルのインストールエラーになる" class="fragment"></span><a href="#ios%E6%A9%9F%E5%99%A8%E3%82%92%E7%B4%90%E4%BB%98%E3%81%91%E3%81%99%E3%82%8B%E3%81%A8%E3%83%97%E3%83%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%AA%E3%82%8B"><i class="fa fa-link"></i></a>iOS機器を紐付けするとプロファイルのインストールエラーになる</h3>

<p>TestFlight上でiOS機器を紐付けする際にプロファイルのインストールを求められそれを行うと以下のようなエラーが発生することがあります。</p>

<blockquote>
<p>プロファイルをインストールできませんでした。<br>
このSCEPサーバ構成はサポートされていません。</p>
</blockquote>

<p><a href="https://camo.qiitausercontent.com/6a94a5b995d5c19c8156524bf23fda708399fbe8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f32396362393130622d393531302d393937642d613262342d6331366665633666373361642e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/6a94a5b995d5c19c8156524bf23fda708399fbe8/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f32396362393130622d393531302d393937642d613262342d6331366665633666373361642e706e67" alt="TestFlightAcessProfileInstallError_300x513.png" title="TestFlightAcessProfileInstallError_300x513.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/29cb910b-9510-997d-a2b4-c16fec6f73ad.png"></a></p>

<p>このエラーがでても問題なく進められるようです。<br>
参考: <a href="http://stackoverflow.com/questions/26696155/testflight-profile-installation-failed-the-scep-server-return-an-invalid-respon" class="autolink" rel="nofollow noopener" target="_blank">http://stackoverflow.com/questions/26696155/testflight-profile-installation-failed-the-scep-server-return-an-invalid-respon</a></p>

<ol>
<li>iOSの<code>設定</code>を起動し、<code>Safari</code>をタップする</li>
<li>
<code>履歴とWebサイトデータを消去</code> を実行する</li>
<li>
<code>Safari</code>を開き testflightapp.com にログインする</li>
<li>紐付け処理を行い、上記のプロファイルのインストールエラーを表示</li>
<li>
<code>OK</code>を押す</li>
<li>左上の<code>キャンセル</code>を押す</li>
</ol>

<p>プロファイルのインストールは完了していませんが機器が紐付いた状態になりアプリの一覧画面が表示できるようになります。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />23位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>42</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/3d6c1d6be84f949f26fd">Google App Engine で Go</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-04-22 11:48:13</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Go]</b> <b>[GAE]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="https://developers.google.com/appengine/docs/go/gettingstarted/" class="autolink" rel="nofollow noopener" target="_blank">https://developers.google.com/appengine/docs/go/gettingstarted/</a></p>

<h1>
<span id="インストール" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>インストール</h1>

<p>Googleのサイト <a href="https://developers.google.com/appengine/downloads#Google_App_Engine_SDK_for_Go" rel="nofollow noopener" target="_blank">Google App Engine SDK for Go</a> からインストールできる。</p>

<p>でもbrewにあったのでそこから入れてみる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>brew install go-app-engine-64
</pre></div></div>

<p>(32bit版は <code>go-app-engine-32</code> )</p>

<p>これで <code>dev_appserver.py</code> や <code>appcfg.py</code> は <code>/usr/local/bin</code> に配置された。</p>

<p>でもPythonのSDKとかとバッティングしても大丈夫なのかよくわからないので共存させるときは自分で別の場所に配置した方がいいかもしれない。</p>

<h2>
<span id="hello-wolrd" class="fragment"></span><a href="#hello-wolrd"><i class="fa fa-link"></i></a><a href="https://developers.google.com/appengine/docs/go/gettingstarted/helloworld" rel="nofollow noopener" target="_blank">Hello, Wolrd!</a>
</h2>

<p><code>myapp</code>, <code>myapp/hello</code> というディレクトリをつくって２つのファイルを用意する。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>myapp/
  app.yaml
  hello/
    hello.go
</pre></div></div>

<p>まず 1 つ目のファイルとして <code>hello</code> サブディレクトリに <code>hello.go</code> ファイルを書く。mainパッケージはSDK側にあるので作らなくていい。</p>

<div class="code-frame" data-lang="go">
<div class="code-lang"><span class="bold">myapp/hello/hello.go</span></div>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">hello</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">"fmt"</span>
    <span class="s">"net/http"</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">http</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="nx">handler</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">handler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">"Hello, world!"</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>

<p>次に 2 つ目のファイルとしてアプリケーション構成 <code>app.yaml</code> ファイルを書く。</p>

<div class="code-frame" data-lang="yaml">
<div class="code-lang"><span class="bold">app.yaml</span></div>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">application</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">helloworld</span>
<span class="l l-Scalar l-Scalar-Plain">version</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="l l-Scalar l-Scalar-Plain">runtime</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">go</span>
<span class="l l-Scalar l-Scalar-Plain">api_version</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">go1</span>

<span class="l l-Scalar l-Scalar-Plain">handlers</span><span class="p p-Indicator">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">url</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">/.*</span>
  <span class="l l-Scalar l-Scalar-Plain">script</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">_go_app</span>
</pre></div>
</div>

<p>そして <code>dev_appserver.py</code> にアプリケーションのディレクトリを渡して起動する。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>dev_appserver.py --admin_port=9998 --port=9999 myapp/
</pre></div></div>

<p><a href="http://localhost:9999/" rel="nofollow noopener" target="_blank">http://localhost:9999/</a> を開くと表示される。</p>

<p>ファイルの変更を監視しているので <code>dev_appserver.py</code> を再起動しなくても、ブラウザをリロードしたら変更を確認できるよとあるが、OS Xの場合、python からシステムにアクセスするために <strong>PyObjC</strong> が必要。Homebrewでpythonをインストールしていれば <code>pip</code> も入っているので</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>pip install -U pyobjc
</pre></div></div>

<p>でインストールする。これでGo SDKからファイルの変更が検出できるようになる。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />24位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>38</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/b700a954f044f0b7a23d">PHPUnitをComposerでインストールする</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-05-22 10:56:44</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[PHP]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="http://phpunit.de/manual/3.7/ja/index.html" class="autolink" rel="nofollow noopener" target="_blank">http://phpunit.de/manual/3.7/ja/index.html</a></p>

<p>プロジェクト毎に特定のバージョンを使う必要がある場合は、Composerでプロジェクト内にインストールする。tarvisを使う場合もこちらかもしれない。</p>

<p>最新の安定版は <a href="https://packagist.org/packages/phpunit/phpunit" class="autolink" rel="nofollow noopener" target="_blank">https://packagist.org/packages/phpunit/phpunit</a> を確認。</p>

<div class="code-frame" data-lang="json">
<div class="code-lang"><span class="bold">composer.json</span></div>
<div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">"require-dev"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"phpunit/phpunit"</span><span class="p">:</span> <span class="s2">"3.7.*"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>

<p>phpunitに限ったことではないが開発時のみ必要な依存モジュールは<code>require</code>ではなく、 <strong><code>require-dev</code></strong> に指定する。すると<code>composer install</code>のときはインストールされずに以下のように<code>--dev</code>を指定した場合にインストールされる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>composer install --dev
</pre></div></div>

<p>Composerでインストールした実行スクリプトは <code>vendor/bin</code> に配置される。</p>

<p>プログラム内からComposerでインストールしたPHPUnitクラスを使うには <code>vendor/autoload.php</code> を読む必要がある。</p>

<p>以上を踏まえると</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>vendor/bin/phpunit --bootstrap vendor/autoload.php app/tests
</pre></div></div>

<p>のようにして実行できる。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />25位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>35</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/52158cbb4d793d6a8ce2">レスポンシブWebデザインのためのMediaQueriesの閾値</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-02-27 15:55:07</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[HTML5]</b> <b>[CSS3]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>参考にさせてもらっているフレームワークなどの設定をピックアップ</p>

<h2>
<span id="twitter-bootstrap-v30" class="fragment"></span><a href="#twitter-bootstrap-v30"><i class="fa fa-link"></i></a>Twitter Bootstrap v3.0</h2>

<div class="code-frame" data-lang="css"><div class="highlight"><pre><span></span><span class="c">/* Extra small devices: Phones (&lt;768px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">767px</span><span class="o">)</span> <span class="p">{}</span>

<span class="c">/* Small devices: Tablets (≥768px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">768px</span><span class="o">)</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">991px</span><span class="o">)</span> <span class="p">{}</span>

<span class="c">/* Medium devices: Desktops (≥992px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">992px</span><span class="o">)</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">1199px</span><span class="o">)</span> <span class="p">{}</span>

<span class="c">/* Large devices: Desktops (≥1200px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">1200px</span><span class="o">)</span> <span class="p">{}</span>
</pre></div></div>

<h2>
<span id="twitter-bootstrap-v23" class="fragment"></span><a href="#twitter-bootstrap-v23"><i class="fa fa-link"></i></a>Twitter Bootstrap v2.3</h2>

<div class="code-frame" data-lang="css"><div class="highlight"><pre><span></span><span class="c">/* Large desktop */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">1200px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Portrait tablet to landscape and desktop */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">768px</span><span class="o">)</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">979px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Landscape phone to portrait tablet */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">767px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Landscape phones and down */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">480px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div></div>

<h2>
<span id="jquery-mobile-v13" class="fragment"></span><a href="#jquery-mobile-v13"><i class="fa fa-link"></i></a>jQuery Mobile v1.3</h2>

<div class="code-frame" data-lang="css"><div class="highlight"><pre><span></span><span class="c">/* Odd iPad positioning issue. */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">only</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-device-width</span><span class="o">:</span> <span class="nt">768px</span><span class="o">)</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-device-width</span><span class="o">:</span> <span class="nt">1024px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Show priority 1 at 320px (20em x 16px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">20em</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Show priority 2 at 480px (30em x 16px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">30em</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Show priority 3 at 640px (40em x 16px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">40em</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Show priority 4 at 800px (50em x 16px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">50em</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Show priority 5 at 960px (60em x 16px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">60em</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>

<span class="c">/* Show priority 6 at 1,120px (70em x 16px) */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">70em</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div></div>

<h2>
<span id="wordpress-tewnty-twelve-theme" class="fragment"></span><a href="#wordpress-tewnty-twelve-theme"><i class="fa fa-link"></i></a>WordPress Tewnty Twelve Theme</h2>

<div class="code-frame" data-lang="css"><div class="highlight"><pre><span></span><span class="c">/* Large desktop */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">960px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="c">/* tablet and desktop */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">600px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div></div>

<h2>
<span id="wordpress-tewnty-eleven-theme" class="fragment"></span><a href="#wordpress-tewnty-eleven-theme"><i class="fa fa-link"></i></a>WordPress Tewnty Eleven Theme</h2>

<div class="code-frame" data-lang="css"><div class="highlight"><pre><span></span><span class="c">/* tablet */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">800px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="c">/* smaller devices */</span>
<span class="p">@</span><span class="k">media</span> <span class="o">(</span><span class="nt">max-width</span><span class="o">:</span> <span class="nt">650px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="c">/* phones */</span>
<span class="p">@</span><span class="k">media</span> <span class="nt">only</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-device-width</span><span class="o">:</span> <span class="nt">320px</span><span class="o">)</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">max-device-width</span><span class="o">:</span> <span class="nt">480px</span><span class="o">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />26位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>32</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/ebb34c0150a5c3c829b8">iOSでSimulatorかどうかを判定する方法</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2012-05-17 13:41:42</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[iPhone]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>- (BOOL)isSimulator
{
    return [[[UIDevice currentDevice] model] hasSuffix:@"Simulator"];
}
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />27位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>31</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/53753cb824f47c4a48df">rbenvでCocoaPodsをセットアップ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-06-13 14:55:31</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> <b>[CocoaPods]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>OS Xには標準でRubyがセットアップされていてこれを使ってCocoaPodsがインストールできる。ただ標準で入っているRubyは/usrディレクトリ以下に入っているためRubyGemsで何か入れようとするといちいち管理者権限(sudoでの実行)が必要になって面倒。</p>

<p>RubyではrbenvやRVMなど複数のバージョンのRubyを管理するためのツールがある。これらのツールは主にユーザのホームディレクトリにrubyをインストールするので管理者権限が不要でシステムディレクトリを汚さないというメリットがある。</p>

<p>能書きはこれくらいにして早速コマンドの列挙。ちなみにgitはXcode Command Line Toolsをインストールすると入る。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>git clone https://github.com/sstephenson/rbenv.git ~/.rbenv
git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.bash_profile
echo 'eval "$(rbenv init -)"' &gt;&gt; ~/.bash_profile
exec $SHELL -l
rbenv install 1.9.3-p327
rbenv rehash
rbenv global 1.9.3-p327
</pre></div></div>

<p>これでrbenvでRuby 1.9.3が使える。<code>ruby -v</code>でバージョンが、<code>rbenv which ruby</code>でインストールされた場所が確認可能。ホームディレクトリに入っていれば勝ち。</p>

<p>1.9.3-p327は単にrbenvのドキュメントにあったまま入れただけ。</p>

<p>次にCocoaPodsのインストール</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>gem install cocoapods
rbenv rehash
pod setup
</pre></div></div>

<p><code>pod --version</code>が動いていればok。</p>

<p><code>rbenv rehash</code>などrbenvについては <a href="http://qiita.com/items/cc73b628c9ef039f6e6f" class="autolink">http://qiita.com/items/cc73b628c9ef039f6e6f</a> にメモ書いています。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />28位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>30</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/75e684435e650a4442a4">iOSでTestFlight SDKを使うときのメモ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-08-09 13:23:00</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> <b>[TestFlight]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><strong>この内容はAppleに買収されiTunes Connectに統合される前のTestFlightについての情報です、testflightapp.comは2015/2/26に終了です。</strong></p>

<p><strong>TestFlightのAndroidサポートは2014/3/21までなので代替サービスを検討してください。</strong><br>
<a href="http://help.testflightapp.com/customer/portal/articles/1450414" class="autolink" rel="nofollow noopener" target="_blank">http://help.testflightapp.com/customer/portal/articles/1450414</a></p>

<p>自分なりの使い方の要約。<br>
<a href="https://testflightapp.com/sdk/ios/doc/" class="autolink" rel="nofollow noopener" target="_blank">https://testflightapp.com/sdk/ios/doc/</a></p>

<h2>
<span id="インストール" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>インストール</h2>

<p>CocoaPodsでインストールする。基本的に安定バージョンを明示的に指定。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Podfile</span></div>
<div class="highlight"><pre><span></span><span class="n">pod</span> <span class="s1">'TestFlightSDK'</span><span class="p">,</span> <span class="s1">'2.0.2'</span>
</pre></div>
</div>

<h2>
<span id="take-off" class="fragment"></span><a href="#take-off"><i class="fa fa-link"></i></a>Take Off</h2>

<p>こんな感じの関数を用意しておくAppStoreに提出するときは<code>#define USE_TESTFLIGHT_SDK 0</code>にしてコードに含めないようにしている。</p>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span>
<span class="cp">#if USE_TESTFLIGHT_SDK</span>
<span class="cp">#import &lt;TestFlightSDK/TestFlight.h&gt;</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> My Apps Custom uncaught exception catcher, we do special stuff here, and TestFlight takes care of the rest</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">HandleExceptions</span><span class="p">(</span><span class="bp">NSException</span> <span class="o">*</span><span class="n">exception</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"This is where we save the application data during a exception"</span><span class="p">);</span>
    <span class="c1">// Save application data on crash</span>
<span class="p">}</span>
<span class="cm">/*</span>
<span class="cm"> My Apps Custom signal catcher, we do special stuff here, and TestFlight takes care of the rest</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">SignalHandler</span><span class="p">(</span><span class="kt">int</span> <span class="n">sig</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"This is where we save the application data during a signal"</span><span class="p">);</span>
    <span class="c1">// Save application data on crash</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">initializeTestFlightWithApplicationToken:</span><span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">token</span>
<span class="p">{</span>
    <span class="c1">// installs HandleExceptions as the Uncaught Exception Handler</span>
    <span class="n">NSSetUncaughtExceptionHandler</span><span class="p">(</span><span class="o">&amp;</span><span class="n">HandleExceptions</span><span class="p">);</span>
    <span class="c1">// create the signal action structure</span>
    <span class="k">struct</span> <span class="n">sigaction</span> <span class="n">newSignalAction</span><span class="p">;</span>
    <span class="c1">// initialize the signal action structure</span>
    <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">newSignalAction</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">newSignalAction</span><span class="p">));</span>
    <span class="c1">// set SignalHandler as the handler in the signal action structure</span>
    <span class="n">newSignalAction</span><span class="p">.</span><span class="n">sa_handler</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">SignalHandler</span><span class="p">;</span>
    <span class="c1">// set SignalHandler as the handlers for SIGABRT, SIGILL and SIGBUS</span>
    <span class="n">sigaction</span><span class="p">(</span><span class="n">SIGABRT</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">newSignalAction</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="n">sigaction</span><span class="p">(</span><span class="n">SIGILL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">newSignalAction</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="n">sigaction</span><span class="p">(</span><span class="n">SIGBUS</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">newSignalAction</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="cp">#if USE_TESTFLIGHT_SDK</span>
<span class="cp">#ifndef __IPHONE_7_0</span>
    <span class="p">[</span><span class="n">TestFlight</span> <span class="nl">setDeviceIdentifier</span><span class="p">:[[</span><span class="bp">UIDevice</span> <span class="n">currentDevice</span><span class="p">]</span> <span class="n">uniqueIdentifier</span><span class="p">]];</span>
<span class="cp">#endif</span>
    <span class="p">[</span><span class="n">TestFlight</span> <span class="nl">takeOff</span><span class="p">:</span><span class="n">token</span><span class="p">];</span>
<span class="cp">#endif</span>
<span class="p">}</span>
</pre></div></div>

<p>あとはAppDelegateのdidFinishLaunchingWithOptionsあたりで呼び出す。さっきの関数もAppDelegateに入れて良い。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">AppDelegate.m</span></div>
<div class="highlight"><pre><span></span><span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">application:</span><span class="p">(</span><span class="bp">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didFinishLaunchingWithOptions:</span><span class="p">(</span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">launchOptions</span>
<span class="p">{</span>    
    <span class="p">[</span><span class="nb">self</span> <span class="n">initializeTestFlightWithApplicationToken</span><span class="s">@"Your App Token"</span><span class="p">];</span>
    <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>

<h2>
<span id="remote-logging" class="fragment"></span><a href="#remote-logging"><i class="fa fa-link"></i></a>Remote Logging</h2>

<p>TFLogを使う。ドキュメントでは以下のようにNSLogと切り替える例がある。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>#define NSLog TFLog
</pre></div></div>

<p>や</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>#define NSLog(__FORMAT__, ...) TFLog((@"%s [Line %d] " __FORMAT__), __PRETTY_FUNCTION__, __LINE__, ##__VA_ARGS__)
</pre></div></div>

<p>それぞれのログは非同期で記録され、セッションが終わる際にTestFlightサーバに送られる。</p>

<p>実際は、AppStoreに提出することも想定してTARGET_APP_STOREなどの定義で処理を切りわけるんじゃないだろうか。自分の場合はUSE_TESTFLIGHT_SDKとTARGET_APP_STOREの定義は明示的に使い分け以下の様な感じにする。</p>

<div class="code-frame" data-lang="objective-c"><div class="highlight"><pre><span></span><span class="cp">#if TARGET_APP_STORE</span>
<span class="cp">#define MyLog(...) ;</span>
<span class="cp">#else</span>
<span class="cp">#if USE_TESTFLIGHT_SDK</span>
<span class="cp">#define MyLog(__FORMAT__, ...) TFLog((@"%s [Line %d] " __FORMAT__), __PRETTY_FUNCTION__, __LINE__, ##__VA_ARGS__);</span>
<span class="cp">#else</span>
<span class="cp">#define MyLog(...) NSLog(__VA_ARGS__)</span>
<span class="cp">#endif </span><span class="c1">// USE_TESTFLIGHT_SDK</span>
<span class="cp">#endif </span><span class="c1">// TARGET_APP_STORE</span>

</pre></div></div>

<h3>
<span id="ログに関するオプション" class="fragment"></span><a href="#%E3%83%AD%E3%82%B0%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3"><i class="fa fa-link"></i></a>ログに関するオプション</h3>

<table>
<thead>
<tr>
<th>オプション名</th>
<th>型</th>
<th>デフォルト</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>logToConsole</td>
<td>BOOL</td>
<td>YES</td>
<td>Apple System Logにも出力するかどうか</td>
</tr>
<tr>
<td>logToSTDERR</td>
<td>BOOL</td>
<td>YES</td>
<td>STDERRにも出力するかどうか</td>
</tr>
</tbody>
</table>

<div class="code-frame" data-lang="例)"><div class="highlight"><pre><span></span>[TestFlight setOptions:@{@"logToConsole:}[NSDictionary dictionaryWithObject:[NSNumber numberWithBool:NO] forKey:@"logToConsole"]];
// iOS SDK 6 or later
[TestFlight setOptions:@{@"logToConsole: @NO}];
</pre></div></div>

<h2>
<span id="feedback-api" class="fragment"></span><a href="#feedback-api"><i class="fa fa-link"></i></a>Feedback API</h2>

<p>openFeedbackViewを実行するとModalでフィードバックを送るフォーム(TextArea、Cancel Button, Submit Button)が表示される。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>[TestFlight openFeedbackView];
</pre></div></div>

<p>submitFeedbackを使えばTestFlightのフォームを使わなくても文字列だけ送信できる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>NSString *feedback = @"my feedback";
[TestFlight submitFeedback:feedback];
</pre></div></div>

<p>FeedbackはTestFlight上からビルドごとに閲覧でき、TestFlightサイトから返信もできる。(メールで通知される)</p>

<h2>
<span id="リリース時" class="fragment"></span><a href="#%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E6%99%82"><i class="fa fa-link"></i></a>リリース時</h2>

<p>USE_TESTFLIGHT_SDK 0にすれば実行しなくなるが、Podfileをコメントアウトしてpod updateするのは面倒なので、スタティックライブラリは<code>Pods.xcconfig</code>のOTHER_LDFLAGSから一時的に<code>-lTestFlight</code>を取り除いてビルドしている。ただ人為ミスが起きそうなのであまり良いやり方だと思わない。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />29位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>30</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/a4346cf5d8124ecd13ec">Xcodeで例外が発生したときにブレークする</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-04-08 11:15:38</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[Xcode]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>unrecognized selectorで落ちた時に、どこで起きてんねん？って思うことあります。</p>

<p>調べたら<a href="http://stackoverflow.com/questions/7354169/breaking-on-unrecognized-selector" rel="nofollow noopener" target="_blank">Breaking on unrecognized selector</a>にあったのでXcode 4.6.1で確認しました。</p>

<h2>
<span id="1-breakpoint-navigatorを開く" class="fragment"></span><a href="#1-breakpoint-navigator%E3%82%92%E9%96%8B%E3%81%8F"><i class="fa fa-link"></i></a>1. Breakpoint Navigatorを開く</h2>

<p><a href="https://camo.qiitausercontent.com/1255d5c8e7fc2bd0319e39dcd7d7fa89405e04ec/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f627265616b746573742f627265616b746573745f323031332d30332d32375f313734352e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/1255d5c8e7fc2bd0319e39dcd7d7fa89405e04ec/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f627265616b746573742f627265616b746573745f323031332d30332d32375f313734352e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/xcode_breaktest/breaktest_2013-03-27_1745.png"></a></p>

<h2>
<span id="2-左下のボタンを押しadd-exception-breakpointを選択" class="fragment"></span><a href="#2-%E5%B7%A6%E4%B8%8B%E3%81%AE%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E6%8A%BC%E3%81%97add-exception-breakpoint%E3%82%92%E9%81%B8%E6%8A%9E"><i class="fa fa-link"></i></a>2. 左下の+ボタンを押し、Add Exception Breakpoint…を選択</h2>

<p><a href="https://camo.qiitausercontent.com/6d9aaa3cdff971a72bb807ae9f3168f227165de8/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f627265616b746573742f627265616b746573745f323031332d30332d32375f31373435322e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/6d9aaa3cdff971a72bb807ae9f3168f227165de8/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f627265616b746573742f627265616b746573745f323031332d30332d32375f31373435322e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/xcode_breaktest/breaktest_2013-03-27_17452.png"></a></p>

<h2>
<span id="3-objecive-cの例外でブレークする設定" class="fragment"></span><a href="#3-objecive-c%E3%81%AE%E4%BE%8B%E5%A4%96%E3%81%A7%E3%83%96%E3%83%AC%E3%83%BC%E3%82%AF%E3%81%99%E3%82%8B%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>3. Objecive-Cの例外でブレークする設定</h2>

<p>C++の例外も選べる模様</p>

<p><a href="https://camo.qiitausercontent.com/4e59d723e986f7459fdf8d853ed266f7baa8f471/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f627265616b746573742f627265616b746573745f323031332d30332d32375f313734362e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/4e59d723e986f7459fdf8d853ed266f7baa8f471/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f627265616b746573742f627265616b746573745f323031332d30332d32375f313734362e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/xcode_breaktest/breaktest_2013-03-27_1746.png"></a></p>

<h2>
<span id="4-ブレーきんぐ" class="fragment"></span><a href="#4-%E3%83%96%E3%83%AC%E3%83%BC%E3%81%8D%E3%82%93%E3%81%90"><i class="fa fa-link"></i></a>4. ブレーきんぐ</h2>

<p><a href="https://camo.qiitausercontent.com/f187cff50dc07d4b70c119a6a305b76cceadd8c4/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f627265616b746573742f627265616b746573745f323031332d30332d32375f313734372e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/f187cff50dc07d4b70c119a6a305b76cceadd8c4/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f627265616b746573742f627265616b746573745f323031332d30332d32375f313734372e706e67" alt="" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/xcode_breaktest/breaktest_2013-03-27_1747.png"></a></p>

<p>ブレークしたくないときはBreakpoint Navigatorから該当ブレークポイントを右クリックでDisableにすれば有効・無効を切り替えられます。</p>

<p>Visual Studioにも似たような設定があります、あっちは例外クラスごとに止めるかどうか設定できますが、今のこところこれで十分。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />30位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>29</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/f81712ce13b9addd9192">古いバージョンのCocoaPodsをつかう</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-01-08 16:29:40</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> <b>[CocoaPods]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>CocoaPods本体の古いバージョンを使う話。普通は問題ないが強引なことをやっているとバージョンアップして動かなくなることがある。</p>

<p>以下のようにして古いバージョンにダウングレードできる。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>gem uninstall cocoapods --version<span class="o">=</span><span class="m">0</span>.26.2
gem install cocoapods -v <span class="m">0</span>.25
</pre></div></div>

<p>別の方法として特定のプロジェクトだけ別のバージョンを使いたい場合はBundlerを使い、Gemfileを以下のように作成して</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Gemfile</span></div>
<div class="highlight"><pre><span></span><span class="n">source</span> <span class="s1">'https://rubygems.org'</span>
<span class="n">gem</span> <span class="s1">'cocoapods'</span><span class="p">,</span> <span class="s1">'0.25.0'</span>
</pre></div>
</div>

<p><code>bundle install</code> でインストールする。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>bundle install --path<span class="o">=</span>vendor/bundle
</pre></div></div>

<p>podコマンドを使うときは <code>bundle exec</code> を使う。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>bundle <span class="nb">exec</span> pod --version
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />31位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>26</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/525cd94e884402b5bea9">SinatraのModular Applicationで機能分割</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-01-29 23:45:49</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> <b>[Sinatra]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>男は黙ってClassic Styleで1ファイルと言いたいところだがさすがに行数が増えてくるとメンテンナンスし辛いのでファイルをゆるーく分割する。</p>

<p>Modular Applicationの場合は</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">config.ru</span></div>
<div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">'./my_app'</span>
<span class="n">run</span> <span class="no">MyApp</span>
</pre></div>
</div>

<p>のようにして<code>Sinatra::Base</code>の継承クラスを<code>run</code>で渡して実行できるが、<code>map</code>と組み合わせることで、URLのマッピングにあわせて切り替えることができる。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">config.ru</span></div>
<div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">'./app'</span>
<span class="nb">require</span> <span class="s1">'./hello'</span>

<span class="n">map</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span> <span class="p">{</span> <span class="n">run</span> <span class="no">App</span> <span class="p">}</span>
<span class="n">map</span><span class="p">(</span><span class="s1">'/hello'</span><span class="p">)</span> <span class="p">{</span> <span class="n">run</span> <span class="no">Hello</span> <span class="p">}</span>
</pre></div>
</div>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">app.rb</span></div>
<div class="highlight"><pre><span></span><span class="nb">require</span> <span class="s1">'bundler'</span>
<span class="no">Bundler</span><span class="o">.</span><span class="n">require</span>

<span class="k">class</span> <span class="nc">App</span> <span class="o">&lt;</span> <span class="no">Sinatra</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">configure</span> <span class="ss">:development</span> <span class="k">do</span>
    <span class="no">Bundler</span><span class="o">.</span><span class="n">require</span> <span class="ss">:development</span>
    <span class="n">register</span> <span class="no">Sinatra</span><span class="o">::</span><span class="no">Reloader</span>
  <span class="k">end</span>

  <span class="n">get</span> <span class="s1">'/'</span> <span class="k">do</span>
    <span class="s1">'welcome'</span>
  <span class="k">end</span>

  <span class="n">not_found</span> <span class="k">do</span>
    <span class="s1">'not_found'</span>
  <span class="k">end</span>

  <span class="n">error</span> <span class="k">do</span>
    <span class="s1">'error'</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">hello.rb</span></div>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Hello</span> <span class="o">&lt;</span> <span class="no">App</span>
  <span class="n">get</span> <span class="s1">'/:name'</span> <span class="k">do</span>
    <span class="s2">"Hello </span><span class="si">#{</span><span class="n">params</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span><span class="si">}</span><span class="s2">!"</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>

<p>こんな風にすると<code>/hello/taro</code>というリクエストはhello.rbで処理できる。MVCでいうとControllerを作っているだけなのだがMVCやりだすとSinatra以外のフレームワークを使った方がいいんじゃないかと疑心暗鬼になるのでゆるい機能分割程度に留める。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />32位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>24</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/1c92e8102763f81ab26f">RubyMotion 事始め</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-06-03 13:37:59</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> <b>[iOS]</b> <b>[RubyMotion]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h2>
<span id="rubymotionとは" class="fragment"></span><a href="#rubymotion%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a><a href="http://www.rubymotion.com/" rel="nofollow noopener" target="_blank">RubyMotion</a>とは</h2>

<ul>
<li>RubyでiOS, OS Xネイティブアプリを作る toolchain</li>
<li>Cocoaフレームワークの上に薄いラッパをかけてRubyから使えるようにしている、よってRubyでCocoaフレームワークを使うというコーディングになる</li>
<li>RubyMotionのコンパイラがRubyファイルをアセンブラにし、gccでobjファイルにする、そのためObjective-Cの実装と双方向でやり取りできる

<ul>
<li>Objective-Cの資産も活かせる</li>
</ul>
</li>
<li>ネイティブにリンクされるので実行時にJitでコンパイルする他のこの手のものと比べて実行速度が速い</li>
<li>エディタは好きなものを選ぶ</li>
<li>gemはRubyMotion用のgemしか使えない、<a href="http://rubymotion-wrappers.com/" rel="nofollow noopener" target="_blank">RubyMotion Wrappers</a>に有名なものがある</li>
<li>
<a href="https://github.com/HipByte/motion-cocoapods" rel="nofollow noopener" target="_blank">motion-cocoapods</a>を使えばCocoaPodsの実装も簡単に呼び出せる</li>
</ul>

<h2>
<span id="ライセンス" class="fragment"></span><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9"><i class="fa fa-link"></i></a>ライセンス</h2>

<ul>
<li>
<strong>有償</strong>, <a href="http://www.rubymotion.com/" rel="nofollow noopener" target="_blank">RubyMotion</a>のサイトから購入可能

<ul>
<li>試してだめったら30日クーリングオフ可能</li>
</ul>
</li>
<li>購入したバージョンについては有効期限はない</li>
<li>一年間はアップデートを無料で受け取れ、サポートがある</li>
<li>一年後からライセンスの半額で更新すると最新版のアップデートやサポートの権利を得られる</li>
</ul>

<h2>
<span id="開発に必要なもの" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E3%81%AB%E5%BF%85%E8%A6%81%E3%81%AA%E3%82%82%E3%81%AE"><i class="fa fa-link"></i></a>開発に必要なもの</h2>

<ul>
<li>OS X 10.6 以上 (10.7以上推奨)</li>
<li>RubyMotion

<ul>
<li>ライセンスを買うとインストーラがダウンロードでき <code>/usr/bin/motion</code> にインストールされる</li>
</ul>
</li>
<li>Xcode (IDE本体というより以下をインストールするために必要)

<ul>
<li>iOS SDK や OS X SDK</li>
<li>Xcode Command Line Tools</li>
</ul>
</li>
<li>お好きなエディタ</li>
</ul>

<h2>
<span id="motionコマンド" class="fragment"></span><a href="#motion%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89"><i class="fa fa-link"></i></a>motionコマンド</h2>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>$ motion -v
2.0
$ motion --help
Usage:
  motion [-h, --help]
  motion [-v, --version]
  motion &lt;command&gt; [&lt;args...&gt;]

Commands:
  account      Access the software license account
  activate     Activate the software license
  create       Create a new project
  ri           Display API reference
  support      Create a support ticket
  update       Update the software
</pre></div></div>

<p>なんとなく<code>motion create</code>か<code>motion update</code>しか使わない予感。</p>

<p><code>motion create --help</code>ってやったら<code>--help</code>ってプロジェクト作られたので注意。</p>

<h2>
<span id="hello-world" class="fragment"></span><a href="#hello-world"><i class="fa fa-link"></i></a>Hello, World</h2>

<p>なんとなくシミュレータ不要なOS Xの方が試すのは楽かなと思ってOS Xでやってみる。</p>

<p><code>motion create</code>でプロジェクト作成。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>motion create --template<span class="o">=</span>osx Hello
</pre></div></div>

<p>こんな感じの階層。</p>

<p><a href="https://camo.qiitausercontent.com/56f2fb69c38ac9244c51b18303845702829a616c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f36326665643139352d326564612d343035362d393739362d3739356165633538623462302e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/56f2fb69c38ac9244c51b18303845702829a616c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f36326665643139352d326564612d343035362d393739362d3739356165633538623462302e706e67" alt="rubymotion_2013-05-31_1743.png" title="rubymotion_2013-05-31_1743.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/62fed195-2eda-4056-9796-795aec58b4b0.png"></a></p>

<p>チュートリアルに沿って <code>app/app_delegate.rb</code> にAlertを追加してみる。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">app_delegate.rb</span></div>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AppDelegate</span>
  <span class="k">def</span> <span class="nf">applicationDidFinishLaunching</span><span class="p">(</span><span class="n">notification</span><span class="p">)</span>
    <span class="n">buildMenu</span>
    <span class="n">buildWindow</span>

    <span class="c1"># 追加</span>
    <span class="n">alert</span> <span class="o">=</span> <span class="no">NSAlert</span><span class="o">.</span><span class="n">new</span>
    <span class="n">alert</span><span class="o">.</span><span class="n">messageText</span> <span class="o">=</span> <span class="s1">'こんにちは'</span>
    <span class="n">alert</span><span class="o">.</span><span class="n">runModal</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">buildWindow</span>
    <span class="vi">@mainWindow</span> <span class="o">=</span> <span class="no">NSWindow</span><span class="o">.</span><span class="n">alloc</span><span class="o">.</span><span class="n">initWithContentRect</span><span class="p">(</span><span class="o">[[</span><span class="mi">240</span><span class="p">,</span> <span class="mi">180</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">480</span><span class="p">,</span> <span class="mi">360</span><span class="o">]]</span><span class="p">,</span>
                                                     <span class="ss">styleMask</span><span class="p">:</span> <span class="no">NSTitledWindowMask</span><span class="o">|</span><span class="no">NSClosableWindowMask</span><span class="o">|</span><span class="no">NSMiniaturizableWindowMask</span><span class="o">|</span><span class="no">NSResizableWindowMask</span><span class="p">,</span>
                                                     <span class="ss">backing</span><span class="p">:</span> <span class="no">NSBackingStoreBuffered</span><span class="p">,</span>
                                                     <span class="ss">defer</span><span class="p">:</span> <span class="kp">false</span><span class="p">)</span>
    <span class="vi">@mainWindow</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="no">NSBundle</span><span class="o">.</span><span class="n">mainBundle</span><span class="o">.</span><span class="n">infoDictionary</span><span class="o">[</span><span class="s1">'CFBundleName'</span><span class="o">]</span>
    <span class="vi">@mainWindow</span><span class="o">.</span><span class="n">orderFrontRegardless</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>

<p><code>rake</code>で実行。</p>

<p><a href="https://camo.qiitausercontent.com/11ecaa199b999d3417f5f83e815d0db315a65cec/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f63343264656363302d646135342d323738652d316234372d3935623839326666633134612e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/11ecaa199b999d3417f5f83e815d0db315a65cec/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f63343264656363302d646135342d323738652d316234372d3935623839326666633134612e706e67" alt="rubymotion_2013-05-31_1744.png" title="rubymotion_2013-05-31_1744.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/c42decc0-da54-278e-1b47-95b892ffc14a.png"></a></p>

<p>これは便利だ。あとはサンプルプロジェクトを見ながら勉強していく。<br>
<a href="https://github.com/HipByte/RubyMotionSamples" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/HipByte/RubyMotionSamples</a></p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />33位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>22</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/12620b9242e7e8402523">ChromecastのPreview SDKでChromecastDemoを動かすまで (iOS)</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-08-21 11:53:47</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> <b>[ChromeCast]</b> <b>[GoogleCastSDK]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>Googleのドキュメントは <a href="https://developers.google.com/cast/" rel="nofollow noopener" target="_blank">https://developers.google.com/cast/</a>にある。</p>

<p><strong>Cast SDK 1.0.0の情報。2013/8時点ではGoogle Cast SDKはPreview版であってこれから変更があるかもしれないから製品にはまだ組み込まないでねとある</strong></p>

<p>ChromecastにはSenderアプリとReceiverアプリの２つの概念があり、iOSアプリはSenderアプリになれる。Receiverアプリはウェブ上に存在しHTML/CSS/Javascriptで構成されChromecast(Chrome)側が実行する、要するにウェブアプリ。</p>

<p>SenderアプリがReceiverアプリ(ウェブアプリ)のホスト先をChromecast(Chrome)に伝えてそこでReceiverアプリを表示してもらい、Receiverアプリとメッセージをやりとりするので双方の開発が必要となる。</p>

<p>技術的にはiOSアプリの内部でWebサーバを実行し、Receiverアプリを配信できると思うが現状のPreview SDKでは後に記述するホワイトリストの制限がある。</p>

<h2>
<span id="ホワイトリスト申請" class="fragment"></span><a href="#%E3%83%9B%E3%83%AF%E3%82%A4%E3%83%88%E3%83%AA%E3%82%B9%E3%83%88%E7%94%B3%E8%AB%8B"><i class="fa fa-link"></i></a>ホワイトリスト申請</h2>

<p>デフォルトではChromecastは開発モードになっておらずChromecast上で実行されるReceiverアプリがPreview SDKのReceiver APIを使ったり、リモートデバッグするためにはホワイトリストに登録する必要がある。</p>

<p>ホワイトリストに登録するにはGoogleに以下の情報を<a href="https://docs.google.com/forms/d/1E-vka5QP8LkF0nbfz-omN1DjNSX1uLGyqHdbpEFh6zg/viewform" rel="nofollow noopener" target="_blank">フォーム</a>から送信する。</p>

<ul>
<li>メールアドレス</li>
<li>デバイスのシリアルナンバー</li>
<li>レシーバーアプリのURL(検証用と本番用)</li>
</ul>

<p>48時間以内に返事が来るとあるが基本的に24時間以内にはAppIDが発行された。</p>

<p>最初に申請リクエストを投げるとAppID -&gt; URL というキーバリューで発行される。次からはデバイスを追加する場合はAppIDだけでも済む。AppIDはUUIDのようなものが発行され、iOS/AndroidのFQDNを逆にしたIDなどをこちらから指定することはできない。</p>

<p>なおChromecastはGoogleのDNSサーバを直接参照するため、ローカルネットワークのDNSサーバを使って内部用のURLのホスト名を名前解決することができない。従ってローカル内で開発する場合は <a href="http://192.168.1.2/receiver/receiver.html" class="autolink" rel="nofollow noopener" target="_blank">http://192.168.1.2/receiver/receiver.html</a> などIPアドレスを指定したURLを申請する。ちなみにローカルのIPアドレスでport:3000でも問題なく動作した。</p>

<h2>
<span id="chromecastの開発の準備" class="fragment"></span><a href="#chromecast%E3%81%AE%E9%96%8B%E7%99%BA%E3%81%AE%E6%BA%96%E5%82%99"><i class="fa fa-link"></i></a>Chromecastの開発の準備</h2>

<p><a href="https://cast.google.com/chromecast/setup" rel="nofollow noopener" target="_blank">セットアップ</a>時にインストールしたChromecastアプリを起動し、Chromecastの設定で <strong>Send serial number when Checking for updates</strong> にチェックを入れ、念の為に Reboot しておく。</p>

<p>ホワイトリスト申請がうまく行っていれば ChromecastのIPアドレス:9222　がリモートデバッグURLとして開ける。</p>

<h2>
<span id="chromecastdemo--sdkのセットアップ" class="fragment"></span><a href="#chromecastdemo--sdk%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>ChromecastDemo + SDKのセットアップ</h2>

<p>ChromecastDemoはGitHub googlecast/cast-ios-sampleで公開されていたがCast SDK 1.0.1で新しいサンプルが公開されて削除されてしまった。Apacheライセンスだったので<a href="https://dl.dropboxusercontent.com/u/8932138/downloads/chromecast/cast-ios-sample.zip" rel="nofollow noopener" target="_blank">コピー</a>を置いた。cast-ios-sampleにはSDKは含まれておらず、<a href="https://developers.google.com/cast/downloads/" rel="nofollow noopener" target="_blank">Google Cast Downloads</a>の <strong>Download the iOS Sender API libraries</strong> よりダウンロードできる。</p>

<p>SDKはFrameworkとして提供されており任意の場所に置き、サンプルプロジェクトのTARGET &gt; Build Phases &gt; Link Binary With Librariesからフォルダを指定して追加することができる。</p>

<p>実際のChromecastとの連携は実機で動作する必要があるが、起動自体はシミュレータおよびChromecastなしでも可能なので、ビルドが通るか、アプリが実行できるかどうかまではここで確認することができる。</p>

<p>このサンプルはiOSアプリであるChromecastDemoがSenderアプリとして動画のURLをReceiverアプリに送信し、Receiverアプリがその動画をvideoタグで再生するというものになっている。動画の再生のサポートについては以下に記載がある。</p>

<p><a href="https://developers.google.com/cast/supported_media_types" class="autolink" rel="nofollow noopener" target="_blank">https://developers.google.com/cast/supported_media_types</a></p>

<ul>
<li>Video codecs: H.264 High Profile Level 4.1, 4.2 and 5, VP8</li>
<li>Audio decoding: HE-AAC, LC-AAC, CELT/OPUS, MP3</li>
<li>Containers: MP4/CENC, WebM, MPEG-DASH, SmoothStreaming</li>
<li>Level 1 DRM support: Widevine, Playready</li>
</ul>

<h2>
<span id="senderアプリとrecieverアプリの修正" class="fragment"></span><a href="#sender%E3%82%A2%E3%83%97%E3%83%AA%E3%81%A8reciever%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E4%BF%AE%E6%AD%A3"><i class="fa fa-link"></i></a>SenderアプリとRecieverアプリの修正</h2>

<p>サンプルプロジェクトを動かすにはホワイトリスト申請で取得したAppIDをSenderアプリとRecieverアプリに埋め込み、Recieverアプリ(htmlファイル)を申請したURLに配置する。</p>

<p>Senderアプリ側はChoromecastDemoプロジェクトの <strong>GCKViewController.m</strong> ファイルの114行目あたりの <strong>YOUR_APP_ID</strong> をAppIDに置き換える。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">GCKViewController.m</span></div>
<div class="highlight"><pre><span></span>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Starting session."</span><span class="p">);</span>
    <span class="p">[</span><span class="nb">self</span><span class="p">.</span><span class="n">mSession</span> <span class="nl">startSessionWithApplication</span><span class="p">:</span><span class="s">@"YOUR_APP_ID"</span>
                                      <span class="nl">argument</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">applicationArgument</span><span class="p">];</span>
</pre></div>
</div>

<p>iOSのSenderアプリであるChromecastDemoでは、GCKAppDelegate.m にてRecieverアプリのURLを設定する箇所があるのだが、AndroidのDemoプロジェクトではこのような設定はなく、iOSアプリでも設定しなくても動作した。ChromecastはAppIDをキーにしてURLを取得する。</p>

<p>Recieverアプリ側は <strong>receiver/receiver.html</strong> ファイルの25行目あたりの <strong>GoogleCastSampleApp</strong> をAppIDに置き換える。</p>

<div class="code-frame" data-lang="html">
<div class="code-lang"><span class="bold">receiver/receiver.html</span></div>
<div class="highlight"><pre><span></span>var receiver = new cast.receiver.Receiver(
  'GoogleCastSampleApp', 
  [cast.receiver.RemoteMedia.NAMESPACE],
  "",
  5);
</pre></div>
</div>

<h2>
<span id="実行" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>実行</h2>

<p>ChromecastおよびiOSデバイスを同じネットワークに接続させ、ChromecastDemoを実行する。実機の動作はXcodeからのデバッグ実行でも問題なかった。</p>

<p>ChromecastDemoがChromecastを発見すると右上にテレビアイコンが表示されるのでそれを押してChromecastを選択肢、動画のリストを選択すると動画がChromecastに接続したディスプレイに表示される。</p>

<h2>
<span id="トラブルシューティング" class="fragment"></span><a href="#%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>トラブルシューティング</h2>

<h3>
<span id="セッションができず画面にabortが表示される-1" class="fragment"></span><a href="#%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%9A%E7%94%BB%E9%9D%A2%E3%81%ABabort%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B-1"><i class="fa fa-link"></i></a>セッションができず画面にAbortが表示される 1</h3>

<p><strong>GCK Session failed to start: Error Domain=com.google.GCKFramework.GCKApplicationSessionError Code=1 "failed to start application (com.google.GCKFramework.GCKApplicationSessionError)</strong> が出力される時は指定したReceiverアプリがホワイトリスト対応できていない。確認すべきポイントはAppIDを正しく指定できているか、申請したシリアル番号が正しいか、Chromecastの開発の準備で更新時にシリアル番号を送信する設定にしているかを確認すること。</p>

<p>切り分けとしてChromecastのIPアドレス:9222を開けない場合はリモートデバッグができていないので申請または設定がうまく行っていない。</p>

<h3>
<span id="セッションができず画面にabortが表示される-2" class="fragment"></span><a href="#%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%9A%E7%94%BB%E9%9D%A2%E3%81%ABabort%E3%81%8C%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B-2"><i class="fa fa-link"></i></a>セッションができず画面にAbortが表示される 2</h3>

<p><strong>GCK Session failed to start: Error Domain=com.google.GCKFramework.GCKApplicationSessionError Code=3 "application stopped unexpectedly (com.google.GCKFramework.GCKApplicationSessionError)</strong> が出力される場合はReceiverアプリは登録されているが、ReceiverアプリのURLにアクセスができていない。ChromecastはGoogleのDNSサーバを直接参照するためLAN内のURLの場合を使う場合は注意すること。受け取ったAppIDとレシーバーアプリのURLを再申請すればURLを更新することができる。</p>

<h3>
<span id="画面が真っ暗のまま動画が再生されない" class="fragment"></span><a href="#%E7%94%BB%E9%9D%A2%E3%81%8C%E7%9C%9F%E3%81%A3%E6%9A%97%E3%81%AE%E3%81%BE%E3%81%BE%E5%8B%95%E7%94%BB%E3%81%8C%E5%86%8D%E7%94%9F%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>画面が真っ暗のまま動画が再生されない。</h3>

<p>セッションは開始できるが、動画が再生できない場合はSenderアプリとReceiverアプリがメッセージのやりとりを行えていないおそれがある。Receiverアプリ(receiver.html)に設定したAppIDがSenderアプリと同じものかを確認すること。</p>

<h2>
<span id="その他" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96"><i class="fa fa-link"></i></a>その他</h2>

<ul>
<li>ChromecastのChrome ExtensionをGoogle Chromeにインストールするにはバージョンが28以降が必要</li>
<li>
<a href="http://stackoverflow.com/questions/17914645/chromecast-startapplicationrequest-failed-with-status-4" rel="nofollow noopener" target="_blank">Chromecast “StartApplicationRequest failed with status: -4”</a> iOSサンプルのトラップはここで判明</li>
<li>
<a href="http://forum.xda-developers.com/showthread.php?p=44070932" rel="nofollow noopener" target="_blank">Chromecast in Canada!</a> DNSサーバのトラップはここで判明</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />34位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>20</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/ba26bc844161090e6a96">PonyDebugger v0.2.1を試してみた</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-02-01 16:12:43</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Objective-C]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>v0.2.1-beta1 でのメモ。 Xcodeは4.6。</p>

<p><a href="https://github.com/square/PonyDebugger" rel="nofollow noopener" target="_blank">PonyDebugger</a>はiOSアプリをChrome Developer Toolsを使ってリモートデバッグできるツール。大きく３つの機能がある。</p>

<ul>
<li>Network Traffic Debugging</li>
<li>Core Data Browser</li>
<li>View Hierarchy Debugging</li>
</ul>

<h2>
<span id="プロキシサーバのセットアップ" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%AD%E3%82%B7%E3%82%B5%E3%83%BC%E3%83%90%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>プロキシサーバのセットアップ</h2>

<p><strong>ponyd</strong>というPonyDebuggerのプロキシサーバを挟んでChrome Developer Toolsから閲覧する。</p>

<p>というわけでponydをインストールする。XcodeのCommand Line Toolsが必要なのでXcodeの設定のDownalodsタブから入れておくこと。ponydについては<a href="https://github.com/square/PonyDebugger/blob/master/README_ponyd.rst" rel="nofollow noopener" target="_blank">こちら</a>にREADMEがある。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>curl -sk https://cloud.github.com/downloads/square/PonyDebugger/bootstrap-ponyd.py <span class="p">|</span> <span class="se">\</span>
  python - --ponyd-symlink<span class="o">=</span>/usr/local/bin/ponyd ~/Library/PonyDebugger
</pre></div></div>

<p>上記のコマンドだと~/Library/PonyDebugger/bin/ponydにインストールされ、/usr/local/bin/ponydにシンボリックリンクが貼られる。/usr/local/binにパスが通っていれば以下で実行できる。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>ponyd serve --listen-interface<span class="o">=</span><span class="m">127</span>.0.0.1
</pre></div></div>

<p>するとブラウザで <a href="http://localhost:9000" class="autolink" rel="nofollow noopener" target="_blank">http://localhost:9000</a> が閲覧可能になる。</p>

<h2>
<span id="iosアプリ側の作業" class="fragment"></span><a href="#ios%E3%82%A2%E3%83%97%E3%83%AA%E5%81%B4%E3%81%AE%E4%BD%9C%E6%A5%AD"><i class="fa fa-link"></i></a>iOSアプリ側の作業</h2>

<p>iOSアプリ側にPonyDebugger iOS Clientを組み込む。モジュールはiOS5以上でARCが有効でSocketRocketというWebSocketクライアントを使っている。</p>

<p>pod search Pony実行したらPonyDebugger (0.0.1)が見つかったので<a href="http://cocoapods.org/" rel="nofollow noopener" target="_blank">CocoaPods</a>で入れてみる。</p>

<p>しかし<a href="https://github.com/CocoaPods/Specs/blob/master/PonyDebugger/0.0.1/PonyDebugger.podspec" rel="nofollow noopener" target="_blank">0.0.1のpodspec</a>はコミットが31d05eb56b2d1b04e815579ba15b0b7c4104596eになっていてREADMEにある例を試そうとしたらautoConnectなんて定義されてねーよと怒られたのでPodspecを置き換える。</p>

<p>0.2.1のpodsecを作ろうかと思ったのだがXcode 4.6の修正らしきものがその後にコミットにあったので0.0.1を修正することにした。~/.cocoapods/master/PonyDebugger/0.0.1/PonyDebugger.podspecのs.sourceにあるコミット指定を外す。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">~/.cocoapods/master/PonyDebugger/0.0.1/PonyDebugger.podspec</span></div>
<div class="highlight"><pre><span></span>  <span class="n">s</span><span class="o">.</span><span class="n">source</span>       <span class="o">=</span> <span class="p">{</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s2">"https://github.com/square/PonyDebugger.git"</span> <span class="p">}</span>
</pre></div>
</div>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Podfile</span></div>
<div class="highlight"><pre><span></span><span class="n">platform</span> <span class="ss">:ios</span><span class="p">,</span><span class="s1">'5.0'</span>
<span class="n">pod</span> <span class="s1">'PonyDebugger'</span>
</pre></div>
</div>

<p>pod installするとframeworkの依存関係も解決してくれる。試したときはPods.xcconfigのOTHER_LDFLAGSが参照されておらずリンクエラーがでたのでTARGETのOther Linker Flagsに$(inherited)を追加しておいた。</p>

<p>次に以下のようなコードを追加した。</p>

<div class="code-frame" data-lang="objectivec">
<div class="code-lang"><span class="bold">AppDelegate.m</span></div>
<div class="highlight"><pre><span></span><span class="cp">#import &lt;PonyDebugger/PonyDebugger.h&gt;</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">application:</span><span class="p">(</span><span class="bp">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didFinishLaunchingWithOptions:</span><span class="p">(</span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">launchOptions</span>
<span class="cp">#if DEBUG    </span>
    <span class="n">PDDebugger</span> <span class="o">*</span><span class="n">debugger</span> <span class="o">=</span> <span class="p">[</span><span class="n">PDDebugger</span> <span class="n">defaultInstance</span><span class="p">];</span>
    <span class="p">[</span><span class="n">debugger</span> <span class="n">enableViewHierarchyDebugging</span><span class="p">];</span>
    <span class="p">[</span><span class="n">debugger</span> <span class="n">enableCoreDataDebugging</span><span class="p">];</span>
    <span class="p">[</span><span class="n">debugger</span> <span class="n">enableNetworkTrafficDebugging</span><span class="p">];</span>
    <span class="p">[</span><span class="n">debugger</span> <span class="n">forwardAllNetworkTraffic</span><span class="p">];</span>
    <span class="p">[</span><span class="n">debugger</span> <span class="nl">connectToURL</span><span class="p">:[</span><span class="bp">NSURL</span> <span class="nl">URLWithString</span><span class="p">:</span><span class="s">@"ws://localhost:9000/device"</span><span class="p">]];</span>
<span class="cp">#endif</span>
</pre></div>
</div>

<h2>
<span id="結果" class="fragment"></span><a href="#%E7%B5%90%E6%9E%9C"><i class="fa fa-link"></i></a>結果</h2>

<p>アプリを実行すると <a href="http://localhost:9000" class="autolink" rel="nofollow noopener" target="_blank">http://localhost:9000</a> に接続中の一覧が表示され、アプリ名をクリックするとdevtoolが表示される。</p>

<p>とりあえず試したプロジェクトで確認できたのはView Hierarchy Debuggingだけ。Core Data Browserについては単にCoreDataを使っていなかったので未確認。Network Traffic DebuggingについてはNSURLConnectionDelegateプロトコルの実装を置き換えている都合上、例えば以下のようなコードから通信データをponydに送りつけるのは難しいようだ。</p>

<div class="code-frame" data-lang="objectivec"><div class="highlight"><pre><span></span><span class="p">[</span><span class="bp">NSURLConnection</span> <span class="nl">sendAsynchronousRequest</span><span class="p">:</span><span class="n">request</span>
                                       <span class="nl">queue</span><span class="p">:[</span><span class="bp">NSOperationQueue</span> <span class="n">mainQueue</span><span class="p">]</span>
                           <span class="nl">completionHandler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="bp">NSURLResponse</span> <span class="o">*</span><span class="n">response</span><span class="p">,</span> <span class="bp">NSData</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
<span class="p">}];</span>
</pre></div></div>

<h2>
<span id="その他" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96"><i class="fa fa-link"></i></a>その他</h2>

<ul>
<li>アプリのプロセスが変わるたびにページを変えないといけない。単純にインクリメントしているのでURLのpageパラメータを増やせばいい <code>http://localhost:9000/devtools/devtools.html?host=localhost:9000&amp;page=1</code>
</li>
<li>Chrome以外のブラウザでも表示できる。ChromeのDeveloper Toolsで見ているのではなくて、Chrome Developer Tools相当のページをponydが返している模様。ただWebKitベースじゃないとレイアウトが崩れる。</li>
<li>
<code>ponyd serve --listen-interface=0.0.0.0</code>でプロキシサーバを実行して、PDDebugger::connectToURLでホスト側のIPアドレスを指定したら実機でも動作した</li>
<li>rubyは問題なかったがponyd実行中にローカルのphp5.4のビルドインWebサーバからレスポンスが返ってこなくなった</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />35位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>16</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/11c411fb116f74d43bdc">RubyMine で RubyMotion 事始め</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-12-16 21:13:51</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> <b>[iOS]</b> <b>[RubyMotion]</b> <b>[RubyMine]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="http://qiita.com/makoto_kw/items/1c92e8102763f81ab26f" id="reference-eee70ff0af44887c8b3d">RubyMotion 事始め</a>を書いてから半年経つが <strong>まるで成長していない。</strong></p>

<p>そういえばRubyMineがRubyMotion対応しているという話をRubyMotion Kaigiで聞いたことがある。ちょうどRubyMine 6がリリースされていたのでRubyMineでできることを調べれば勉強＆有識者にも情報になるのではと考えることにした。</p>

<h2>
<span id="rubymine-のインストール" class="fragment"></span><a href="#rubymine-%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>RubyMine のインストール</h2>

<p><a href="http://www.jetbrains.com/ruby/" rel="nofollow noopener" target="_blank">RubyMine</a> からダウンロードできる。 30日のトライアルがある。</p>

<h2>
<span id="プロジェクトの作成" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>プロジェクトの作成</h2>

<p>HTML5 BoilerplateやTwitter Bootstrapって何なんだぜ！？というツッコミを堪えつつ <strong>Ruby Motion Application</strong> を選択する。</p>

<p><a href="https://camo.qiitausercontent.com/6e6b9d7d866633d21c847a4042f80b7d6c3414a6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f61336666316533652d396338332d343062302d386661342d6666343963363939663563632e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/6e6b9d7d866633d21c847a4042f80b7d6c3414a6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f61336666316533652d396338332d343062302d386661342d6666343963363939663563632e706e67" alt="motion-create-new-project.png" title="motion-create-new-project.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/a3ff1e3e-9c83-40b0-8fa4-ff49c699f5cc.png"></a></p>

<p>作成すると <strong>Ruby SDK</strong> と <strong>template</strong> を選択できる。 <strong>Use motion-calabash testing framewrok</strong> にチェックを入れると Gemfile に <code>gem 'motion-calabash’</code> が追加される。テンプレートは <code>motion</code> コマンドで作成したものと同じものだったのでRubyMineが独自のテンプレートを持っているわけではない様子。</p>

<p><strong>Ruby SDK</strong> は生成後にプロジェクトの設定から切り替えられたので得に慎重になる必要もない。</p>

<p><a href="https://camo.qiitausercontent.com/72a60f3569ffd1d6663db306d6f8a80c3a26ebe2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f34313835376431372d316534332d323832352d616432652d3062396161346539333331362e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/72a60f3569ffd1d6663db306d6f8a80c3a26ebe2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f34313835376431372d316534332d323832352d616432652d3062396161346539333331362e706e67" alt="rubymine_motion_tempalte.png" title="rubymine_motion_tempalte.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/41857d17-1e43-2825-ad2e-0b9aa4e93316.png"></a></p>

<p>テンプレートを選択するとプロジェクトが生成され、Bundle Install の実行が求められる。2回目以降のbundlerの実行は <strong>Tools &gt; Bundler</strong> から実行できる。</p>

<p><a href="https://camo.qiitausercontent.com/6b9cff6f68cc477ed3f13d81f40d12cc49b114a4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f63353337633935362d373931622d373866662d653530332d3039663436653362333937652e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/6b9cff6f68cc477ed3f13d81f40d12cc49b114a4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f63353337633935362d373931622d373866662d653530332d3039663436653362333937652e706e67" alt="motion-bundle-install.png" title="motion-bundle-install.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/c537c956-791b-78ff-e503-09f46e3b397e.png"></a></p>

<h2>
<span id="プロジェクトの実行" class="fragment"></span><a href="#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>プロジェクトの実行</h2>

<p>Bundlerの実行が終わるのを待つと、右上からプロジェクトのシミュレータ上での実行が可能。ショートカットは <code>^R</code> に割り当てられている。</p>

<p><a href="https://camo.qiitausercontent.com/8be1145bf5a607d869ef75f475c6643b4f1f3e46/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35656163313464622d313333342d383030352d323066382d3537303036346339313330322e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/8be1145bf5a607d869ef75f475c6643b4f1f3e46/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35656163313464622d313333342d383030352d323066382d3537303036346339313330322e706e67" alt="motion-run.png" title="motion-run.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/5eac14db-1334-8005-20f8-570064c91302.png"></a></p>

<p>実行するとシミュレータが立ち上がった。ビルドの結果や irb のプロンプトはIDEの画面下の実行エリアに表示される。</p>

<p>実行したのは <code>rake simulator</code> であり、simulator taskには以下のようなオプションがある。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>rake simulator <span class="nv">device_family</span><span class="o">=</span>ipad
rake simulator <span class="nv">retina</span><span class="o">=</span><span class="nb">true</span>
rake simulator <span class="nv">target</span><span class="o">=</span><span class="m">6</span>.1
</pre></div></div>

<p>RubyMineではrakeタスクの引数などを設定して保存しておくことができる。iPhone用とiPad用を分けたいときなどはsimulatorタスクを別々の名前で保存するなどができる。</p>

<p><a href="https://camo.qiitausercontent.com/2635ac1e9b9b3da1d4013c54e3a83dd0fe79a901/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f30376166656331622d333665612d643039352d343366302d3633373531643961346262622e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/2635ac1e9b9b3da1d4013c54e3a83dd0fe79a901/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f30376166656331622d333665612d643039352d343366302d3633373531643961346262622e706e67" alt="motion-rake-args.png" title="motion-rake-args.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/07afec1b-36ea-d095-43f0-63751d9a4bbb.png"></a></p>

<h2>
<span id="テスト" class="fragment"></span><a href="#%E3%83%86%E3%82%B9%E3%83%88"><i class="fa fa-link"></i></a>テスト</h2>

<p>デフォルトでは <code>rake simulator</code> の他に <code>rspec</code> タスクが用意されており、右上のタスクから選択して Run を実行するとテストが実行される。</p>

<p>結果は画面下にフローティングされたウインドウに表示される。</p>

<h2>
<span id="コードの記述" class="fragment"></span><a href="#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E8%A8%98%E8%BF%B0"><i class="fa fa-link"></i></a>コードの記述</h2>

<p>コード補完もちゃんと動く。コードシンタックスハイライトも動作する。デフォルトのテーマは白背景だが、 <strong>Appearance &gt; Theme</strong> で <code>Darkura</code> を選択すると黒背景になる。</p>

<p><a href="https://camo.qiitausercontent.com/4eeba7d547aa3e478bb4a58534335859dc0bcf4d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31306236376634302d653066352d316130392d353865302d3535633334633464646466322e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/4eeba7d547aa3e478bb4a58534335859dc0bcf4d/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f31306236376634302d653066352d316130392d353865302d3535633334633464646466322e706e67" alt="motion-code-syntax.png" title="motion-code-syntax.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/10b67f40-e0f5-1a09-58e0-55c34c4dddf2.png"></a></p>

<p>コード補完の動作確認。</p>

<table>
<thead>
<tr>
<th style="text-align: left">Library</th>
<th style="text-align: center">補完できるか</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">iOS SDK</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">gem(motion用)</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">gem(motion-bundler経由)</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">Pod(motion-cocoapods経由)</td>
<td style="text-align: center">☓</td>
</tr>
</tbody>
</table>

<p>Rubyのソースは <code>&lt;project-dir&gt;/vendor/install</code> とプロジェクトディレクトリにあるので拾ってくれるような感じがする。CocoaPodsの場合についてはCのヘッダまでは面倒見てくれなかった、<code>&lt;project-dir&gt;/vendor/Pods/BuildHeaders</code> にあるのでプラグイン作ればできそうな気も。</p>

<p>ただし、iOS SDKの部分も完全なわけではなくいろいろ細かい部分は気になる。例えば <code>UIViewController.navigationController</code> の型が <code>UIViewController</code> で返ってくるとか、 <code>UITableViewController</code> を継承したクラスで<code>UITableViewDataSource</code> プロトコルを実装すると <code>def tableView(tableView, numberOfRowsInSection: section)</code>などを定義するので <code>tableView</code> プロパティを使いたいときに <code>tableView</code> の補完が衝突するなど。Xcode並のコード補完を求めていけない。</p>

<h2>
<span id="デバッグ" class="fragment"></span><a href="#%E3%83%87%E3%83%90%E3%83%83%E3%82%B0"><i class="fa fa-link"></i></a>デバッグ</h2>

<p>Breakpointを張っても止まらなかったり、プロセスの接続が切れたりどうもでうまく行かなかった。Xcode5だからダメなのかRubyMotion6との相性なのかよくわからない。</p>

<p>ただRubyMotion+RubyMineで開発しているときはあまりIDEのデバッガがなくても違和感がなかった。RubyMotionのコンパイルが速くなっているのでprint, irb, testなどを駆使し、デバッガは困ったときに使うのが良いのではないだろうか。</p>

<h2>
<span id="実機での実行" class="fragment"></span><a href="#%E5%AE%9F%E6%A9%9F%E3%81%A7%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>実機での実行</h2>

<p>Rakefileにプロビジョニングプロファイルと証明書を指定する。配布するわけではないのでprofileはXcodeが作ってくれる <code>iOS_Team_Provisioning_Profile.mobileprovision</code> をプロジェクトディレクトリにコピー、証明書はキーチェーンアクセスを開いて名前をコピー。</p>

<div class="code-frame" data-lang="ruby">
<div class="code-lang"><span class="bold">Rakefile</span></div>
<div class="highlight"><pre><span></span><span class="no">Motion</span><span class="o">::</span><span class="no">Project</span><span class="o">::</span><span class="no">App</span><span class="o">.</span><span class="n">setup</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="c1"># Use `rake config' to see complete project settings.</span>
  <span class="n">app</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'RubyMineMotionSample'</span>

  <span class="n">app</span><span class="o">.</span><span class="n">provisioning_profile</span> <span class="o">=</span> <span class="s1">'iOS_Team_Provisioning_Profile.mobileprovision'</span>
  <span class="n">app</span><span class="o">.</span><span class="n">codesign_certificate</span> <span class="o">=</span> <span class="err">'</span><span class="n">iPhone</span> <span class="ss">Developer</span><span class="p">:</span> <span class="no">Makoto</span> <span class="no">Kawasaki</span> <span class="p">(</span><span class="n">xxxx</span><span class="p">)</span><span class="err">’</span>
</pre></div>
</div>

<p>RubyMineでは <strong>Tools &gt; Run Rake task…</strong> から任意のrakeタスクを実行できる。ショートカットは <code>Option + R</code>に割り当てられている。</p>

<p><a href="https://camo.qiitausercontent.com/1e1d0aa10699e7254b6b8a6e18e905b013c25ddd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f34633832363834312d663532632d623563652d646164622d6466623932636531373134352e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/1e1d0aa10699e7254b6b8a6e18e905b013c25ddd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f34633832363834312d663532632d623563652d646164622d6466623932636531373134352e706e67" alt="motion-rake.png" title="motion-rake.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/4c826841-f52c-b5ce-dadb-dfb92ce17145.png"></a></p>

<p>task名はインクリメンタルサーチでき、説明も表示される。ここで <code>device</code> を選択する。</p>

<p><a href="https://camo.qiitausercontent.com/93f6be830d2d6e8c4db35cd246943df8d3cd5d37/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f62653430376661352d356638332d323238642d393938662d3133343631376632383165392e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/93f6be830d2d6e8c4db35cd246943df8d3cd5d37/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f62653430376661352d356638332d323238642d393938662d3133343631376632383165392e706e67" alt="motion-rake-device.png" title="motion-rake-device.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/be407fa5-5f83-228d-998f-134617f281e9.png"></a></p>

<p>実機にインストールされ、右上のタスクが変更された。実行したrake taskは設定が保存され、最後に実行したrakeタスクは <code>^R</code> ですぐに実行できる。</p>

<p><a href="https://camo.qiitausercontent.com/4d2d81612dfbb9b5fda581f2e61f178df3934ca7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35333561383238352d323265642d353630322d646439312d3631613066343963333336632e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/4d2d81612dfbb9b5fda581f2e61f178df3934ca7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f35333561383238352d323265642d353630322d646439312d3631613066343963333336632e706e67" alt="motion-run-device.png" title="motion-run-device.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/535a8285-22ed-5602-dd91-61a0f49c336c.png"></a></p>

<p>実行中のタスクは下部にフローティングされた Run ウインドウで管理できる。実機で実行中のプロセスは停止ボタンを押せば止めることができる。</p>

<p><a href="https://camo.qiitausercontent.com/a230e195b0ec3af44ce5c733f05baa80fd54e332/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f64356635643565362d313831392d306637652d323464352d6139356633306432313833382e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/a230e195b0ec3af44ce5c733f05baa80fd54e332/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f64356635643565362d313831392d306637652d323464352d6139356633306432313833382e706e67" alt="motion-stop-run-device.png" title="motion-stop-run-device.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/d5f5d5e6-1819-0f7e-24d5-a95f30d21838.png"></a></p>

<h2>
<span id="既存のプロジェクトを開く" class="fragment"></span><a href="#%E6%97%A2%E5%AD%98%E3%81%AE%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E9%96%8B%E3%81%8F"><i class="fa fa-link"></i></a>既存のプロジェクトを開く</h2>

<p>HipByteの<a href="https://github.com/HipByte/RubyMotionSamples" rel="nofollow noopener" target="_blank">サンプルプロジェクト</a>を開いてみたが <code>^R</code> でシミュレータで実行が可能だった。</p>

<p>RubyMineで新規に作成しなくてもRubyMotionプロジェクトだと判定してくれる。RubyMineプロジェクトファイルのコミットは必須ではなさそうだし、既存のプロジェクトをRubyMineで始めることも問題なさそうだ。</p>

<h2>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h2>

<p>主にiOSアプリ開発でRubyMineを使って以下を確認した。</p>

<ul>
<li>プロジェクトの作成</li>
<li>コード補完</li>
<li>シンタックスハイライト</li>
<li>シミュレータと実機による実行</li>
<li>デバッグの開始（未確認)</li>
<li>既存のプロジェクトのオープン</li>
</ul>

<p>最初はいろんな処理をIDEから実行することに違和感を感じたが、少しコードを書き始めると <code>^R</code>で実行することにも徐々に慣れてきて、Xcodeもそうであると考えるとこれはこれで便利なのではと思い始めてきた。しばらくRubyMineとRubyMotionを試してみるつもり。</p>

<p>参考にしたもの</p>

<ul>
<li><a href="http://confluence.jetbrains.com/display/RUBYDEV/Getting+Started+with+RubyMotion" rel="nofollow noopener" target="_blank">Getting Started with RubyMotion</a></li>
<li><a href="http://www.rubymotion.com/developer-center/guides/project-management/" rel="nofollow noopener" target="_blank">RubyMotion Project Management Guide</a></li>
</ul>

<h2>
<span id="おまけ" class="fragment"></span><a href="#%E3%81%8A%E3%81%BE%E3%81%91"><i class="fa fa-link"></i></a>おまけ</h2>

<p>勉強がてらRubyMotion Advent Calendar 2013を表示するアプリを作成しました。motion-cocoapods、bubble-wrap、sugarcubeを少し利用。xpath使おうとmotion-bundlerやmotion-hppleを使おうとして心が折れる。手を広げていろいろ苦労したので後日談をブログにでも書こうかと思います。</p>

<p><a href="https://github.com/makotokw/MotionAdventCalendar" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/makotokw/MotionAdventCalendar</a></p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />36位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>15</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/032e210aecf57deeb5a5">Android StudioでAndroid SDKのソースコードを参照する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-07-04 12:12:23</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Android]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>SDK Managerから該当するSDKのソースコードをインストールする。</p>

<p><a href="https://camo.qiitausercontent.com/b0cf1f39e79a284d39f9e39dba50e2b176650355/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f64653463616536332d646338342d666330322d356239662d6563393838376338646534622e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/b0cf1f39e79a284d39f9e39dba50e2b176650355/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f64653463616536332d646338342d666330322d356239662d6563393838376338646534622e706e67" alt="2013-07-04_1154.png" title="2013-07-04_1154.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/de4cae63-dc84-fc02-5b9f-ec9887c8de4b.png"></a></p>

<p><s>Android StudioのFile &gt; Project Strucureを開き、Platform Settings のSDKの sourcepath にSDK Managerからダウンロードしたソースコードのパスを設定する。</s> この設定はなくなりソースをダウンロードすれば自動で検索してくれるようになった。</p>

<p><a href="https://camo.qiitausercontent.com/ca787fe88b882315457f80d1eba8386ac430398b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f30366531393138392d633239342d326232332d393230662d3335343662613162353830622e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/ca787fe88b882315457f80d1eba8386ac430398b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f30366531393138392d633239342d326232332d393230662d3335343662613162353830622e706e67" alt="2013-07-04_1157.png" title="2013-07-04_1157.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/06e19189-c294-2b23-920f-3546ba1b580b.png"></a></p>

<p>あとはソースコードから <strong>Go To &gt; Declaration</strong> を実行すれば飛べる。</p>

<p><a href="https://camo.qiitausercontent.com/52dd57b614b8bed26e92ed73bc5fa38c31026d69/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f32343861373764332d323438642d393166622d373936612d3630336130323564353830372e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/52dd57b614b8bed26e92ed73bc5fa38c31026d69/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f32343861373764332d323438642d393166622d373936612d3630336130323564353830372e706e67" alt="2013-07-04_1203.png" title="2013-07-04_1203.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/248a77d3-248d-91fb-796a-603a025d5807.png"></a></p>

<p>自分でソースコードからjarを作っていたころと比べると便利になったものだ。そしてどうやらHomebrewで入れたSDKと別々に入ってるようなのであとで運用を考えよう。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />37位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>15</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/909ea8134e5199c3457a">Redmineテーマやプラグイン開発環境を構築する (rbenv版)</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-03-21 02:05:38</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> <b>[Rails]</b> <b>[Redmine]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>テーマやプラグインが開発したくなったので運用環境で作業せずに開発環境を構築してみたメモ。</p>

<p>RVMからrbenvに切り替えたので <a href="http://qiita.com/items/31982ee3de80efa4c31b" class="autolink">http://qiita.com/items/31982ee3de80efa4c31b</a> の書き直し。</p>

<h1>
<span id="前提" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90"><i class="fa fa-link"></i></a>前提</h1>

<p>ポリシー的にはなるべく簡単に、そして環境を限定的に。</p>

<ul>
<li>Redmine 2.x向け</li>
<li>GitでRedmine本体を管理する</li>
<li>Redmine本体の開発については対象外</li>
<li>自分のテーマやプラグインは個別のGitリポジトリで管理(submoduleとかは使わない)</li>
<li>rbenvを使う</li>
<li>gemパッケージはbundlerでプロジェクト内にインストールする</li>
<li>データベースはSQLiteを使う</li>
</ul>

<h3>
<span id="rvm版からの変更点" class="fragment"></span><a href="#rvm%E7%89%88%E3%81%8B%E3%82%89%E3%81%AE%E5%A4%89%E6%9B%B4%E7%82%B9"><i class="fa fa-link"></i></a>RVM版からの変更点</h3>

<ul>
<li>RVMの代わりにrbenvを使う</li>
<li>gemsetの代わりにbundler install --pathでRedmineのディレクトリにインストール

<ul>
<li>コマンドを叩くときにbundle execする</li>
</ul>
</li>
</ul>

<h1>
<span id="rbenvのセットアップ" class="fragment"></span><a href="#rbenv%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>rbenvのセットアップ</h1>

<h2>
<span id="os-x" class="fragment"></span><a href="#os-x"><i class="fa fa-link"></i></a>OS X</h2>

<p>OS Xが楽。Homebrew + bashの例</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>brew update
brew install rbenv
brew install ruby-build
echo 'eval "$(rbenv init -)"' &gt;&gt; ~/.bash_profile
</pre></div></div>

<h2>
<span id="ubuntu" class="fragment"></span><a href="#ubuntu"><i class="fa fa-link"></i></a>Ubuntu</h2>

<p>Ubuntuはaptでrbenvは見つかったが古い、そしてruby-buildがない。でもrbenv/ruby-buildともにgitから取得するだけでいいようだ。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>git clone git://github.com/sstephenson/rbenv.git ~/.rbenv
git clone git://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
echo 'export PATH="$HOME/.rbenv/bin:$PATH"' &gt;&gt; ~/.profile
echo 'eval "$(rbenv init -)"' &gt;&gt; ~/.profile
</pre></div></div>

<h1>
<span id="redmineの実行環境を作る" class="fragment"></span><a href="#redmine%E3%81%AE%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83%E3%82%92%E4%BD%9C%E3%82%8B"><i class="fa fa-link"></i></a>Redmineの実行環境を作る</h1>

<h2>
<span id="redmineの配置" class="fragment"></span><a href="#redmine%E3%81%AE%E9%85%8D%E7%BD%AE"><i class="fa fa-link"></i></a>Redmineの配置</h2>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>git clone https://github.com/redmine/redmine redmine-dev
cd redmine-dev
git checkout -b develop/2.2.1 2.2.1
</pre></div></div>

<p>Redmineをgitで落として、バージョンのタグからdevelop/{version}という名前のローカルブランチを作って使う。</p>

<h2>
<span id="rubyのインストール" class="fragment"></span><a href="#ruby%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Rubyのインストール</h2>

<p>RedmineのRubyのバージョンを確認する。<br>
<a href="http://www.redmine.org/projects/redmine/wiki/RedmineInstall" class="autolink" rel="nofollow noopener" target="_blank">http://www.redmine.org/projects/redmine/wiki/RedmineInstall</a></p>

<p>rbenvをセットアップしておき、適切なRubyのバージョンを以下のようにインストールする。Rubyのインストールを後回しにしたのはrbenv localをRedmineのパスで実行したかったそれ以上の深い理由はなし。</p>

<div class="code-frame" data-lang="bash"><div class="highlight"><pre><span></span>rbenv install <span class="m">1</span>.9.3-p327
gem install bundler
rbenv rehash
</pre></div></div>

<h2>
<span id="redmineのセットアップ" class="fragment"></span><a href="#redmine%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>Redmineのセットアップ</h2>

<p><strong>Redmine 2.3.1にあげたらGemfileが改良されておりdatabase.ymlのadapterを見て適切なデータベースドライバをインストールするようになり、--without mysqlなどのグループによる除外が機能しなくなる</strong></p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>cp -p config/database.yml.example config/database.yml
</pre></div></div>

<p>でデータベースの構成ファイルを作成して以下のように修正。</p>

<div class="code-frame" data-lang="yaml">
<div class="code-lang"><span class="bold">config/database.yml</span></div>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">production</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">adapter</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sqlite3</span>
  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db/production.sqlite3</span>
<span class="l l-Scalar l-Scalar-Plain">development</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">adapter</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sqlite3</span>
  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db/development.sqlite3</span>
<span class="l l-Scalar l-Scalar-Plain">test</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">adapter</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sqlite3</span>
  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db/development.sqlite3</span>
</pre></div>
</div>

<p>bundlerで依存モジュールを解決する。</p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>rbenv local 1.9.3-p327
bundle install --without development test rmagick mysql postgresql --path vendor/bundle
</pre></div></div>

<p>粛々とセットアップ。</p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>bundle exec rake generate_secret_token
RAILS_ENV=production bundle exec rake db:migrate
RAILS_ENV=production bundle exec rake redmine:load_default_data
mkdir tmp tmp/pdf public/plugin_assets
</pre></div></div>

<h2>
<span id="redmineの実行" class="fragment"></span><a href="#redmine%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>Redmineの実行</h2>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>bundle exec ruby script/rails server webrick -e production
</pre></div></div>

<p>で実行して、 <a href="http://localhost:3000/" class="autolink" rel="nofollow noopener" target="_blank">http://localhost:3000/</a> にアクセス。admin/adminでログインできる。</p>

<p>あとはテーマやプラグインを好き勝手に開発。基本的にRedmine本体の開発はしないのでredmine-dev/.gitはRedmineのバージョンアップ時にブランチを切り替えるだけで特にコミットはせず、自分のテーマやプラグインについてはnew fileで差分が出たままの状態にしておく。</p>

<h2>
<span id="redmineバージョンアップ時の作業" class="fragment"></span><a href="#redmine%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E6%99%82%E3%81%AE%E4%BD%9C%E6%A5%AD"><i class="fa fa-link"></i></a>Redmineバージョンアップ時の作業</h2>

<p>リポジトリの最新を取得して、新しいバージョンのタグからローカルブランチを切り替えてデータのマイグレーションとかを行う。</p>

<p>ブランチの切り替え</p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>git checkout master
git pull; git pull --tags
git checkout -b develop/x.x.x x.x.x
</pre></div></div>

<p>データの再セットアップ。</p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>bundle install --without development test rmagick mysql postgresql --path vendor/bundle
bundle exec rake db:migrate RAILS_ENV="production"
bundle exec rake redmine:plugins:migrate RAILS_ENV=production
bundle exec rake tmp:cache:clear
bundle exec rake tmp:sessions:clear
</pre></div></div>

<p>.bundle/configに前回のオプションが残っているからbundle installのオプションはいらない気もするけど念のため。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />38位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>14</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/c38a6eb1b912680aea5d">パッケージ管理ツールのlockファイルをバージョン管理すべき理由</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-02-27 17:40:20</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[bundler]</b> <b>[CocoaPods]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>Rubygemsを始めとして最近ではどの言語にも便利なパッケージ管理ツールが使えるようになった。多くのパッケージツールはインストールしたパッケージを記載した<code>Gemfile.lock</code> のようなlockファイルを作る。</p>

<p><code>Gemfile.lock</code> を消したら動いた、結果オーライみたいなことをウェブで見かけたりして、lockファイルをバージョン管理から外すべきという話があったりする。これはRubygemsに限ったことでなくCocoaPodsの <code>Podfile.lock</code> などでも結構混乱している人が多いような気がしたのでこれを書いておこうと思った。</p>

<p>lockファイルを管理すべきかどうかはもちろんそのチームの運用による。特に理由がなければアプリケーション開発においては基本的にはバージョン管理し、チームメンバーで共有したほうがよい。</p>

<h2>
<span id="メンバーが同じ環境を構築するため" class="fragment"></span><a href="#%E3%83%A1%E3%83%B3%E3%83%90%E3%83%BC%E3%81%8C%E5%90%8C%E3%81%98%E7%92%B0%E5%A2%83%E3%82%92%E6%A7%8B%E7%AF%89%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81"><i class="fa fa-link"></i></a>メンバーが同じ環境を構築するため</h2>

<p>bundlerであれば <code>Gemfile.lock</code> があれば <code>Gemfile.lock</code> ファイルにあるパッケージのバージョンをインストールする。なければ <code>Gemfile</code> ファイルに従いパッケージをインストールする。</p>

<p>これで何が変わるか？</p>

<p>もし <code>Gemfile</code> に <code>gem 'rails'</code> とだけ記載されていた場合 <strong>インストールを実行した時点の最新の安定バージョンがインストールされる</strong>。つまり <strong>lockファイルがないと実行したタイミングでパッケージのバージョンが変わる</strong> ということになる。後から実行するばするほど新しいものが入る。</p>

<p>例えば <code>Gemfile.lock</code> ファイルがなく<code>Gemfile</code> にrailsのバージョンが記載されていないならそれがrails3のアプリケーションでもrails4など新しいバージョンがインストールされてしまう。</p>

<p>つまりlockファイルがないと後からチームに加わった人、マシンの買い替えで新しくセットアップしたとき、時間が経ってから昔のプロジェクトをセットアップしたとき、といったケースで新しいパッケージのバージョンがインストールされてしまい、環境によって動作が異なったり、パッケージのi/fが変わった場合は最悪プログラムが動かなくなる。</p>

<p>他のメンバーや自分があとで同じ環境を構築するためにlockファイルは共有しなければならない。</p>

<h3>
<span id="運用環境と同一にするため" class="fragment"></span><a href="#%E9%81%8B%E7%94%A8%E7%92%B0%E5%A2%83%E3%81%A8%E5%90%8C%E4%B8%80%E3%81%AB%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81"><i class="fa fa-link"></i></a>運用環境と同一にするため</h3>

<p>メンバーの環境だけではなく、サーバーアプリケーションでは運用サーバ、クライアントアプリケーションではビルドマシンでも同様にlockファイルは共有すべきである。これらと同じ環境を構築しておかないと自分の環境では起きないのに運用サーバでは起きる、リリースしたビルドバージョンでは起きるという状態になりかねない。</p>

<h2>
<span id="旧バージョンを実行するため" class="fragment"></span><a href="#%E6%97%A7%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81"><i class="fa fa-link"></i></a>旧バージョンを実行するため</h2>

<p>lockファイルを管理する目的は他にもある。アプリケーションの旧バージョンを実行したいとき。</p>

<p>例えばiOSアプリの2.0を進めているときに致命的な問題で1.1をリリースしなければならなくなったとする。このとき1.0のタグから修正を行おうとするが、 <code>Podfile.lock</code>  をバージョン管理していなければその1.0の時点で利用していた依存パッケージのバージョンがわからないので <strong>アプリの旧バージョンと同じ実行環境を構築できない</strong> という問題が発生する。</p>

<p>最新バージョンの依存パッケージで動けばより改善されたアップデートを作れるかもしれないが、それはあくまで結果オーライであってこういった前回のビルドから何が変わったのかわからない予測不能な状態は避けなければならない。</p>

<p>旧バージョンの実行環境を構築するためにlockファイルはバージョン管理しなければならない。</p>

<h2>
<span id="明示的にバージョンを記載する" class="fragment"></span><a href="#%E6%98%8E%E7%A4%BA%E7%9A%84%E3%81%AB%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%92%E8%A8%98%E8%BC%89%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>明示的にバージョンを記載する</h2>

<p>lockファイルだけでなく、明示的に <code>Gemfile</code> や <code>Podfile</code> にはパッケージのバージョンを明示的に記載しておくのも有効である。lockファイルではあくまで結果的に使うバージョンという意味が強いが <code>Gemfile</code> や <code>Podfile</code> に記載すればこのパッケージのこのバージョンを使うというより強い意図を表現できる。</p>

<p>プロトタイプや１人で開発する分には <code>&gt;= x.x.x</code> といた書き方でも良いと思うが、重要な依存ライブラリについては明示的にバージョンを固定しておき、そのパッケージの更新履歴を確認した上で新しいバージョンに更新するような運用が望ましいと思われる。</p>

<h2>
<span id="まとめ" class="fragment"></span><a href="#%E3%81%BE%E3%81%A8%E3%82%81"><i class="fa fa-link"></i></a>まとめ</h2>

<p>開発者の環境をなるべく同一にするため、旧バージョンの実行のためlockファイルはバージョン管理すべきファイルである。</p>

<p>lockファイルを共有せず多少パッケージのバージョンが異なってもなんとなく動いてしまうのが怖いところ。時間が経つにつれ差分が大きくなる性質から問題があとになって顕在化してしまう。</p>

<p>lockファイルを管理しない方が良いケースももちろんあるのだが、 <strong>動きを理解しないまま自分の環境でlockファイルがなくても動いたので管理しない</strong> というやり方だと後で困るよいうだけの話。</p>

<p>今回はRubyGemsやCocoaPodsを例に挙げたが、多くのパッケージ管理ツールがlockファイルを作成し、同じ運用を用いることから同様のことが言えると思う。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />39位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>12</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/88c43a6e517700d947ee">iOSでTestFlightアプリを再インストールする方法</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-09-16 13:59:22</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> <b>[TestFlight]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><strong>この内容はAppleに買収されiTunes Connectに統合される前のTestFlightについての情報です、testflightapp.comは2015/2/26に終了です</strong></p>

<p>iOSのホーム画面に設置したTestFlight (Mobile)アプリを起動しても404ページが表示されるようになった。</p>

<p>基本的にTestFlight (Mobile)アプリはTestFlightサイトを表示するだけのWebアプリだと予想しているのだが、TestFlight MobileのダッシュボードページのURLが変わったせいで昔インストールしたTestFlightアプリのURLが開けない。</p>

<p>サポートに聞いたら再インストール方法を教えてもらった。</p>

<blockquote>
<p>I suggest following this guide (<a href="http://help.testflightapp.com/customer/portal/articles/867631" class="autolink" rel="nofollow noopener" target="_blank">http://help.testflightapp.com/customer/portal/articles/867631</a>) on re-initializing TestFlight on the device. You should also double check in Settings &gt; Safari that "Accept Cookies" is set to either "From Visited" or "Always", JavaScript is enabled, and Private Browsing set to off.</p>
</blockquote>

<ol>
<li>ホーム画面から <code>TestFlight</code> アプリを削除する</li>
<li>
<code>設定</code> &gt; <code>一般</code> &gt; <code>プロファイル</code> &gt; <code>TestFlight WebClip</code> を選択し、<code>削除</code> ボタンで一旦このプロファイルを削除する</li>
<li>
<code>設定</code> &gt; <code>Safari</code> から <code>履歴を消去</code> と <code>Cookieとデータを消去</code> を選択</li>
<li>iOSを再起動</li>
<li>Safariを起動して <a href="https://testflightapp.com/m/login" class="autolink" rel="nofollow noopener" target="_blank">https://testflightapp.com/m/login</a> からログイン</li>
<li>
<code>Connect Device</code> を押して <code>プロファイル</code> をインストール</li>
</ol>

<p>面倒にくさがった僕は 3-5 の手順を無視し、プロファイルを削除したあとSafariでTestFlightのページに言って メニューの Settings &gt; Devices から <code>Reconnect Current Device</code> を実行したけどうまくホーム画面にTestFlightアプリがインストールされた。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />40位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>12</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/31982ee3de80efa4c31b">Redmineテーマやプラグイン開発環境を構築する (RVM版)</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-01-17 03:28:22</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Ruby]</b> <b>[Rails]</b> <b>[Redmine]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>テーマやプラグインが開発したくなったので運用環境で作業せずに開発環境を構築してみたメモ。</p>

<p>rbenv版は<a href="http://qiita.com/items/909ea8134e5199c3457a" class="autolink">http://qiita.com/items/909ea8134e5199c3457a</a></p>

<h1>
<span id="前提" class="fragment"></span><a href="#%E5%89%8D%E6%8F%90"><i class="fa fa-link"></i></a>前提</h1>

<p>ポリシー的にはなるべく簡単に、そして環境を限定的に。とりあえずUbuntu 12.04でやってるけど*nix系ならほぼ使いまわせそう。</p>

<ul>
<li>Redmine 2.x向け</li>
<li>GitでRedmine本体を管理する</li>
<li>Redmine本体の開発については対象外</li>
<li>自分のテーマやプラグインは個別のGitリポジトリで管理(submoduleとかは使わない)</li>
<li>RVMを使い、Redmine用のgemsetを作る</li>
<li>データベースはSQLiteを使う</li>
</ul>

<h1>
<span id="redmineの実行環境を作る" class="fragment"></span><a href="#redmine%E3%81%AE%E5%AE%9F%E8%A1%8C%E7%92%B0%E5%A2%83%E3%82%92%E4%BD%9C%E3%82%8B"><i class="fa fa-link"></i></a>Redmineの実行環境を作る</h1>

<h2>
<span id="rubyのインストール" class="fragment"></span><a href="#ruby%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Rubyのインストール</h2>

<p>RedmineのRubyのバージョンを確認する。<br>
<a href="http://www.redmine.org/projects/redmine/wiki/RedmineInstall" class="autolink" rel="nofollow noopener" target="_blank">http://www.redmine.org/projects/redmine/wiki/RedmineInstall</a></p>

<p><a href="https://rvm.io/" class="autolink" rel="nofollow noopener" target="_blank">https://rvm.io/</a> からRVMをイントールしておく。</p>

<h2>
<span id="redmineの配置とgemsetの準備" class="fragment"></span><a href="#redmine%E3%81%AE%E9%85%8D%E7%BD%AE%E3%81%A8gemset%E3%81%AE%E6%BA%96%E5%82%99"><i class="fa fa-link"></i></a>Redmineの配置とGemsetの準備</h2>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>git clone https://github.com/redmine/redmine redmine-dev
cd redmine-dev
git checkout -b develop/2.2.1 2.2.1
rvm --rvmrc --create 1.9.3@redmine
</pre></div></div>

<p>Redmineをgitで落として、バージョンのタグからdevelop/{version}という名前のローカルブランチを作って使う。</p>

<p>でRuby 1.9.3でRedmine用のgemsetである1.9.3@redmineをrvmrcを使ってこのディレクトリでそれを使うようにしている。rvmrcはここを参考。<a href="https://rvm.io/workflow/rvmrc/" class="autolink" rel="nofollow noopener" target="_blank">https://rvm.io/workflow/rvmrc/</a></p>

<p>redmine-devに移動したときに自動的に1.9.3@redmineに切り替えるには/etc/rvmrc または ~/.rvmrcにrvm_project_rvmrc=1を設定しておくといい。</p>

<h2>
<span id="redmineのセットアップ" class="fragment"></span><a href="#redmine%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>Redmineのセットアップ</h2>

<p><strong>Redmine 2.3.1にあげたらGemfileが改良されておりdatabase.ymlのadapterを見て適切なデータベースドライバをインストールするようになり、--without mysqlなどのグループによる除外が機能しなくなる</strong></p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>cp -p config/database.yml.example config/database.yml
</pre></div></div>

<p>でデータベースの構成ファイルを作成して以下のように修正。</p>

<div class="code-frame" data-lang="yaml">
<div class="code-lang"><span class="bold">config/database.yml</span></div>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">production</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">adapter</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sqlite3</span>
  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db/production.sqlite3</span>
<span class="l l-Scalar l-Scalar-Plain">development</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">adapter</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sqlite3</span>
  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db/development.sqlite3</span>
<span class="l l-Scalar l-Scalar-Plain">test</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">adapter</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sqlite3</span>
  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db/development.sqlite3</span>
</pre></div>
</div>

<p>bundlerで依存モジュールを解決する。</p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>rbenv local 1.9.3-p327
bundle install --without development test rmagick mysql postgresql --path vendor/bundle
</pre></div></div>

<p>粛々とセットアップ。</p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>rake generate_secret_token
RAILS_ENV=production rake db:migrate
RAILS_ENV=production rake redmine:load_default_data
mkdir tmp tmp/pdf public/plugin_assets
</pre></div></div>

<h2>
<span id="redmineの実行" class="fragment"></span><a href="#redmine%E3%81%AE%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>Redmineの実行</h2>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>ruby script/rails server webrick -e production
</pre></div></div>

<p>で実行して、 <a href="http://localhost:3000/" class="autolink" rel="nofollow noopener" target="_blank">http://localhost:3000/</a> にアクセス。admin/adminでログインできる。</p>

<p>あとはテーマやプラグインを好き勝手に開発。基本的にRedmine本体の開発はしないのでredmine-dev/.gitはRedmineのバージョンアップ時にブランチを切り替えるだけで特にコミットはせず、自分のテーマやプラグインについてはnew fileで差分が出たままの状態にしておく。</p>

<h2>
<span id="redmineバージョンアップ時の作業" class="fragment"></span><a href="#redmine%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E6%99%82%E3%81%AE%E4%BD%9C%E6%A5%AD"><i class="fa fa-link"></i></a>Redmineバージョンアップ時の作業</h2>

<p>リポジトリの最新を取得して、新しいバージョンのタグからローカルブランチを切り替えてデータのマイグレーションとかを行う。</p>

<p>ブランチの切り替え</p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>git checkout master
git pull; git pull --tags
git checkout -b develop/x.x.x x.x.x
</pre></div></div>

<p>データの再セットアップ。</p>

<div class="code-frame" data-lang="/path/to/redmine-dev"><div class="highlight"><pre><span></span>bundle install --without development test rmagick mysql postgresql
rake db:migrate RAILS_ENV="production"
rake redmine:plugins:migrate RAILS_ENV=production
rake tmp:cache:clear
rake tmp:sessions:clear
</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />41位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>9</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/892635a0aeba7d23d7f8">Laravel4でエディタ・IDEで補完されないクラスの対応</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-06-07 13:06:11</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[PHP]</b> <b>[laravel]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><a href="http://laravel.com/" rel="nofollow noopener" target="_blank">Laravel</a>ではアプリケーションから使う基本的な機能がFacadeパターンで用意されていて、そのクラスがaliasの設定によって長いnamespaceを意識しなくても使えるようになっている。</p>

<p>こういったaliasを含めてLaravelのautoload機能で解決しているクラスはエディタやIDEから補完が効かないとか、実装の中身を見たいときに実装にジャンプできないとか面倒なことがある。</p>

<p>補完するためのエディタやIDEに読ませるだけのphpファイルを作っておくと良い。</p>

<h2>
<span id="laravel-ide-helper-generator-を使う" class="fragment"></span><a href="#laravel-ide-helper-generator-%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a><a href="https://github.com/Barryvdh/laravel-ide-helper" rel="nofollow noopener" target="_blank">Laravel IDE Helper Generator</a> を使う</h2>

<p>生成済みファイルがgist<a href="https://gist.github.com/barryvdh/5227822" rel="nofollow noopener" target="_blank">5227822</a>に上がっているのでてっとり早くプロジェクトディレクトリで以下を実行して解決する。</p>

<p>Revisionによって内容が変わっているので注意。</p>

<h3>
<span id="40" class="fragment"></span><a href="#40"><i class="fa fa-link"></i></a>4.0</h3>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">bash</span></div>
<div class="highlight"><pre><span></span>wget https://gist.github.com/barryvdh/5227822/raw/b58c5d26351acce3f8a5094d6a21c7d2eefc968e/_ide_helper.php
</pre></div>
</div>

<h3>
<span id="418" class="fragment"></span><a href="#418"><i class="fa fa-link"></i></a>4.1.8</h3>

<div class="code-frame" data-lang="">
<div class="code-lang"><span class="bold">bash</span></div>
<div class="highlight"><pre><span></span>wget https://gist.github.com/barryvdh/5227822/raw/df741117a6d1c36d667f63cb40d409c0e1008f5e/_ide_helper.php
</pre></div>
</div>

<h2>
<span id="ボツネタ" class="fragment"></span><a href="#%E3%83%9C%E3%83%84%E3%83%8D%E3%82%BF"><i class="fa fa-link"></i></a>ボツネタ</h2>

<p>Laravel IDE Helper Generatorを教えてもらう前に自力で解決しようとしたネタ。</p>

<p>ただ結局のところFacadeクラスのマジックメソッド__callStaticで動的に解決しているスタティックメソッドや、<code>Auth</code>など処理の一部をマジックメソッドでdriverに委譲しているManagerクラスは補完が効かないし、あんまり嬉しくないかも。</p>

<div class="code-frame" data-lang="php">
<div class="code-lang"><span class="bold">Laravel4.php</span></div>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">App</span> <span class="k">extends</span> <span class="nx">Illuminate\Foundation\Application</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Artisan</span> <span class="k">extends</span> <span class="nx">Illuminate\Foundation\Artisan</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Auth</span> <span class="k">extends</span> <span class="nx">Illuminate\Auth\AuthManager</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Blade</span> <span class="k">extends</span> <span class="nx">Illuminate\View\Compilers\BladeCompiler</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Cache</span> <span class="k">extends</span> <span class="nx">Illuminate\Cache\CacheManager</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">ClassLoader</span> <span class="k">extends</span> <span class="nx">Illuminate\Support\ClassLoader</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Config</span> <span class="k">extends</span> <span class="nx">Illuminate\Config\Repository</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Controller</span> <span class="k">extends</span> <span class="nx">Illuminate\Routing\Controllers\Controller</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Cookie</span> <span class="k">extends</span> <span class="nx">Illuminate\Cookie\CookieJar</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Crypt</span> <span class="k">extends</span> <span class="nx">Illuminate\Encryption\Encrypter</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">DB</span> <span class="k">extends</span> <span class="nx">Illuminate\Database\DatabaseManager</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Eloquent</span> <span class="k">extends</span> <span class="nx">Illuminate\Database\Eloquent\Model</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Event</span> <span class="k">extends</span> <span class="nx">Illuminate\Events\Dispatcher</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">File</span> <span class="k">extends</span> <span class="nx">Illuminate\Filesystem\Filesystem</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Form</span> <span class="k">extends</span> <span class="nx">Illuminate\Html\FormBuilder</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Hash</span> <span class="k">extends</span> <span class="nx">Illuminate\Hashing\BcryptHasher</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">HTML</span> <span class="k">extends</span> <span class="nx">Illuminate\Html\HtmlBuilder</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Input</span> <span class="k">extends</span> <span class="nx">Illuminate\Http\Request</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Lang</span> <span class="k">extends</span> <span class="nx">Illuminate\Translation\Translator</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Log</span> <span class="k">extends</span> <span class="nx">Illuminate\Log\Writer</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Mail</span> <span class="k">extends</span> <span class="nx">Illuminate\Mail\Mailer</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Paginator</span> <span class="k">extends</span> <span class="nx">Illuminate\Pagination\Environment</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Password</span> <span class="k">extends</span> <span class="nx">Illuminate\Auth\Reminders\PasswordBroker</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Queue</span> <span class="k">extends</span> <span class="nx">Illuminate\Queue\QueueManager</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Redirect</span> <span class="k">extends</span> <span class="nx">Illuminate\Routing\Redirector</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Redis</span> <span class="k">extends</span> <span class="nx">Illuminate\Redis\Database</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Request</span> <span class="k">extends</span> <span class="nx">Illuminate\Http\Request</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Response</span> <span class="k">extends</span> <span class="nx">Illuminate\Support\Facades\Response</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Route</span> <span class="k">extends</span> <span class="nx">Illuminate\Routing\Router</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Schema</span> <span class="k">extends</span> <span class="nx">Illuminate\Database\Schema\MySqlBuilder</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Seeder</span> <span class="k">extends</span> <span class="nx">Illuminate\Database\Seeder</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Session</span> <span class="k">extends</span> <span class="nx">Illuminate\Session\Store</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Str</span> <span class="k">extends</span> <span class="nx">Illuminate\Support\Str</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">URL</span> <span class="k">extends</span> <span class="nx">Illuminate\Routing\UrlGenerator</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">Validator</span> <span class="k">extends</span> <span class="nx">Illuminate\Validation\Factory</span> <span class="p">{}</span>
<span class="k">class</span> <span class="nc">View</span> <span class="k">extends</span> <span class="nx">Illuminate\View\Environment</span> <span class="p">{}</span>
</pre></div>
</div>

<p>出力するために以下のようなコードを書きました。</p>

<div class="code-frame" data-lang="php"><div class="highlight"><pre><span></span><span class="nx">Route</span><span class="o">::</span><span class="na">get</span><span class="p">(</span>
    <span class="s1">'classes'</span><span class="p">,</span>
    <span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nv">$classDefines</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">'&lt;?php'</span><span class="p">,</span><span class="s1">''</span><span class="p">);</span>
        <span class="nv">$aliases</span> <span class="o">=</span> <span class="nx">Config</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">'app.aliases'</span><span class="p">);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$aliases</span> <span class="k">as</span> <span class="nv">$className</span> <span class="o">=&gt;</span> <span class="nv">$targetClassName</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$parentClassName</span> <span class="o">=</span> <span class="nv">$targetClassName</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">str_contains</span><span class="p">(</span><span class="nv">$targetClassName</span><span class="p">,</span> <span class="s1">'Facades'</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$f</span> <span class="o">=</span> <span class="k">new</span> <span class="nv">$targetClassName</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">is_subclass_of</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="s1">'Illuminate\Support\Facades\Facade'</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nv">$instance</span> <span class="o">=</span> <span class="nv">$targetClassName</span><span class="o">::</span><span class="na">getFacadeRoot</span><span class="p">();</span>
                    <span class="nv">$parentClassName</span> <span class="o">=</span> <span class="nb">get_class</span><span class="p">(</span><span class="nv">$instance</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nv">$classDefines</span><span class="p">[]</span> <span class="o">=</span> <span class="nb">sprintf</span><span class="p">(</span><span class="s1">'class %s extends %s {}'</span><span class="p">,</span> <span class="nv">$className</span><span class="p">,</span> <span class="nv">$parentClassName</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$response</span> <span class="o">=</span> <span class="nx">Response</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nb">implode</span><span class="p">(</span><span class="nx">PHP_EOL</span><span class="p">,</span> <span class="nv">$classDefines</span><span class="p">));</span>
        <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">header</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="s1">'text/plain'</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$response</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">);</span>

</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />42位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>7</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/dd0dcc676aa91fb328c8">jQuery Mobileでボタンやリストビューを動的に追加する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2012-08-01 19:01:51</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[JavaScript]</b> <b>[jQueryMobile]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>jQuery Mobileが初期化処理を完了し、ページが表示されたあとに</p>

<div class="code-frame" data-lang="html"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">a</span> <span class="na">data-role</span><span class="o">=</span><span class="s">"button"</span><span class="p">/&gt;</span>
</pre></div></div>

<p>を追加してもただのanchor要素が追加されるだけだった。以下のようにbutton関数を呼べばボタンになった。<br>
参考: <a href="http://forum.jquery.com/topic/how-to-dynamically-add-data-role-button" class="autolink" rel="nofollow noopener" target="_blank">http://forum.jquery.com/topic/how-to-dynamically-add-data-role-button</a></p>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
  <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">load</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">$content</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#content'</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;a/&gt;'</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="s1">'Label'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">'icon'</span><span class="p">,</span><span class="s1">'home'</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$content</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">button</span><span class="p">()</span>
      <span class="p">;</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</pre></div></div>

<p>同じようにリストビューも追加できた。ただし、こちらはappendしたあとに呼び出さないとうまく表示されなかった。</p>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">'&lt;ul/&gt;'</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s1">'&lt;li&gt;aaa&lt;/li&gt;&lt;li&gt;bbb&lt;/li&gt;'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">$content</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">listview</span><span class="p">()</span>
  <span class="p">;</span>

</pre></div></div>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />43位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>6</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/12cabdde7351bd443879">OS XでIntelliJ系IDEにターミナルで開くメニューを追加する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-08-19 10:52:26</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[IntelliJ]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>Android StudioなどIntelliJ系IDEでSublime Text 2のTerminalプラグインである <strong>Open Terminal Here…</strong> を使いたくなったのでやってみました。</p>

<p>terminal.sh を Sublime Text 2のTerminalプラグインから拝借します。以下の内容をホームディレクトリなど適当な場所に保存してください。 <code>chmod u+x terminal.sh</code> で実行権限も付与。</p>

<div class="code-frame" data-lang="sh">
<div class="code-lang"><span class="bold">terminal.sh</span></div>
<div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="nv">CD_CMD</span><span class="o">=</span><span class="s2">"cd "</span><span class="se">\\\"</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="se">\\\"</span><span class="s2">" &amp;&amp; clear"</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="k">$(</span>sw_vers -productVersion<span class="k">)</span>
<span class="k">if</span> <span class="o">((</span> <span class="k">$(</span>expr <span class="nv">$VERSION</span> <span class="s1">'&lt;'</span> <span class="m">10</span>.7.0<span class="k">)</span> <span class="o">))</span><span class="p">;</span> <span class="k">then</span>
  <span class="nv">IN_WINDOW</span><span class="o">=</span><span class="s2">"in window 1"</span>
<span class="k">fi</span>
osascript<span class="s">&lt;&lt;END</span>
<span class="s">try</span>
<span class="s">  tell application "System Events"</span>
<span class="s">    if (count(processes whose name is "Terminal")) is 0 then</span>
<span class="s">      tell application "Terminal"</span>
<span class="s">        activate</span>
<span class="s">        do script "$CD_CMD" $IN_WINDOW</span>
<span class="s">      end tell</span>
<span class="s">    else</span>
<span class="s">      tell application "Terminal"</span>
<span class="s">        activate</span>
<span class="s">        do script "$CD_CMD"</span>
<span class="s">      end tell</span>
<span class="s">    end if</span>
<span class="s">  end tell</span>
<span class="s">end try</span>
<span class="s">END</span>
</pre></div>
</div>

<p>Preference &gt; External Tools から以下のように追加します</p>

<table>
<thead>
<tr>
<th style="text-align: left">名前</th>
<th style="text-align: left">値</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">Name</td>
<td style="text-align: left">Open Terminal Here…</td>
</tr>
<tr>
<td style="text-align: left">Group</td>
<td style="text-align: left">Terminal</td>
</tr>
<tr>
<td style="text-align: left">Description</td>
<td style="text-align: left">Open Terminal Here</td>
</tr>
<tr>
<td style="text-align: left">Synchronize files after execution</td>
<td style="text-align: left">チェック外す</td>
</tr>
<tr>
<td style="text-align: left">Open console</td>
<td style="text-align: left">チェック外す</td>
</tr>
<tr>
<td style="text-align: left">Showin</td>
<td style="text-align: left">Project viewsのみチェック</td>
</tr>
<tr>
<td style="text-align: left">Program</td>
<td style="text-align: left">借したterminal.sh</td>
</tr>
<tr>
<td style="text-align: left">Working directory</td>
<td style="text-align: left">$FileDir$</td>
</tr>
</tbody>
</table>

<p><a href="https://camo.qiitausercontent.com/278f750f49f3f05c7e7d9bddc0a150d6a34e3a84/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f61373634616266362d633538612d393465362d363064352d3962656361633361633438362e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/278f750f49f3f05c7e7d9bddc0a150d6a34e3a84/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f61373634616266362d633538612d393465362d363064352d3962656361633361633438362e706e67" alt="2013-08-18_0244.png" title="2013-08-18_0244.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/a764abf6-c58a-94e6-60d5-9becac3ac486.png"></a></p>

<p>これでプロジェクトビューの右クリックメニューから実行できます。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />44位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>6</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/de5262fa91c4af3c83c0">アプリのアイコン、起動イメージを用意するときのメモ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2012-11-26 14:34:38</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Android]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>自分で描くときも、デザイナーさんに依頼するときも毎回忘れるのでまとめる。必要な案件の際に更新するので内容が古かったり間違っていることも。</p>

<h2>
<span id="ios" class="fragment"></span><a href="#ios"><i class="fa fa-link"></i></a>iOS</h2>

<h3>
<span id="ガイドライン" class="fragment"></span><a href="#%E3%82%AC%E3%82%A4%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3"><i class="fa fa-link"></i></a>ガイドライン</h3>

<ul>
<li><a href="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/MobileHIG/IconMatrix.html" rel="nofollow noopener" target="_blank">Icon and Image Sizes (iOS Human Interface Guidelines)</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/MobileHIG/LaunchImages.html" rel="nofollow noopener" target="_blank">Launch Images (iOS Human Interface Guidelines)</a></li>
<li><a href="http://developer.apple.com/library/ios/#qa/qa1686/_index.html" rel="nofollow noopener" target="_blank">Technical Q&amp;A QA1686 App Icons on iPad and iPhone - iOS Developer Library</a></li>
</ul>

<h3>
<span id="アプリアイコン-共通" class="fragment"></span><a href="#%E3%82%A2%E3%83%97%E3%83%AA%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3-%E5%85%B1%E9%80%9A"><i class="fa fa-link"></i></a>アプリアイコン (共通)</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">ファイル名</th>
<th style="text-align: left">対象</th>
<th style="text-align: center">必須</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">29 x 29</td>
<td style="text-align: left">Icon-Small.png</td>
<td style="text-align: left">iPhoneのSettings</td>
<td style="text-align: center">Settings bundleを含んでいる場合は特に推奨</td>
</tr>
<tr>
<td style="text-align: left">58 x 58</td>
<td style="text-align: left"><a href="mailto:Icon-Small@2x.png" class="autolink">Icon-Small@2x.png</a></td>
<td style="text-align: left">Retina iPhoneのSettings</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">512 x 512</td>
<td style="text-align: left">iTunesArtwork</td>
<td style="text-align: left">AppStore</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">1024 x 1024</td>
<td style="text-align: left">iTunesArtwork@2x</td>
<td style="text-align: left">AppStore for Retina</td>
<td style="text-align: center">○</td>
</tr>
</tbody>
</table>

<h3>
<span id="アプリアイコン-ios7" class="fragment"></span><a href="#%E3%82%A2%E3%83%97%E3%83%AA%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3-ios7"><i class="fa fa-link"></i></a>アプリアイコン (iOS7+)</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">ファイル名</th>
<th style="text-align: left">対象</th>
<th style="text-align: center">必須</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">40 x 40</td>
<td style="text-align: left">Icon-40.png</td>
<td style="text-align: left">iPadのSpotlight</td>
<td style="text-align: center">-</td>
</tr>
<tr>
<td style="text-align: left">80 x 80</td>
<td style="text-align: left"><a href="mailto:Icon-40@2x.png" class="autolink">Icon-40@2x.png</a></td>
<td style="text-align: left">Retina iPadのSpotlight</td>
<td style="text-align: center">-</td>
</tr>
<tr>
<td style="text-align: left">120 x 120</td>
<td style="text-align: left"><a href="mailto:Icon-40@3x.png" class="autolink">Icon-40@3x.png</a></td>
<td style="text-align: left">Retina HD iPhone (5.5-inch)のSpotlight</td>
<td style="text-align: center">-</td>
</tr>
<tr>
<td style="text-align: left">60 x 60</td>
<td style="text-align: left">Icon-60.png</td>
<td style="text-align: left">iPhoneのホーム</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">120 x 120</td>
<td style="text-align: left"><a href="mailto:Icon-60@2x.png" class="autolink">Icon-60@2x.png</a></td>
<td style="text-align: left">Retina iPhoneのホーム</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">180 x 180</td>
<td style="text-align: left"><a href="mailto:Icon-60@3x.png" class="autolink">Icon-60@3x.png</a></td>
<td style="text-align: left">Retina HD iPhone (5.5-inch)のホーム</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">76 x 76</td>
<td style="text-align: left">Icon-76.png</td>
<td style="text-align: left">iPadのホーム</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">152 x 152</td>
<td style="text-align: left"><a href="mailto:Icon-76@2x.png" class="autolink">Icon-76@2x.png</a></td>
<td style="text-align: left">Retina iPadのホーム</td>
<td style="text-align: center">○</td>
</tr>
</tbody>
</table>

<ul>
<li>固定のファイル名を使うのはiOS 3.1.3以前の互換用のためであり、iOS 5以降ではInfo.plistファイルの<code>CFBundleIcons</code>、iOS 3.2以降では<code>CFBundleIconFiles</code>にファイルを指定する</li>
<li>Xcode 5からは<code>Images.xcassets</code>で管理できる</li>
</ul>

<h3>
<span id="アプリアイコン-ios6" class="fragment"></span><a href="#%E3%82%A2%E3%83%97%E3%83%AA%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3-ios6"><i class="fa fa-link"></i></a>アプリアイコン (iOS6)</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">ファイル名</th>
<th style="text-align: left">対象</th>
<th style="text-align: center">必須</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">50 x 50</td>
<td style="text-align: left">Icon-Small-50.png</td>
<td style="text-align: left">iPadのSpotlight</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">100 x 100</td>
<td style="text-align: left"><a href="mailto:Icon-Small-50@2x.png" class="autolink">Icon-Small-50@2x.png</a></td>
<td style="text-align: left">Retina iPadのSpotlight</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td style="text-align: left">57 x 57</td>
<td style="text-align: left">Icon.png</td>
<td style="text-align: left">iPhoneのホーム</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">114 x 114</td>
<td style="text-align: left"><a href="mailto:Icon@2x.png" class="autolink">Icon@2x.png</a></td>
<td style="text-align: left">Retina iPhoneのホーム</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">72 x 72</td>
<td style="text-align: left">Icon-72.png</td>
<td style="text-align: left">iPadのホーム</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">144 x 144</td>
<td style="text-align: left"><a href="mailto:Icon-72@2x.png" class="autolink">Icon-72@2x.png</a></td>
<td style="text-align: left">Retina iPadのホーム</td>
<td style="text-align: center">○</td>
</tr>
</tbody>
</table>

<h3>
<span id="webアイコン" class="fragment"></span><a href="#web%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3"><i class="fa fa-link"></i></a>Webアイコン</h3>

<ul>
<li><a href="https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html" rel="nofollow noopener" target="_blank">Configuring Web Applications - Safari Developer Library</a></li>
</ul>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">対象</th>
<th style="text-align: left">メタタグの例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">60 x 60</td>
<td style="text-align: left">iPhone</td>
<td style="text-align: left"><code>&lt;link rel="apple-touch-icon" href="/touch-icon-iphone.png"&gt;</code></td>
</tr>
<tr>
<td style="text-align: left">76 x 76</td>
<td style="text-align: left">iPad</td>
<td style="text-align: left"><code>&lt;link rel="apple-touch-icon" sizes="76x76" href="/touch-icon-ipad.png"&gt;</code></td>
</tr>
<tr>
<td style="text-align: left">120 x 120</td>
<td style="text-align: left">Retina iPhone</td>
<td style="text-align: left"><code>&lt;link rel="apple-touch-icon" sizes="120x120" href="/touch-icon-iphone-retina.png"&gt;</code></td>
</tr>
<tr>
<td style="text-align: left">152 x 152</td>
<td style="text-align: left">Retina iPad</td>
<td style="text-align: left"><code>&lt;link rel="apple-touch-icon" sizes="152x152" href="/touch-icon-ipad-retina.png"&gt;</code></td>
</tr>
</tbody>
</table>

<h3>
<span id="起動イメージ-iphone" class="fragment"></span><a href="#%E8%B5%B7%E5%8B%95%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8-iphone"><i class="fa fa-link"></i></a>起動イメージ (iPhone)</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">ファイル名(例)</th>
<th style="text-align: left">対象</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">320 x 480</td>
<td style="text-align: left">Default.png</td>
<td style="text-align: left">iPhone</td>
</tr>
<tr>
<td style="text-align: left">640 x 960</td>
<td style="text-align: left"><a href="mailto:Default@2x.png" class="autolink">Default@2x.png</a></td>
<td style="text-align: left">Retina iPhone (3.5-inch)</td>
</tr>
<tr>
<td style="text-align: left">640 x 1136</td>
<td style="text-align: left"><a href="mailto:Default-iOS7-568h@2x.png" class="autolink">Default-iOS7-568h@2x.png</a></td>
<td style="text-align: left">Retina iPhone (4-inch)</td>
</tr>
<tr>
<td style="text-align: left">750 x 1334</td>
<td style="text-align: left"><a href="mailto:Default-iOS8-667h@2x.png" class="autolink">Default-iOS8-667h@2x.png</a></td>
<td style="text-align: left">Retina HD iPhone (4.7-inch) 縦向き(Portrait)</td>
</tr>
<tr>
<td style="text-align: left">1242 x 2208</td>
<td style="text-align: left"><a href="mailto:Default-iOS8-736h@3x.png" class="autolink">Default-iOS8-736h@3x.png</a></td>
<td style="text-align: left">Retina HD iPhone (5.5-inch) 縦向き(Portrait)</td>
</tr>
<tr>
<td style="text-align: left">2208 x 1242</td>
<td style="text-align: left"><a href="mailto:Default-iOS8-Landscape-736h@3x.png" class="autolink">Default-iOS8-Landscape-736h@3x.png</a></td>
<td style="text-align: left">Retina HD iPhone (5.5-inch) 横向き(Landscape)</td>
</tr>
</tbody>
</table>

<ul>
<li>iPhone 6 Plus(5.5-inch)はLandscapeがある</li>
</ul>

<h3>
<span id="起動イメージ-ipad-ios7" class="fragment"></span><a href="#%E8%B5%B7%E5%8B%95%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8-ipad-ios7"><i class="fa fa-link"></i></a>起動イメージ (iPad iOS7)</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">ファイル名(例)</th>
<th style="text-align: left">対象</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">768 x 1024</td>
<td style="text-align: left">Default-iOS7-Portrait-1024h.png</td>
<td style="text-align: left">iPad縦向き(Portrait)</td>
</tr>
<tr>
<td style="text-align: left">1024 x 768</td>
<td style="text-align: left">Default-iOS7-Landscape-768h.png</td>
<td style="text-align: left">iPad横向き(Landscape)</td>
</tr>
<tr>
<td style="text-align: left">1536 x 2048</td>
<td style="text-align: left"><a href="mailto:Default-iOS7-Portrait-1024h@2x.png" class="autolink">Default-iOS7-Portrait-1024h@2x.png</a></td>
<td style="text-align: left">Retina iPad縦向き(Portrait)</td>
</tr>
<tr>
<td style="text-align: left">2048 x 1536</td>
<td style="text-align: left"><a href="mailto:Default-iOS7-Landscape-768h@2x.png" class="autolink">Default-iOS7-Landscape-768h@2x.png</a></td>
<td style="text-align: left">Retina iPad横向き(Landscape)</td>
</tr>
</tbody>
</table>

<h3>
<span id="起動イメージ-ipad-ios6" class="fragment"></span><a href="#%E8%B5%B7%E5%8B%95%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8-ipad-ios6"><i class="fa fa-link"></i></a>起動イメージ (iPad iOS6)</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">ファイル名(例)</th>
<th style="text-align: left">対象</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">768 x 1004</td>
<td style="text-align: left">Default-Portrait.png</td>
<td style="text-align: left">iPad縦向き(Portrait)</td>
</tr>
<tr>
<td style="text-align: left">1024 x 748</td>
<td style="text-align: left">Default-Landscape.png</td>
<td style="text-align: left">iPad横向き(Landscape)</td>
</tr>
<tr>
<td style="text-align: left">1536 x 2008</td>
<td style="text-align: left"><a href="mailto:Default-Portrait@2x.png" class="autolink">Default-Portrait@2x.png</a></td>
<td style="text-align: left">Retina iPad縦向き(Portrait)</td>
</tr>
<tr>
<td style="text-align: left">2048 x 1496</td>
<td style="text-align: left"><a href="mailto:Default-Landscape@2x.png" class="autolink">Default-Landscape@2x.png</a></td>
<td style="text-align: left">Retina iPad横向き(Landscape)</td>
</tr>
</tbody>
</table>

<ul>
<li>起動イメージのファイル名で自動選択させる場合の書式は以下のようになる。ただし任意の名前のファイルをplistファイルで指定することができるためこの命名ルールは必須ではない</li>
<li>Xcode 5からは<code>Images.xcassets</code>で管理できる</li>
</ul>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>&lt;basename&gt;&lt;usage_specific_modifiers&gt;&lt;scale_modifier&gt;&lt;device_modifier&gt;.png
</pre></div></div>

<table>
<thead>
<tr>
<th style="text-align: left">変数</th>
<th style="text-align: left"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">basename</td>
<td style="text-align: left">
<code>Default</code>またはInfo.plistの<code>UILanchImageFile</code>キーの値</td>
</tr>
<tr>
<td style="text-align: left">usage_specific_modifiers</td>
<td style="text-align: left">
<code>-568h</code> など</td>
</tr>
<tr>
<td style="text-align: left">scale_modifier</td>
<td style="text-align: left">
<code>@2x</code> など</td>
</tr>
<tr>
<td style="text-align: left">device_modifier</td>
<td style="text-align: left">
<code>~ipad</code>, <code>~iphone</code>
</td>
</tr>
</tbody>
</table>

<h2>
<span id="android" class="fragment"></span><a href="#android"><i class="fa fa-link"></i></a>Android</h2>

<h3>
<span id="ガイドライン-1" class="fragment"></span><a href="#%E3%82%AC%E3%82%A4%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3-1"><i class="fa fa-link"></i></a>ガイドライン</h3>

<ul>
<li><a href="http://developer.android.com/design/style/iconography.html" rel="nofollow noopener" target="_blank">Iconography | Android Developers</a></li>
<li>
<a href="https://support.google.com/googleplay/android-developer/answer/1078870?hl=en" rel="nofollow noopener" target="_blank">Graphic Assets for your Application - Google Play for Developers Help</a>

<ul>
<li><a href="http://www.google.com/design/spec/style/icons.html" rel="nofollow noopener" target="_blank">Material Design Style Icons</a></li>
<li><a href="https://github.com/google/material-design-icons/releases" rel="nofollow noopener" target="_blank">Google Material Design Icons</a></li>
</ul>
</li>
</ul>

<h3>
<span id="アプリアイコン" class="fragment"></span><a href="#%E3%82%A2%E3%83%97%E3%83%AA%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3"><i class="fa fa-link"></i></a>アプリアイコン</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">Scale</th>
<th style="text-align: left">ファイル名(例)</th>
<th style="text-align: left">対象</th>
<th style="text-align: left">DPI</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">36 x 36</td>
<td style="text-align: left">x0.75</td>
<td style="text-align: left">drawable-ldpi/ic_launcher_home.png</td>
<td style="text-align: left">Android low-density (LDPI)</td>
<td style="text-align: left">〜120</td>
</tr>
<tr>
<td style="text-align: left">48 x 48</td>
<td style="text-align: left">x1</td>
<td style="text-align: left">drawable-mdpi/ic_launcher_home.png</td>
<td style="text-align: left">Android baseline (MDPI)</td>
<td style="text-align: left">〜160</td>
</tr>
<tr>
<td style="text-align: left">72 x 72</td>
<td style="text-align: left">x1.5</td>
<td style="text-align: left">drawable-hdpi/ic_launcher_home.png</td>
<td style="text-align: left">Android high density (HDPI)</td>
<td style="text-align: left">〜240</td>
</tr>
<tr>
<td style="text-align: left">96 x 96</td>
<td style="text-align: left">x2</td>
<td style="text-align: left">drawable-xhdpi/ic_launcher_home.png</td>
<td style="text-align: left">Android x-high density (XHDPI)</td>
<td style="text-align: left">〜320</td>
</tr>
<tr>
<td style="text-align: left">144 x 144</td>
<td style="text-align: left">x3</td>
<td style="text-align: left">drawable-xxhdpi/ic_launcher_home.png</td>
<td style="text-align: left">Android xx-high density (XXHDPI)</td>
<td style="text-align: left">〜480</td>
</tr>
<tr>
<td style="text-align: left">192 x 192</td>
<td style="text-align: left">x4</td>
<td style="text-align: left">drawable-xxxhdpi/ic_launcher_home.png</td>
<td style="text-align: left">Android xxx-high density (XXXHDPI)</td>
<td style="text-align: left">〜640</td>
</tr>
<tr>
<td style="text-align: left">512 x 512</td>
<td style="text-align: left">-</td>
<td style="text-align: left">GooglePlay.png</td>
<td style="text-align: left">Google Play</td>
<td style="text-align: left">-</td>
</tr>
</tbody>
</table>

<h3>
<span id="webアイコン-1" class="fragment"></span><a href="#web%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3-1"><i class="fa fa-link"></i></a>Webアイコン</h3>

<p><a href="http://updates.html5rocks.com/2014/11/Support-for-theme-color-in-Chrome-39-for-Android" rel="nofollow noopener" target="_blank">Support for theme-color in Chrome 39 for Android</a></p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>&lt;meta name="theme-color" content="#db5945"&gt;
&lt;link rel="icon" sizes="192x192" href="nice-highres.png"&gt;
</pre></div></div>

<h2>
<span id="chrome-web-app--extension" class="fragment"></span><a href="#chrome-web-app--extension"><i class="fa fa-link"></i></a>Chrome Web App / Extension</h2>

<h3>
<span id="ガイドライン-2" class="fragment"></span><a href="#%E3%82%AC%E3%82%A4%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3-2"><i class="fa fa-link"></i></a>ガイドライン</h3>

<ul>
<li><a href="https://developer.chrome.com/webstore/images" rel="nofollow noopener" target="_blank">Supplying Images - Chrome Web Store — Google Developers</a></li>
</ul>

<h3>
<span id="アイコン" class="fragment"></span><a href="#%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3"><i class="fa fa-link"></i></a>アイコン</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">対象</th>
<th style="text-align: center">必須</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">16 x 16</td>
<td style="text-align: left">infoバー用</td>
<td style="text-align: center">-</td>
</tr>
<tr>
<td style="text-align: left">19 x 19</td>
<td style="text-align: left">アドレスバー用</td>
<td style="text-align: center">-</td>
</tr>
<tr>
<td style="text-align: left">48 x 48</td>
<td style="text-align: left">拡張機能一覧など用</td>
<td style="text-align: center">-</td>
</tr>
<tr>
<td style="text-align: left">128 x 128</td>
<td style="text-align: left">128は余白入りサイズでアイコン自体は96 x 96</td>
<td style="text-align: center">○</td>
</tr>
<tr>
<td style="text-align: left">440 x 280</td>
<td style="text-align: left">Chrome Web Storeプロモーション画像Small</td>
<td style="text-align: center">○(Extensionは省略可)</td>
</tr>
<tr>
<td style="text-align: left">920 x 680</td>
<td style="text-align: left">Chrome Web Storeプロモーション画像Large</td>
<td style="text-align: center">-</td>
</tr>
<tr>
<td style="text-align: left">1400 x 560</td>
<td style="text-align: left">Chrome Web Storeプロモーション画像Marquee</td>
<td style="text-align: center">-</td>
</tr>
</tbody>
</table>

<h2>
<span id="windows" class="fragment"></span><a href="#windows"><i class="fa fa-link"></i></a>Windows</h2>

<h3>
<span id="ガイドライン-3" class="fragment"></span><a href="#%E3%82%AC%E3%82%A4%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3-3"><i class="fa fa-link"></i></a>ガイドライン</h3>

<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/dn742485.aspx" rel="nofollow noopener" target="_blank">Icons</a></li>
</ul>

<h3>
<span id="デスクトップアイコン" class="fragment"></span><a href="#%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3"><i class="fa fa-link"></i></a>デスクトップアイコン</h3>

<ul>
<li>icoファイルに含めるサイズ: 16x16, 32x32, 48x48, 256x256</li>
</ul>

<h2>
<span id="os-x" class="fragment"></span><a href="#os-x"><i class="fa fa-link"></i></a>OS X</h2>

<h3>
<span id="ガイドライン-4" class="fragment"></span><a href="#%E3%82%AC%E3%82%A4%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3-4"><i class="fa fa-link"></i></a>ガイドライン</h3>

<ul>
<li><a href="https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/OSXHIGuidelines/Designing.html" rel="nofollow noopener" target="_blank">Designing App Icons (OS X Human Interface Guidelines)</a></li>
</ul>

<h3>
<span id="デスクトップアイコン-1" class="fragment"></span><a href="#%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3-1"><i class="fa fa-link"></i></a>デスクトップアイコン</h3>

<table>
<thead>
<tr>
<th style="text-align: left">サイズ</th>
<th style="text-align: left">ファイル名</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left">16 x 16</td>
<td style="text-align: left">icon_16x16.png</td>
</tr>
<tr>
<td style="text-align: left">32 x 32</td>
<td style="text-align: left"><a href="mailto:icon_16x16@2x.png" class="autolink">icon_16x16@2x.png</a></td>
</tr>
<tr>
<td style="text-align: left">32 x 32</td>
<td style="text-align: left">icon_32x32.png</td>
</tr>
<tr>
<td style="text-align: left">64 x 64</td>
<td style="text-align: left"><a href="mailto:icon_32x32@2x.png" class="autolink">icon_32x32@2x.png</a></td>
</tr>
<tr>
<td style="text-align: left">128 x 128</td>
<td style="text-align: left">icon_128x128.png</td>
</tr>
<tr>
<td style="text-align: left">256 x 256</td>
<td style="text-align: left"><a href="mailto:icon_128x128@2x.png" class="autolink">icon_128x128@2x.png</a></td>
</tr>
<tr>
<td style="text-align: left">256 x 256</td>
<td style="text-align: left">icon_256x256.png</td>
</tr>
<tr>
<td style="text-align: left">512 x 512</td>
<td style="text-align: left"><a href="mailto:icon_256x256@2x.png" class="autolink">icon_256x256@2x.png</a></td>
</tr>
<tr>
<td style="text-align: left">512 x 512</td>
<td style="text-align: left">icon_512x512.png</td>
</tr>
<tr>
<td style="text-align: left">1024 x 1024</td>
<td style="text-align: left"><a href="mailto:icon_512x512@2x.png" class="autolink">icon_512x512@2x.png</a></td>
</tr>
</tbody>
</table>

<h2>
<span id="補足" class="fragment"></span><a href="#%E8%A3%9C%E8%B6%B3"><i class="fa fa-link"></i></a>補足</h2>

<ul>
<li>記載の都合上、iPod touchはiPhoneに含む</li>
<li>iOSはRetinaの場合はRetina向け(<a href="mailto:Example@2x.png" class="autolink">Example@2x.png</a>)の画像を探し、なければノーマル(Example@png)を拡大して使う。過去互換も踏まえて必須にはなっていないがほぼ必須に近い推奨

<ul>
<li>ただしiPhone (4-inch)の非Retinaは存在しないため、Retina iPhone (4-inch)向けの起動画面がない場合は上下に黒帯が入ったiPhone (3.5-inch)のサイズでアプリが実行される</li>
</ul>
</li>
<li>サイズ以外にもガイドラインがあるためドキュメントは目を通しておく、デザイナーが英語に抵抗がある場合は日本語ドキュメントを教えてあげる

<ul>
<li>iOS: <a href="https://developer.apple.com/jp/devcenter/ios/library/documentation/MobileHIG.pdf" class="autolink" rel="nofollow noopener" target="_blank">https://developer.apple.com/jp/devcenter/ios/library/documentation/MobileHIG.pdf</a>
</li>
</ul>
</li>
<li>iOSではiTunesの特集向けに600x600ピクセル以上のプロモーション画像をAppleから依頼される場合がある</li>
</ul>

<h2>
<span id="あるある" class="fragment"></span><a href="#%E3%81%82%E3%82%8B%E3%81%82%E3%82%8B"><i class="fa fa-link"></i></a>あるある</h2>

<ul>
<li>デザインを依頼するときにファイル名指定しておかないとあとでリネームが面倒</li>
<li>アプリのデザインを依頼後、ストアやマーケット向けのデザインが必要になってまとめてお願いしとけばよかったとなる</li>
<li>デバイスの解像度が増えときベクター素材がないとあたふたする、デザインの納品は必ずソースを必ずもらっておくべし</li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />45位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>6</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/3e71e9510ab570616e35">XcodeでOrganization Nameを設定する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2012-08-16 17:03:45</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Xcode]</b> <b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>Xcode <strong>4.4</strong> からプロジェクトを作成すると、<strong>Organization Name</strong>という設定項目が追加されている。</p>

<p><a href="https://camo.qiitausercontent.com/5de601000e37fe46ccac770fb798a77b8827e9ae/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f34345f6f72675f323031322d30382d31365f313433382e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/5de601000e37fe46ccac770fb798a77b8827e9ae/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f34345f6f72675f323031322d30382d31365f313433382e706e67" alt="sc1" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/xcode_44_org_2012-08-16_1438.png"></a></p>

<p>この項目の値はファイルテンプレートの<strong>MyCompanyName</strong>に適応されるようだ。</p>

<p>プロジェクト作成後、あるいはXcode 4.3以前で生成したXcodeプロジェクトはどうすればよいかというと、プロジェクトの設定から変更できる。</p>

<p><a href="https://camo.qiitausercontent.com/c6add46a378d173d9b7f3f9a7366601c1687dd64/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f34345f6f72675f323031322d30382d31365f313433392e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/c6add46a378d173d9b7f3f9a7366601c1687dd64/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f34345f6f72675f323031322d30382d31365f313433392e706e67" alt="sc2" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/xcode_44_org_2012-08-16_1439.png"></a></p>

<p>変更すると以後の新規作成したファイルヘッダに適応される。</p>

<p><a href="https://camo.qiitausercontent.com/4b8415e1cffd0c24f3fe1f1e7e22dfd65055532d/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f34345f6f72675f323031322d30382d31365f313434302e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/4b8415e1cffd0c24f3fe1f1e7e22dfd65055532d/68747470733a2f2f646c2e64726f70626f782e636f6d2f752f383933323133382f73637265656e73686f742f78636f64655f34345f6f72675f323031322d30382d31365f313434302e706e67" alt="sc3" data-canonical-src="https://dl.dropbox.com/u/8932138/screenshot/xcode_44_org_2012-08-16_1440.png"></a></p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />46位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>4</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/2c2de7d3a1ca399e2485">iOSでローカライズ文字列テーブルを分割する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-09-24 11:22:40</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[iOS]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>NSString *NSLocalizedString(NSString *key, NSString *comment)
</pre></div></div>

<p>は <code>ja.lproj/Localizable.strings</code> が参照される。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><span></span>NSString *NSLocalizedStringFromTable(NSString *key,
   NSString *tableName,
   NSString *comment)
</pre></div></div>

<p>ではtableNameにテーブルを指定できる。例えば <code>@"MyTable"</code> を指定すると <code>ja.lproj/MyTable.strings</code> を参照する。</p>

<p>例えば以下のように関数を定義しておくと <code>MYLocalizedString(NSString *key)</code> で呼び出せる。</p>

<div class="code-frame" data-lang="c">
<div class="code-lang"><span class="bold">header</span></div>
<div class="highlight"><pre><span></span><span class="n">FOUNDATION_EXPORT</span> <span class="n">NSString</span> <span class="o">*</span><span class="nf">MYLocalizedString</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
</pre></div>
</div>

<div class="code-frame" data-lang="c">
<div class="code-lang"><span class="bold">objective-c</span></div>
<div class="highlight"><pre><span></span><span class="n">NSString</span> <span class="o">*</span><span class="nf">MYLocalizedString</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="n">key</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">NSLocalizedStringFromTable</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="err">@</span><span class="s">"MyTable"</span><span class="p">,</span> <span class="n">nil</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>

<p>文言を含むライブラリを再利用する場合は文字列テーブルを分けておくと使いやすい。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />47位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>4</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/6eed36565d1b5ed780a2">AndroidアプリにTestFlight SDKを導入する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-08-02 15:26:04</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Android]</b> <b>[TestFlight]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p><strong>TestFlightのAndroidサポートは2014/3/21までなので代替サービスを検討してください。</strong><br>
<a href="http://help.testflightapp.com/customer/portal/articles/1450414" class="autolink" rel="nofollow noopener" target="_blank">http://help.testflightapp.com/customer/portal/articles/1450414</a></p>

<h2>
<span id="1-sdkをダウンロードする" class="fragment"></span><a href="#1-sdk%E3%82%92%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>1. SDKをダウンロードする</h2>

<p><a href="https://testflightapp.com/sdk/download/" class="autolink" rel="nofollow noopener" target="_blank">https://testflightapp.com/sdk/download/</a></p>

<p>からjarファイルがダウンロードできる。Mavenリポジトリとかにしてほしいがbeta版だから仕方がない。</p>

<p>jarファイルをプロジェクトに入れる。</p>

<h2>
<span id="2-起動時の処理の実装" class="fragment"></span><a href="#2-%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86%E3%81%AE%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>2. 起動時の処理の実装</h2>

<p><code>TestFlight.takeOff</code>をApplicationの生成時に呼び出す。<code>android.app.Application</code>を継承したApplicationクラスのonCreateあたり。</p>

<p><code>YOUR_APP_TOKEN</code>の部分はアプリごとに配布され <code>https://testflightapp.com/dashboard/applications/&lt;アプリのID&gt;/token/</code> で確認できるようになる。とりあえずアップロードしてアプリを追加し、Tokenを取得して次のアップロードからTokenを埋め込むか、最初のアップロードからTokenを入れたい場合はアップロードする前に<a href="https://testflightapp.com/dashboard/applications/create/" rel="nofollow noopener" target="_blank">Add Application</a>をするとよい。Tokenが無いとアプリごとのデータを収集できない恐れがあるが配布ができないという制限はない。</p>

<div class="code-frame" data-lang="java">
<div class="code-lang"><span class="bold">MyApplication.java</span></div>
<div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example.app</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.testflightapp.lib.TestFlight</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.app.Application</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyApplication</span> <span class="kd">extends</span> <span class="n">Application</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">();</span>
        <span class="c1">//Initialize TestFlight with your app token.</span>
        <span class="n">TestFlight</span><span class="o">.</span><span class="na">takeOff</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">YOUR_APP_TOKEN</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></div>
</div>

<h2>
<span id="3-マニフェストの設定" class="fragment"></span><a href="#3-%E3%83%9E%E3%83%8B%E3%83%95%E3%82%A7%E3%82%B9%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>3. マニフェストの設定</h2>

<p>TestFlight SDKが <strong>android.permission.INTERNET</strong> と <strong>android.permission.ACCESS_NETWORK_STATE</strong> を必要とするので追加する。</p>

<div class="code-frame" data-lang="xml">
<div class="code-lang"><span class="bold">AndroidManifest.xml</span></div>
<div class="highlight"><pre><span></span><span class="nt">&lt;manifest</span> <span class="err">...</span><span class="nt">&gt;</span>
    <span class="nt">&lt;application</span> <span class="err">...</span> <span class="na">android:name=</span><span class="s">"MyApplication"</span><span class="nt">&gt;</span>
    ...
    <span class="nt">&lt;/application&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.INTERNET"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.ACCESS_NETWORK_STATE"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>

</pre></div>
</div>

<h2>
<span id="4-ビルドのアップロード" class="fragment"></span><a href="#4-%E3%83%93%E3%83%AB%E3%83%89%E3%81%AE%E3%82%A2%E3%83%83%E3%83%97%E3%83%AD%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>4. ビルドのアップロード</h2>

<p>方法は2種類ある。</p>

<ul>
<li>
<a href="https://testflightapp.com/dashboard/builds/add/" rel="nofollow noopener" target="_blank">Upload Build</a>でapkをドラッグ&amp;ドロップする</li>
<li>
<a href="https://testflightapp.com/api/doc/" rel="nofollow noopener" target="_blank">Upload API</a>を使う</li>
</ul>

<p>TestFlightでセッションデータを見たい場合は、apkはデバッグ証明書でサインする必要がある。</p>

<p>Signing Your Applications: Debug vs. Release<br>
<a href="http://help.testflightapp.com/customer/portal/articles/1277927" class="autolink" rel="nofollow noopener" target="_blank">http://help.testflightapp.com/customer/portal/articles/1277927</a></p>

<h2>
<span id="代替サービス" class="fragment"></span><a href="#%E4%BB%A3%E6%9B%BF%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9"><i class="fa fa-link"></i></a>代替サービス</h2>

<ul>
<li><a href="https://deploygate.com/%E2%80%8E" rel="nofollow noopener" target="_blank">DeployGate</a></li>
<li>
<a href="https://play.google.com/" rel="nofollow noopener" target="_blank">Google Play</a>

<ul>
<li><a href="http://qiita.com/kaa/items/3904845d225d40f9a6ef" id="reference-88c226208650f0a8c7be">Google playでのベータ版配布機能について</a></li>
</ul>
</li>
</ul>

<p>TestFlightを使ってみたのは既にiOSアプリでTestFlight使っており配布先（チーム）を再利用できたこと、プロトタイプで公開する予定がないことがあった。Androidでは今後はGoogle Playがファーストチョイスなのではないかと思う。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />48位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>2</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/b1ad3d369773a91bd358">Google AnalyticsのマイレポートでIEのバージョン割合を確認する</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-10-24 11:57:41</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[GoogleAnalytics]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>何やらGoogle Analyticsでマイレポートなるものが作成できるようなので、ユーザのOSやブラウザ、IEのバージョンなどの割合を簡単に見れるようにしてみた。IE8以下は早く消えてほしい。</p>

<p><a href="https://camo.qiitausercontent.com/71c75bc2311b30e6e85ce4e3e31a3aba6a591310/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f37353030313437622d663834302d643339362d346536302d3765363831373631333833652e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/71c75bc2311b30e6e85ce4e3e31a3aba6a591310/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f323433352f37353030313437622d663834302d643339362d346536302d3765363831373631333833652e706e67" alt="ga_2013-10-24_1148.png" title="ga_2013-10-24_1148.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/2435/7500147b-f840-d396-4e60-7e681761383e.png"></a></p>

<p>マイレポートは <code>マイレポート</code> &gt; <code>新しいレポート</code>から作成できる。マイレポートから <code>+ウィジェットを追加</code> でグラフの設定などができる。以下のような設定で作った。ユーザ数は場合によっては訪問数やページビューに変えてみてもよいかもしれない。</p>

<h3>
<span id="オペレーティング-システム-別の-ユーザー数" class="fragment"></span><a href="#%E3%82%AA%E3%83%9A%E3%83%AC%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0-%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0-%E5%88%A5%E3%81%AE-%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E6%95%B0"><i class="fa fa-link"></i></a>オペレーティング システム 別の ユーザー数</h3>

<table>
<thead>
<tr>
<th style="text-align: right">項目</th>
<th style="text-align: left">値</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right">標準</td>
<td style="text-align: left">円グラフ</td>
</tr>
<tr>
<td style="text-align: right">次の円グラフを作成</td>
<td style="text-align: left">ユーザ数</td>
</tr>
<tr>
<td style="text-align: right">グループ分けの単位</td>
<td style="text-align: left">オペレーティングシステム</td>
</tr>
</tbody>
</table>

<h3>
<span id="オペレーティング-システム-と-ブラウザ-でグループ化した-サーバーの平均応答時間秒" class="fragment"></span><a href="#%E3%82%AA%E3%83%9A%E3%83%AC%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0-%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0-%E3%81%A8-%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6-%E3%81%A7%E3%82%B0%E3%83%AB%E3%83%BC%E3%83%97%E5%8C%96%E3%81%97%E3%81%9F-%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC%E3%81%AE%E5%B9%B3%E5%9D%87%E5%BF%9C%E7%AD%94%E6%99%82%E9%96%93%E7%A7%92"><i class="fa fa-link"></i></a>オペレーティング システム と ブラウザ でグループ化した サーバーの平均応答時間（秒）</h3>

<table>
<thead>
<tr>
<th style="text-align: right">項目</th>
<th style="text-align: left">値</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right">標準</td>
<td style="text-align: left">棒グラフ</td>
</tr>
<tr>
<td style="text-align: right">次の棒グラフを作成</td>
<td style="text-align: left">サーバの平均応答時間(秒)</td>
</tr>
<tr>
<td style="text-align: right">グループ分けの単位</td>
<td style="text-align: left">オペレーティングシステム</td>
</tr>
<tr>
<td style="text-align: right">ピボット</td>
<td style="text-align: left">ブラウザ</td>
</tr>
</tbody>
</table>

<h3>
<span id="ブラウザ-別の-ユーザー数" class="fragment"></span><a href="#%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6-%E5%88%A5%E3%81%AE-%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E6%95%B0"><i class="fa fa-link"></i></a>ブラウザ 別の ユーザー数</h3>

<table>
<thead>
<tr>
<th style="text-align: right">項目</th>
<th style="text-align: left">値</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right">標準</td>
<td style="text-align: left">円グラフ</td>
</tr>
<tr>
<td style="text-align: right">次の円グラフを作成</td>
<td style="text-align: left">ユーザー数</td>
</tr>
<tr>
<td style="text-align: right">グループ分けの単位</td>
<td style="text-align: left">ブラウザ</td>
</tr>
</tbody>
</table>

<h3>
<span id="ieバージョン-別の-ユーザー数" class="fragment"></span><a href="#ie%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3-%E5%88%A5%E3%81%AE-%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E6%95%B0"><i class="fa fa-link"></i></a>IEバージョン 別の ユーザー数</h3>

<table>
<thead>
<tr>
<th style="text-align: right">項目</th>
<th style="text-align: left">値</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right">標準</td>
<td style="text-align: left">円グラフ</td>
</tr>
<tr>
<td style="text-align: right">次の円グラフを作成</td>
<td style="text-align: left">ユーザー数</td>
</tr>
<tr>
<td style="text-align: right">グループ分けの単位</td>
<td style="text-align: left">ブラウザのバージョン</td>
</tr>
<tr>
<td style="text-align: right">このデータをフィルタ</td>
<td style="text-align: left">表示の絞込 - ブラウザ - 含む - <code>Internet Explorer</code>
</td>
</tr>
</tbody>
</table>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>makoto_kwさんの<br />49位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>1</kbd>
		<a target="_blank" href="https://qiita.com/makoto_kw/items/9d1af5855012a2a7278d">Javascriptで言語を見てリダイレクト</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-09-30 11:53:30</center>
	</td>
	<td style="width:200px;">
		@makoto_kw<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/2435/profile-images/1473681522">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[JavaScript]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>静的ページでコンテンツネゴシエーション的なことがやりたかった。トップページに来たときにJavascriptでブラウザの言語を見て/jaにリダイレクトしてみる。</p>

<div class="code-frame" data-lang="javascript"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">redirectPage</span><span class="p">(</span><span class="nx">dest</span><span class="p">){</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">)</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">dest</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="p">{</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="nx">dest</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">referer</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">referrer</span> <span class="o">||</span> <span class="s1">''</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="nx">referer</span><span class="p">)</span> <span class="o">==</span> <span class="s1">'string'</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">referer</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">origin</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">lang</span> <span class="o">=</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">language</span> <span class="o">||</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userLanguage</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">langCodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'ja'</span><span class="p">];</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">langCodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">lang</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="nx">langCodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]){</span>
                    <span class="nx">redirectPage</span><span class="p">(</span><span class="s1">'/'</span> <span class="o">+</span> <span class="nx">langCodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                    <span class="k">break</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">})(</span><span class="nx">jQuery</span><span class="p">);</span>
</pre></div></div>

<p>/を英語、/jaを日本語としている都合上、英語サイト閲覧したい場合を想定してリファラをチェックして内部リンクからトップページに来た時はリダイレクトしないようにしている。</p>

<p>クロスブラウザ対応できているのかは不明。</p>

<p>参考: <a href="http://www.webdeveloper.com/forum/showthread.php?174600-Browser-Language-Redirect" class="autolink" rel="nofollow noopener" target="_blank">http://www.webdeveloper.com/forum/showthread.php?174600-Browser-Language-Redirect</a></p>
</div>
	</td>
</tr>
</table>
<br />
	</body>
</html>
