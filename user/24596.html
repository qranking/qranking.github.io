<html>
	<head><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110075493-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-110075493-1');
</script>
<!-- Google AdSense -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6168511236629369",
    enable_page_level_ads: true
  });
</script>

		<meta charset="UTF-8" />
		<title>Qiita Ranking (cd01)</title>
		<link rel="stylesheet" type="text/css" href="../qranking.css">
	</head>
	<body>
<div class="headerContainer">
<h1>Qiitaいいね数ランキング (cd01 さんの投稿分)</h1>
</div><!--class="headerContainer"-->
<p><i><img width="16" height="16" src="../thumb-up-120px.png" /></i>が同じ値の場合は投稿日時の新しいものが上位としています。</p>
<p><i><img width="16" height="16" src="../thumb-up-120px.png" /></i>がついていない記事は表示していません。</p>
<table border="1">
<tr>
	<td rowspan="3"><center>cd01さんの<br />1位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>865</kbd>
		<a target="_blank" href="https://qiita.com/cd01/items/da9a36582372e7d0a7f6">それ PowerShell でできるよ</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-02-15 01:15:16</center>
	</td>
	<td style="width:200px;">
		@cd01<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/24596/profile-images/1473684151">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[PowerShell]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h1>
<span id="summary" class="fragment"></span><a href="#summary"><i class="fa fa-link"></i></a>Summary</h1>

<p>普段使い用 PowerShell メモ</p>

<h1>
<span id="思惑" class="fragment"></span><a href="#%E6%80%9D%E6%83%91"><i class="fa fa-link"></i></a>思惑</h1>

<p>個人的には、 PowerShell はスクリプトをゴリゴリ書くよりも、<br>
ちょこちょこ作業するのに向いていると思っている。<br>
ただ、しばらく使っていないと忘れたりするので、そういうものをまとめてみる。<br>
Linux で、grep とか使って、よくやりそうな感じのやつ。</p>

<p>共用パソコンなどの自分の環境以外でも使えることを想定しているので、<br>
できるだけデフォルトの状態で、できるものに限定する。</p>

<p>また、普段使い想定なので、タイプ数を減らすのを優先していたりするので、<br>
PowerShell の文法的には微妙なところも多少ある。</p>

<h1>
<span id="grep" class="fragment"></span><a href="#grep"><i class="fa fa-link"></i></a>grep</h1>

<p>それ <code>Select-String</code> でできるよ</p>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nb">Select-String</span> <span class="n">-Path</span> <span class="p">.\</span><span class="n">foo</span><span class="p">.</span><span class="n">txt</span> <span class="n">-Pattern</span> <span class="s2">"bar"</span>
</pre></div></div>

<h1>
<span id="find--name-hogehoge" class="fragment"></span><a href="#find--name-hogehoge"><i class="fa fa-link"></i></a>find -name hogehoge</h1>

<p>それ（以下略</p>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="n">-r</span> <span class="p">|</span> <span class="n">where</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-match</span> <span class="s2">"hogehoge"</span> <span class="p">}</span>
</pre></div></div>

<h1>
<span id="cat" class="fragment"></span><a href="#cat"><i class="fa fa-link"></i></a>cat</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nb">Get-Content</span> <span class="p">.\</span><span class="n">foo</span><span class="p">.</span><span class="n">txt</span>
</pre></div></div>

<p>最初から <code>cat</code> がエイリアスに設定されてるはずなので、 <code>cat</code> でも可</p>

<h1>
<span id="sort-uniq" class="fragment"></span><a href="#sort-uniq"><i class="fa fa-link"></i></a>sort, uniq</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nb">Get-Content</span> <span class="p">.\</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="p">|</span> <span class="nb">Get-Unique</span>

<span class="c"># デフォルトのエイリアスを使って、↓みたいにも可能</span>
<span class="n">cat</span> <span class="p">.\</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span> <span class="p">|</span> <span class="n">sort</span> <span class="p">|</span> <span class="n">uniq</span>
</pre></div></div>

<h1>
<span id="wc--l" class="fragment"></span><a href="#wc--l"><i class="fa fa-link"></i></a>wc -l</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="p">$(</span><span class="n">cat</span> <span class="p">.\</span><span class="n">test</span><span class="p">.</span><span class="n">txt</span><span class="p">).</span><span class="n">Length</span>
</pre></div></div>

<h1>
<span id="diff" class="fragment"></span><a href="#diff"><i class="fa fa-link"></i></a>diff</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nb">Compare-Object</span> <span class="p">$(</span><span class="n">cat</span> <span class="p">.\</span><span class="n">a</span><span class="p">.</span><span class="n">txt</span><span class="p">)</span> <span class="p">$(</span><span class="n">cat</span> <span class="p">.\</span><span class="n">b</span><span class="p">.</span><span class="n">txt</span><span class="p">)</span>
</pre></div></div>

<p>ただし、表示形式は微妙。 unified で見たい・・・</p>

<h1>
<span id="sed" class="fragment"></span><a href="#sed"><i class="fa fa-link"></i></a>sed</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nb">Get-Content</span> <span class="p">.\</span><span class="n">foo</span><span class="p">.</span><span class="n">txt</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">-replace</span> <span class="s2">"posh"</span><span class="p">,</span><span class="s2">"PowerShell"</span> <span class="p">}</span>
</pre></div></div>

<h1>
<span id="tail" class="fragment"></span><a href="#tail"><i class="fa fa-link"></i></a>tail</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="c"># PowerShell 2.0</span>
<span class="nb">Get-Content</span> <span class="p">.\</span><span class="n">error</span><span class="p">.</span><span class="n">log</span> <span class="n">-Wait</span>

<span class="c"># PowerShell 3.0+</span>
<span class="nb">Get-Content</span> <span class="p">.\</span><span class="n">error</span><span class="p">.</span><span class="n">log</span> <span class="n">-Wait</span> <span class="n">-Tail</span> <span class="n">5</span>
</pre></div></div>

<h1>
<span id="wget" class="fragment"></span><a href="#wget"><i class="fa fa-link"></i></a>wget</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">new-object</span> <span class="n">net</span><span class="p">.</span><span class="n">webclient</span><span class="p">).</span><span class="n">DownloadFile</span><span class="p">(</span><span class="s2">"URL"</span><span class="p">,</span> <span class="s2">"保存先の絶対パス"</span><span class="p">)</span>
</pre></div></div>

<p>新しめの PowerShell だと ↓ みたいにも可能</p>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nb">Invoke-WebRequest</span> <span class="n">http</span><span class="err">:</span><span class="p">//</span><span class="n">files</span><span class="p">.</span><span class="n">kaoriya</span><span class="p">.</span><span class="n">net</span><span class="p">/</span><span class="n">goto</span><span class="p">/</span><span class="n">vim74w64</span> <span class="n">-OutFile</span> <span class="p">.\</span><span class="n">vim</span><span class="p">.</span><span class="n">zip</span>
</pre></div></div>

<h1>
<span id="curl" class="fragment"></span><a href="#curl"><i class="fa fa-link"></i></a>curl</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="s2">"http://localhost:1234/poshcomplete/"</span> <span class="n">-Method</span> <span class="n">POST</span> <span class="n">-Body</span> <span class="s2">"text=test"</span>
</pre></div></div>

<h1>
<span id="unzip" class="fragment"></span><a href="#unzip"><i class="fa fa-link"></i></a>unzip</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="c"># .NET 4.5+</span>
<span class="c"># 末尾のセミコロンが無いと表示されないので付けています．付けていてもコードとしては動きます（どうみてもバッドノウハウｗ</span>
<span class="no">[System.IO.Compression.Zipfile]</span><span class="p">::</span><span class="n">ExtractToDirectory</span><span class="p">(</span><span class="s2">"圧縮ファイルの絶対パス"</span><span class="p">,</span> <span class="s2">"解凍先の絶対パス"</span><span class="p">);</span>
</pre></div></div>

<h1>
<span id="xargs" class="fragment"></span><a href="#xargs"><i class="fa fa-link"></i></a>xargs</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="p">.\</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="n">cat</span> <span class="nv">$_</span><span class="p">.</span><span class="n">FullName</span> <span class="p">}</span>
</pre></div></div>

<h1>
<span id="man" class="fragment"></span><a href="#man"><i class="fa fa-link"></i></a>man</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="n">man</span> <span class="n">Foo-Bar</span>
</pre></div></div>

<h1>
<span id="その他便利そうなものを少し" class="fragment"></span><a href="#%E3%81%9D%E3%81%AE%E4%BB%96%E4%BE%BF%E5%88%A9%E3%81%9D%E3%81%86%E3%81%AA%E3%82%82%E3%81%AE%E3%82%92%E5%B0%91%E3%81%97"><i class="fa fa-link"></i></a>その他便利そうなものを少し</h1>

<h2>
<span id="なんとなくループ回したいときとか" class="fragment"></span><a href="#%E3%81%AA%E3%82%93%E3%81%A8%E3%81%AA%E3%81%8F%E3%83%AB%E3%83%BC%E3%83%97%E5%9B%9E%E3%81%97%E3%81%9F%E3%81%84%E3%81%A8%E3%81%8D%E3%81%A8%E3%81%8B"><i class="fa fa-link"></i></a>なんとなくループ回したいときとか</h2>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="s2">"PS"</span><span class="p">,</span> <span class="s2">"posh"</span><span class="p">,</span> <span class="s2">"PowerShell"</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="n">echo</span> <span class="nv">$_</span> <span class="p">}</span>
<span class="n">0</span><span class="p">..</span><span class="n">255</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="n">echo</span> <span class="nv">$_</span> <span class="p">}</span>
<span class="n">cat</span> <span class="p">.\</span><span class="n">filepathlist</span><span class="p">.</span><span class="n">txt</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="n">cat</span> <span class="nv">$_</span> <span class="p">}</span> <span class="c"># テキストファイルの中身を 1 行ずつループで回す</span>
</pre></div></div>

<h2>
<span id="応答なし" class="fragment"></span><a href="#%E5%BF%9C%E7%AD%94%E3%81%AA%E3%81%97"><i class="fa fa-link"></i></a>応答なし</h2>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="n">kill</span> <span class="n">-name</span> <span class="n">iexplore</span>
</pre></div></div>

<h2>
<span id="最終更新日時とかで絞り込みたいとき" class="fragment"></span><a href="#%E6%9C%80%E7%B5%82%E6%9B%B4%E6%96%B0%E6%97%A5%E6%99%82%E3%81%A8%E3%81%8B%E3%81%A7%E7%B5%9E%E3%82%8A%E8%BE%BC%E3%81%BF%E3%81%9F%E3%81%84%E3%81%A8%E3%81%8D"><i class="fa fa-link"></i></a>最終更新日時とかで絞り込みたいとき</h2>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="c"># 30日以内に更新した1KB以上のファイル一覧</span>
<span class="n">ls</span> <span class="p">|</span> <span class="n">where</span> <span class="p">{</span> <span class="p">($(</span><span class="nb">Get-Date</span><span class="p">)</span> <span class="p">-</span> <span class="nv">$_</span><span class="p">.</span><span class="n">LastWriteTime</span><span class="p">).</span><span class="n">Days</span> <span class="o">-lt</span> <span class="n">30</span> <span class="p">}</span> <span class="p">|</span> <span class="n">where</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Length</span> <span class="o">-gt</span> <span class="n">1KB</span> <span class="p">}</span>
</pre></div></div>

<p>where で絞り込めるので、ファイルサイズとかで絞り込んだりする。</p>

<h2>
<span id="タイマー" class="fragment"></span><a href="#%E3%82%BF%E3%82%A4%E3%83%9E%E3%83%BC"><i class="fa fa-link"></i></a>タイマー</h2>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nv">$n</span> <span class="p">=</span> <span class="n">3</span>
<span class="n">timeout</span> <span class="p">$(</span><span class="nv">$n</span> <span class="p">*</span> <span class="n">60</span><span class="p">);</span> <span class="n">shutdown</span> <span class="n">-h</span>
</pre></div></div>

<p>n 分後にハイバネーション</p>

<h2>
<span id="powershell-as-a-電卓" class="fragment"></span><a href="#powershell-as-a-%E9%9B%BB%E5%8D%93"><i class="fa fa-link"></i></a>PowerShell as a "電卓"</h2>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="n">1</span> <span class="p">+</span> <span class="n">2</span> <span class="p">+</span> <span class="no">[Math]</span><span class="p">::</span><span class="n">Pow</span><span class="p">(</span><span class="n">2</span><span class="p">,</span> <span class="n">10</span><span class="p">)</span>
</pre></div></div>

<p>普通に演算子を使って、単純な計算をしたり、 <code>System.Math</code> を使って、いろいろしたり</p>

<h2>
<span id="ディレクトリの中の合計サイズ調べるとき" class="fragment"></span><a href="#%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E3%81%AE%E4%B8%AD%E3%81%AE%E5%90%88%E8%A8%88%E3%82%B5%E3%82%A4%E3%82%BA%E8%AA%BF%E3%81%B9%E3%82%8B%E3%81%A8%E3%81%8D"><i class="fa fa-link"></i></a>ディレクトリの中の合計サイズ調べるとき</h2>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="n">gci</span> <span class="p">.\</span> <span class="p">|</span> <span class="n">where</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">PSIsContainer</span> <span class="p">}</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="nb">Write-Host</span> <span class="n">-NoNewline</span> <span class="p">(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="p">+</span> <span class="s2">"</span><span class="se">`t</span><span class="s2">"</span><span class="p">);</span> <span class="p">(</span><span class="n">gci</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="n">-Recurse</span> <span class="p">|</span> <span class="n">measure</span> <span class="n">-Property</span> <span class="n">Length</span> <span class="n">-Sum</span><span class="p">).</span><span class="n">Sum</span><span class="p">;</span> <span class="p">}</span>
</pre></div></div>

<h2>
<span id="net-の確認" class="fragment"></span><a href="#net-%E3%81%AE%E7%A2%BA%E8%AA%8D"><i class="fa fa-link"></i></a>.NET の確認</h2>

<p>unzip とか、電卓の Math とかみたいに、.NET も呼べるので、ちょっとメソッド確認したいときとかに使える。<br>
読み込まれていないものを使いたいときは、 <code>Add-Type -AssemblyName System.HogeHoge</code> みたいにして読み込んで使う。</p>

<h2>
<span id="履歴からスクリプトを作る元を出力する" class="fragment"></span><a href="#%E5%B1%A5%E6%AD%B4%E3%81%8B%E3%82%89%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92%E4%BD%9C%E3%82%8B%E5%85%83%E3%82%92%E5%87%BA%E5%8A%9B%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>履歴からスクリプトを作る元を出力する</h2>

<p>インタラクティブに実行していって、それを出力して編集してスクリプト作る</p>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="nb">Get-History</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="nb">Out-File</span> <span class="n">-InputObject</span> <span class="nv">$_</span><span class="p">.</span><span class="n">CommandLine</span> <span class="n">-Encoding</span> <span class="k">default</span> <span class="n">-Append</span> <span class="p">~/</span><span class="n">foobar</span><span class="p">.</span><span class="n">ps1</span> <span class="p">}</span>
</pre></div></div>

<h2>
<span id="jq" class="fragment"></span><a href="#jq"><i class="fa fa-link"></i></a>jq</h2>

<p>jq みたいなことできるコマンドも、比較的新しいバージョンならできる。<br>
オブジェクトで返ってくるので便利。<br>
csv とかも、オブジェクトで返ってくるコマンドレットがあるので便利。<br>
説明が面倒なので、下記のリンク先を見るとか、ググるとかしてください。</p>

<p><a href="http://tech.guitarrapc.com/entry/2013/08/10/220803" rel="nofollow noopener" target="_blank">PowerShell で JSON をファイル入出力 する - tech.guitarrapc.cóm</a></p>

<h2>
<span id="eject" class="fragment"></span><a href="#eject"><i class="fa fa-link"></i></a>eject</h2>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">New-Object</span> <span class="n">-com</span> <span class="n">WMPlayer</span><span class="p">.</span><span class="n">OCX</span><span class="p">.</span><span class="n">7</span><span class="p">).</span><span class="n">cdromCollection</span><span class="p">.</span><span class="n">Item</span><span class="p">(</span><span class="n">0</span><span class="p">).</span><span class="n">Eject</span><span class="p">()</span>
</pre></div></div>

<p>(☝ ՞ਊ ՞)☝ウイーン</p>

<h1>
<span id="おわりに" class="fragment"></span><a href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>おわりに</h1>

<p>ここまで書いて気がついたけど、オライリーのクックブックに、似たようなこと書いてた（分量が全然違うけど<br>
他にも、見なおしてみたら、役に立ちそうなこと書いてあったから、再読するべき。</p>

<p>この手のシェルを使って仕事するのと、マウスでクリッククリックしまくって手作業で仕事を処理するのとでは、<br>
効率が全然違うので、面倒な仕事は、さっさと終わらせて、本質的な作業に時間を割けるようにしたいですね。</p>

<h1>
<span id="see-also" class="fragment"></span><a href="#see-also"><i class="fa fa-link"></i></a>see also</h1>

<ul>
<li><a href="http://winscript.jp/powershell/258" rel="nofollow noopener" target="_blank">CD-ROMトレイを取り出せるPowerShell関数、「Dismount-CDDrive」作った - PowerShell Scripting Weblog</a></li>
<li><a href="http://tech.guitarrapc.com/entry/2013/04/15/220408" rel="nofollow noopener" target="_blank">PowerShellでtail -fを再現する - tech.guitarrapc.com</a></li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>cd01さんの<br />2位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>26</kbd>
		<a target="_blank" href="https://qiita.com/cd01/items/40ae04b8643a84c9dc08">かわいい PowerShell プロンプト</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-02-17 21:21:19</center>
	</td>
	<td style="width:200px;">
		@cd01<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/24596/profile-images/1473684151">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[PowerShell]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;"><p>PowerShell のウインドウは全体的に、あんまりかわいくないな（きれいに全画面表示できないところとか）<br>
と感じていたので、プロンプトを、かわいくしてみる。<br>
correct？ 知らない子ですね。</p>

<h1>
<span id="顔文字" class="fragment"></span><a href="#%E9%A1%94%E6%96%87%E5%AD%97"><i class="fa fa-link"></i></a>顔文字</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">Prompt</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">($?)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">"(*'-')"</span> <span class="n">-NoNewLine</span> <span class="n">-ForegroundColor</span> <span class="s2">"Green"</span>
        <span class="k">return</span> <span class="s2">"&gt; "</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">"(*;-;)"</span> <span class="n">-NoNewLine</span> <span class="n">-ForegroundColor</span> <span class="s2">"Red"</span>
        <span class="k">return</span> <span class="s2">"&gt; "</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>

<p><a href="https://camo.qiitausercontent.com/7aaf77c0f4f2f6b1ed339a36616ed89aded2a9b6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f32343539362f38653233636163342d373134302d386261632d663362312d3432666137326362633561312e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/7aaf77c0f4f2f6b1ed339a36616ed89aded2a9b6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f32343539362f38653233636163342d373134302d386261632d663362312d3432666137326362633561312e706e67" alt="2014-02-17_21h01_58.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/24596/8e23cac4-7140-8bac-f3b1-42fa72cbc5a1.png"></a></p>

<h1>
<span id="アイコンっぽい感じ" class="fragment"></span><a href="#%E3%82%A2%E3%82%A4%E3%82%B3%E3%83%B3%E3%81%A3%E3%81%BD%E3%81%84%E6%84%9F%E3%81%98"><i class="fa fa-link"></i></a>アイコンっぽい感じ</h1>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">Prompt</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">($?)</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">"☀"</span> <span class="n">-NoNewLine</span> <span class="n">-ForegroundColor</span> <span class="s2">"Red"</span>
        <span class="k">return</span> <span class="s2">"&gt; "</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">Write-Host</span> <span class="s2">"☂"</span> <span class="n">-NoNewLine</span> <span class="n">-ForegroundColor</span> <span class="s2">"Cyan"</span>
        <span class="k">return</span> <span class="s2">"&gt; "</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>

<p><a href="https://camo.qiitausercontent.com/d44ade532ca80d40c9552fca709f3589fccf2434/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f32343539362f30616266623735302d623533622d623765332d653033612d3336646235323466363434612e706e67" target="_blank" rel="nofollow noopener"><img src="https://camo.qiitausercontent.com/d44ade532ca80d40c9552fca709f3589fccf2434/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f32343539362f30616266623735302d623533622d623765332d653033612d3336646235323466363434612e706e67" alt="weather.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/24596/0abfb750-b53b-b7e3-e03a-36db524f644a.png"></a></p>

<h1>
<span id="see-also" class="fragment"></span><a href="#see-also"><i class="fa fa-link"></i></a>see also</h1>

<ul>
<li><a href="http://qiita.com/kubosho_/items/c200680c26e509a4f41c" id="reference-ee6babf73732ba0f142a">Zshをかわいくする.zshrcの設定 - Qiita</a></li>
<li><a href="http://twitpic.com/72hxqn" rel="nofollow noopener" target="_blank">zshはかわいい on Twitpic</a></li>
</ul>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>cd01さんの<br />3位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>26</kbd>
		<a target="_blank" href="https://qiita.com/cd01/items/1f4a380234ef9ea86d73">このコマンドレット、この前 PowerShell で実行した、ような・・・・・・</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2013-09-21 13:51:18</center>
	</td>
	<td style="width:200px;">
		@cd01<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/24596/profile-images/1473684151">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[PowerShell]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h1>
<span id="こんなの絶対おかしいよ" class="fragment"></span><a href="#%E3%81%93%E3%82%93%E3%81%AA%E3%81%AE%E7%B5%B6%E5%AF%BE%E3%81%8A%E3%81%8B%E3%81%97%E3%81%84%E3%82%88"><i class="fa fa-link"></i></a>こんなの絶対おかしいよ！</h1>

<p>Powershell で、いろいろ操作して、昨日打ったコマンドを、また実行できると、それはとっても嬉しいなって思うのですが、Powershell を一旦終了してしまうと履歴が保存されずに消えてしまっています。。。  </p>

<p>それでもいいの？<br>
さっき打ったコマンドレットを忘れちゃうのに？<br>
さっき打ったコマンドレットのこと、もう二度と感じ取ることさえ出来なくなっちゃうのに？？</p>

<h1>
<span id="履歴保存も履歴補完もあるんだよ" class="fragment"></span><a href="#%E5%B1%A5%E6%AD%B4%E4%BF%9D%E5%AD%98%E3%82%82%E5%B1%A5%E6%AD%B4%E8%A3%9C%E5%AE%8C%E3%82%82%E3%81%82%E3%82%8B%E3%82%93%E3%81%A0%E3%82%88"><i class="fa fa-link"></i></a>履歴保存も、履歴補完も、あるんだよ</h1>

<p>がんばれば、きちんとした履歴保存機能を作ることができるでしょうが、<br>
できるだけがんばらずに、履歴保存する方向で。</p>

<h2>
<span id="履歴保存もあるんだよ" class="fragment"></span><a href="#%E5%B1%A5%E6%AD%B4%E4%BF%9D%E5%AD%98%E3%82%82%E3%81%82%E3%82%8B%E3%82%93%E3%81%A0%E3%82%88"><i class="fa fa-link"></i></a>履歴保存も、あるんだよ</h2>

<ul>
<li>$Profile の中の <code>function Prompt</code> に <code>Export-Csv -Path ~\.posh_history.csv -InputObject (Get-History)[-1] -Append</code> を追記</li>
<li>ただし、 <code>exit</code> 以外の方法で終了してしまうと、最後に実行した履歴が残らない（終了イベントとかで保存すればいいけど面倒。そこまでするなら、プラグイン化するか、既存のものを使いたい</li>
<li>あと、コマンドなしで Enter を連打してしまうと同じ履歴が、いっぱい残ってしまう（面倒。そこまでするなら（以下略</li>
<li>
<del>PowerShell 3.0 以上じゃないと、 Export-Csv に -Append オプションがないので、Out-File コマンドで、csv に追記する(初回にヘッダありのファイルを作成しなければならない。。。3.0に比べて、かなり面倒。。。)</del> PowerShell 2.0 のことは忘れましょう</li>
</ul>

<div class="code-frame" data-lang="ps1"><div class="highlight"><pre><span></span><span class="c"># 2.0 向け（PowerShell 2.0 のことは忘れましょう</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="p">~\.</span><span class="n">posh_history</span><span class="p">.</span><span class="n">csv</span><span class="p">))</span> <span class="p">{</span>
    <span class="s2">"#TYPE Microsoft.PowerShell.Commands.HistoryInfo"</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="p">~\.</span><span class="n">posh_history</span><span class="p">.</span><span class="n">csv</span> <span class="n">-encoding</span> <span class="n">UTF8</span>
    <span class="s1">'"Id","CommandLine","ExecutionStatus","StartExecutionTime","EndExecutionTime"'</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="p">~\.</span><span class="n">posh_history</span><span class="p">.</span><span class="n">csv</span> <span class="n">-encoding</span> <span class="n">UTF8</span> <span class="n">-append</span>
<span class="p">}</span>
<span class="nv">$h</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-History</span><span class="p">)[-</span><span class="n">1</span><span class="p">]</span>
<span class="nv">$csv</span> <span class="p">=</span> <span class="s2">"</span><span class="se">`"</span><span class="p">$(</span><span class="nv">$h</span><span class="p">.</span><span class="n">Id</span><span class="p">)</span><span class="se">`"</span><span class="s2">,</span><span class="se">`"</span><span class="p">$(</span><span class="nv">$h</span><span class="p">.</span><span class="n">CommandLine</span><span class="p">)</span><span class="se">`"</span><span class="s2">,</span><span class="se">`"</span><span class="p">$(</span><span class="nv">$h</span><span class="p">.</span><span class="n">ExecutionStatus</span><span class="p">)</span><span class="se">`"</span><span class="s2">,</span><span class="se">`"</span><span class="p">$(</span><span class="nv">$h</span><span class="p">.</span><span class="n">StartExecutionTime</span><span class="p">)</span><span class="se">`"</span><span class="s2">,</span><span class="se">`"</span><span class="p">$(</span><span class="nv">$h</span><span class="p">.</span><span class="n">EndExecutionTime</span><span class="p">)</span><span class="se">`"</span><span class="s2">"</span>
<span class="nv">$csv</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="p">~\.</span><span class="n">posh_history</span><span class="p">.</span><span class="n">csv</span> <span class="n">-encoding</span> <span class="n">UTF8</span> <span class="n">-append</span>
</pre></div></div>

<h2>
<span id="履歴読込もするんだよ" class="fragment"></span><a href="#%E5%B1%A5%E6%AD%B4%E8%AA%AD%E8%BE%BC%E3%82%82%E3%81%99%E3%82%8B%E3%82%93%E3%81%A0%E3%82%88"><i class="fa fa-link"></i></a>履歴読込も、するんだよ</h2>

<ul>
<li>$Profile に <code>Import-Csv ~\.posh_history.csv | Add-History</code> を追記</li>
</ul>

<h2>
<span id="履歴補完もあるんだよ" class="fragment"></span><a href="#%E5%B1%A5%E6%AD%B4%E8%A3%9C%E5%AE%8C%E3%82%82%E3%81%82%E3%82%8B%E3%82%93%E3%81%A0%E3%82%88"><i class="fa fa-link"></i></a>履歴補完も、あるんだよ</h2>

<ul>
<li>#<code>検索したい文字列</code>&lt;Tab&gt;</li>
</ul>

<h2>
<span id="例" class="fragment"></span><a href="#%E4%BE%8B"><i class="fa fa-link"></i></a>例</h2>

<div class="code-frame" data-lang="ps1">
<div class="code-lang"><span class="bold">$Env</span></div>
<div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">Prompt</span> <span class="p">{</span>
    <span class="c"># PowerShell 3.0+</span>
    <span class="nb">Export-Csv</span> <span class="n">-Path</span> <span class="p">~\.</span><span class="n">posh_history</span><span class="p">.</span><span class="n">csv</span> <span class="n">-InputObject</span> <span class="p">(</span><span class="nb">Get-History</span><span class="p">)[-</span><span class="n">1</span><span class="p">]</span> <span class="n">-Append</span>
    <span class="k">return</span> <span class="s2">"$pwd &gt; "</span>
<span class="p">}</span>

<span class="nb">Import-Csv</span> <span class="p">~\.</span><span class="n">posh_history</span><span class="p">.</span><span class="n">csv</span> <span class="p">|</span> <span class="nb">Add-History</span>
</pre></div>
</div>

<h1>
<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>

<ul>
<li>
<a href="https://github.com/lzybkr/PSReadLine" rel="nofollow noopener" target="_blank">lzybkr/PSReadLine</a>

<ul>
<li>デフォルト教を信仰するつもりなので、デフォルトの環境と、かなり変わってしまいそうなので、使ってみるのをためらっているが便利そう。</li>
</ul>
</li>
<li><a href="http://technet.microsoft.com/ja-jp/magazine/hh241048.aspx" rel="nofollow noopener" target="_blank">Windows PowerShell: 歴史を忘れる者たち</a></li>
<li><a href="http://tech.guitarrapc.com/entry/2013/07/12/220515" rel="nofollow noopener" target="_blank">PowerShell コンソールにおける入力履歴管理について - tech.guitarrapc.com</a></li>
</ul>

<h1>
<span id="追記" class="fragment"></span><a href="#%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>追記</h1>

<p>はやく Windows 10 に移行しましょう。</p>
</div>
	</td>
</tr>
</table>
<br />
<table border="1">
<tr>
	<td rowspan="3"><center>cd01さんの<br />4位</center></td>
	<td colspan="3">
		<kbd><i><img alt="いいね" width="16" height="16" src="../thumb-up-120px.png" /></i>8</kbd>
		<a target="_blank" href="https://qiita.com/cd01/items/edaaf78d1d07f4d4a258">[解決済み] Markdown で ~~strike~~ とやると取り消し線にできるようになってほしい</a>
	</td>
</tr>
<tr>
	<td style="width:100px;"><center>投稿日時</center></td>
	<td style="width:200px;"><center>投稿者</center></td>
	<td style="width:150px;"><center>タグ</center></td>
	<td style="width:350px;"><center>本文</center></td>
</tr>
<tr>
	<td style="width:100px;">
		<!--投稿日時--><center>2014-03-01 22:33:17</center>
	</td>
	<td style="width:200px;">
		@cd01<br><img width="80" height="80" src="https://qiita-image-store.s3.amazonaws.com/0/24596/profile-images/1473684151">
	</td>
	<td style="width:150px;">
		<!--タグ-->
		<center><b>[Qiita]</b> <b>[要望]</b> </center>
	</td>
	<td style="width:350px;">
		<!--本文-->
		<div style="width:350px;height:150px;overflow-x:hidden;overflow-y:scroll;">
<h1>
<span id="追記" class="fragment"></span><a href="#%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>追記</h1>

<p><a href="http://qiita.com/Qiita/items/c686397e4a0f4f11683d#strikethrough---%E6%89%93%E3%81%A1%E6%B6%88%E3%81%97%E7%B7%9A" class="autolink">http://qiita.com/Qiita/items/c686397e4a0f4f11683d#strikethrough---打ち消し線</a><br>
できるようになってた！！</p>

<h1>
<span id="strike" class="fragment"></span><a href="#strike"><i class="fa fa-link"></i></a><del>strike</del>
</h1>

<ul>
<li><p>Strikethrough with GitHub Markdown - Web Applications Stack Exchange<br>
<a href="http://webapps.stackexchange.com/questions/14986/strikethrough-with-github-markdown" class="autolink" rel="nofollow noopener" target="_blank">http://webapps.stackexchange.com/questions/14986/strikethrough-with-github-markdown</a></p></li>
<li><p>markdown - Is it possible to use strikethrough in Trello? - Web Applications Stack Exchange<br>
<a href="http://webapps.stackexchange.com/a/56851" class="autolink" rel="nofollow noopener" target="_blank">http://webapps.stackexchange.com/a/56851</a></p></li>
</ul>

<p><code>~~strike~~</code> とやると <del>strike</del> にできるらしいです。<br>
とりあえず、 GitHub と Trello はできるっぽいので、できるようになるとうれしいです。<br>
<del>Qiita では取り消し線にならないようなので。</del></p>
</div>
	</td>
</tr>
</table>
<br />
	</body>
</html>
